<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–≤–µ—Ä–Ω–∞ –≠–ª–∏–∞–Ω–æ—Ä—â–∏–Ω–∞</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        /* –°–±—Ä–æ—Å –∏ –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }

        body {
            background: #000 url('img/Fon taverna.png') no-repeat center center fixed;
            background-size: cover;
            color: #e0d0b0;
            font-family: 'Press Start 2P', cursive;
            overflow: hidden;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* –ù–∞–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ñ–æ–Ω –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        #game-container {
            width: 960px;
            height: 540px;
            position: relative;
            background: rgba(26, 15, 10, 0.9);
            border: 8px solid #5a4320;
            overflow: hidden;
            transform: scale(min(1, calc(100vh / 540)));
            transform-origin: center center;
            box-shadow: 
                0 0 50px rgba(139, 115, 85, 0.3),
                inset 0 0 30px rgba(0, 0, 0, 0.7);
        }

        /* –ü–∏–∫—Å–µ–ª—å–Ω—ã–π —à—É–º */
        .pixel-noise {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4'%3E%3Crect width='2' height='2' fill='%23000000'/%3E%3Crect x='2' y='2' width='2' height='2' fill='%23000000'/%3E%3C/svg%3E");
            background-size: 4px 4px;
            pointer-events: none;
            z-index: 1;
            opacity: 0.1;
        }

        /* –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω */
        #main-menu {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(10, 5, 0, 0.95), rgba(26, 15, 10, 0.9));
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            text-align: center;
            overflow: hidden;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ "–¢–ê–í–ï–†–ù–ê" */
        .tavern-title {
            width: 100%;
            text-align: center;
            z-index: 101;
            margin-top: 10px;
            margin-bottom: 10px;
            animation: titleGlow 4s infinite alternate;
            flex-shrink: 0;
        }

        .tavern-title-text {
            font-size: 42px;
            color: #ffd700;
            text-shadow: 
                4px 4px 0 #5a4320,
                8px 8px 0 rgba(90, 67, 32, 0.3),
                0 0 25px rgba(255, 215, 0, 0.7);
            letter-spacing: 3px;
            background: linear-gradient(180deg, #ffd700 0%, #b89a6d 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            display: inline-block;
            padding: 0 15px;
        }

        .tavern-title-text::before,
        .tavern-title-text::after {
            content: '‚öîÔ∏è';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            opacity: 0.7;
        }

        .tavern-title-text::before {
            left: -5px;
        }

        .tavern-title-text::after {
            right: -5px;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .content-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            height: calc(100% - 70px);
            position: relative;
            z-index: 2;
            gap: 10px;
            flex-grow: 1;
            padding: 5px 0;
        }

        /* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–≤–µ—Ä–Ω—ã */
        .tavern-image-container {
            position: relative;
            width: 620px;
            height: 200px;
            border: 6px solid;
            border-image: linear-gradient(45deg, #5a4320, #8b7355, #b89a6d, #8b7355, #5a4320) 1;
            background: #000;
            box-shadow: 
                0 0 30px rgba(139, 115, 85, 0.4),
                inset 0 0 15px rgba(0, 0, 0, 0.8);
            overflow: hidden;
            flex-shrink: 0;
        }

        .tavern-main-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: sepia(0.4) contrast(1.2) brightness(0.9);
        }

        .image-frame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 2px solid rgba(255, 215, 0, 0.3);
            pointer-events: none;
            z-index: 3;
        }

        /* –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ */
        .tavern-description {
            width: 620px;
            background: rgba(26, 15, 10, 0.9);
            border: 3px solid #5a4320;
            padding: 12px;
            text-align: center;
            position: relative;
            box-shadow: 
                0 0 15px rgba(139, 115, 85, 0.3),
                inset 0 0 10px rgba(0, 0, 0, 0.5);
            flex-shrink: 0;
            margin: 5px 0;
        }

        .description-text {
            font-size: 9px;
            color: #b89a6d;
            line-height: 1.4;
            text-shadow: 1px 1px 0 #5a4320;
        }

        .description-text .highlight {
            color: #ffd700;
            font-size: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∞ "–í–û–ô–¢–ò –í –¢–ê–í–ï–†–ù–£" */
        .enter-button-container {
            position: relative;
            z-index: 102;
            margin-top: auto;
            margin-bottom: 5px;
            flex-shrink: 0;
        }

        #enter-tavern-btn {
            background: linear-gradient(180deg, #8b7355 0%, #5a4320 100%);
            border: 5px solid;
            border-color: #b89a6d #8b7355 #5a4320 #b89a6d;
            color: #ffd700;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            padding: 12px 30px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            box-shadow: 
                0 4px 0 #5a4320,
                0 0 20px rgba(255, 215, 0, 0.4),
                inset 0 0 8px rgba(255, 215, 0, 0.2);
            transition: all 0.2s;
            animation: buttonPulse 3s infinite;
            min-height: 50px;
        }

        #enter-tavern-btn:hover {
            background: linear-gradient(180deg, #b89a6d 0%, #8b7355 100%);
            border-color: #ffd700 #b89a6d #8b7355 #ffd700;
            transform: translateY(-2px);
            box-shadow: 
                0 6px 0 #5a4320,
                0 0 25px rgba(255, 215, 0, 0.6),
                inset 0 0 12px rgba(255, 215, 0, 0.3);
        }

        #enter-tavern-btn:active {
            transform: translateY(2px);
            box-shadow: 
                0 2px 0 #5a4320,
                0 0 15px rgba(255, 215, 0, 0.3),
                inset 0 0 5px rgba(255, 215, 0, 0.1);
            border-color: #8b7355 #b89a6d #b89a6d #8b7355;
        }

        #enter-tavern-btn::before {
            content: 'üö™';
            margin-right: 8px;
            font-size: 14px;
        }

        /* –ü–æ–¥–ø–∏—Å—å */
        .footer-note {
            position: absolute;
            bottom: 8px;
            color: #8b7355;
            font-size: 7px;
            z-index: 101;
            opacity: 0.7;
            letter-spacing: 1px;
            flex-shrink: 0;
        }

        /* –°–≤–µ—á–∏ –ø–æ –±–æ–∫–∞–º */
        .candle {
            position: absolute;
            top: 50%;
            width: 25px;
            height: 50px;
            z-index: 99;
            opacity: 0.8;
        }

        .candle-left {
            left: 25px;
        }

        .candle-right {
            right: 25px;
        }

        .candle-flame {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 16px;
            background: radial-gradient(circle, #ff6b00, #ffd700, transparent 70%);
            border-radius: 50%;
            animation: flameFlicker 0.5s infinite alternate;
            filter: blur(1px);
        }

        .candle-body {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 16px;
            height: 100%;
            background: linear-gradient(90deg, #c0c0c0, #a0a0a0, #c0c0c0);
            border-radius: 4px;
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        #loading-indicator {
            display: none;
            margin-top: 10px;
            background: rgba(26, 15, 10, 0.9);
            border: 2px solid #5a4320;
            padding: 8px 15px;
            color: #b89a6d;
            font-size: 8px;
            letter-spacing: 1px;
            flex-shrink: 0;
        }

        .loading-bar {
            width: 150px;
            height: 3px;
            background: #5a4320;
            margin-top: 5px;
            overflow: hidden;
            position: relative;
        }

        .loading-progress {
            position: absolute;
            height: 100%;
            background: linear-gradient(90deg, #5a4320, #8b7355, #b89a6d);
            animation: loading 2s infinite linear;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes titleGlow {
            0% {
                text-shadow: 
                    4px 4px 0 #5a4320,
                    8px 8px 0 rgba(90, 67, 32, 0.3),
                    0 0 25px rgba(255, 215, 0, 0.7);
            }
            100% {
                text-shadow: 
                    4px 4px 0 #5a4320,
                    8px 8px 0 rgba(90, 67, 32, 0.3),
                    0 0 35px rgba(255, 215, 0, 0.9),
                    0 0 45px rgba(255, 215, 0, 0.5);
            }
        }

        @keyframes buttonPulse {
            0% {
                box-shadow: 
                    0 4px 0 #5a4320,
                    0 0 20px rgba(255, 215, 0, 0.4),
                    inset 0 0 8px rgba(255, 215, 0, 0.2);
            }
            50% {
                box-shadow: 
                    0 4px 0 #5a4320,
                    0 0 25px rgba(255, 215, 0, 0.5),
                    inset 0 0 10px rgba(255, 215, 0, 0.3);
            }
            100% {
                box-shadow: 
                    0 4px 0 #5a4320,
                    0 0 20px rgba(255, 215, 0, 0.4),
                    inset 0 0 8px rgba(255, 215, 0, 0.2);
            }
        }

        @keyframes flameFlicker {
            0% {
                transform: translateX(-50%) scale(1);
                opacity: 0.8;
            }
            100% {
                transform: translateX(-50%) scale(1.2, 0.9);
                opacity: 1;
            }
        }

        @keyframes loading {
            0% { width: 0%; left: 0%; }
            50% { width: 50%; left: 25%; }
            100% { width: 0%; left: 100%; }
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ —Å—Ü–µ–Ω */
        .scene-content {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
        }

        .visible {
            display: flex !important;
            flex-direction: column;
        }

        .hidden {
            display: none !important;
        }

        /* –û—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è —Å—Ü–µ–Ω–∞ */
        #main-scene {
            flex-direction: column;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤–∏–¥–µ–æ —Å —Ä–∞–º–∫–æ–π */
        .video-frame-container {
            position: relative;
            width: 100%;
            height: 400px;
            margin: 10px 10px 5px 10px;
            border: 6px solid;
            border-image: linear-gradient(45deg, #5a4320, #8b7355, #b89a6d, #8b7355, #5a4320) 1;
            background: #000;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 
                0 0 20px rgba(139, 115, 85, 0.4),
                inset 0 0 10px rgba(0, 0, 0, 0.8);
        }

        /* –í–∏–¥–µ–æ –≤–Ω—É—Ç—Ä–∏ —Ä–∞–º–∫–∏ */
        .video-container {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
        }

        .tavern-video {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.7) contrast(1.1) sepia(0.3);
            z-index: 1;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ–∫—Å—Ç–∞ —Å —Ä–∞–º–∫–æ–π */
        .text-frame-container {
            position: relative;
            width: calc(100% - 20px);
            height: 120px;
            margin: 0 10px 10px 10px;
            border: 6px solid;
            border-image: linear-gradient(45deg, #5a4320, #8b7355, #b89a6d, #8b7355, #5a4320) 1;
            background: rgba(26, 15, 10, 0.95);
            overflow: hidden;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            box-shadow: 
                0 0 15px rgba(139, 115, 85, 0.3),
                inset 0 0 10px rgba(0, 0, 0, 0.5);
        }

        /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–µ–∫—Å—Ç–∞ */
        .text-container {
            position: relative;
            flex-grow: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            z-index: 2;
        }

        /* –í—Å–µ –≤–∏–¥–µ–æ/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –ø–∏–∫—Å–µ–ª—å–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º */
        .pixel-media {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8) contrast(1.2);
        }

        .room-image {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
            filter: brightness(0.7) contrast(1.1);
        }

        /* –¢–∞–π–º–µ—Ä */
        #timer {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(26, 15, 10, 0.9);
            border: 3px solid #5a4320;
            padding: 6px 10px;
            font-size: 9px;
            z-index: 100;
            color: #b8a282;
            min-width: 180px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        /* –ú–∏–∫—à–µ—Ä –≥—Ä–æ–º–∫–æ—Å—Ç–∏ */
        #volume-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(26, 15, 10, 0.9);
            border: 3px solid #5a4320;
            padding: 6px 10px;
            z-index: 100;
            min-width: 160px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            display: none;
        }

        #volume-controls.visible {
            display: block;
        }

        .volume-slider-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 5px;
        }

        .volume-icon {
            font-size: 10px;
            color: #b89a6d;
            min-width: 25px;
        }

        .volume-slider {
            flex-grow: 1;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: #5a4320;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: #ffd700;
            cursor: pointer;
            border: 2px solid #8b7355;
            border-radius: 50%;
        }

        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: #ffd700;
            cursor: pointer;
            border: 2px solid #8b7355;
            border-radius: 50%;
        }

        .volume-value {
            font-size: 8px;
            color: #b89a6d;
            min-width: 25px;
            text-align: right;
        }

        #toggle-volume-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(26, 15, 10, 0.9);
            border: 3px solid #5a4320;
            color: #b89a6d;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            padding: 4px 8px;
            cursor: pointer;
            z-index: 101;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            transition: all 0.2s;
        }

        #toggle-volume-btn:hover {
            background: rgba(90, 67, 32, 0.9);
            color: #ffd700;
        }

        /* –î–∏–∞–ª–æ–≥–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .dialogue-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            min-height: 80px;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç - —É–≤–µ–ª–∏—á–µ–Ω –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
        .main-text {
            font-size: 12px;
            line-height: 1.6;
            margin-bottom: 10px;
            color: #e0d0b0;
            min-height: 60px;
            text-shadow: 1px 1px 0 #000;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .speaker-name {
            color: #ffd700;
            font-size: 10px;
            margin-bottom: 8px;
            display: block;
            text-shadow: 1px 1px 0 #5a4320;
        }

        .sub-text {
            font-size: 9px;
            color: #b8a282;
            line-height: 1.5;
            border-top: 1px dashed #5a4320;
            padding-top: 8px;
            margin-bottom: 12px;
            text-shadow: 1px 1px 0 #000;
        }

        /* –ö–Ω–æ–ø–∫–∞ –î–∞–ª–µ–µ - –í–ê–ñ–ù–û: –£–í–ï–õ–ò–ß–ï–ù–ê –∏ –£–õ–£–ß–®–ï–ù–ê */
        .next-button {
            background: #5a4320;
            border: 4px solid;
            border-color: #8b7355 #5a4320 #5a4320 #8b7355;
            color: #ffd700;
            font-family: 'Press Start 2P', cursive;
            font-size: 11px;
            padding: 10px 20px;
            cursor: pointer;
            text-transform: uppercase;
            align-self: flex-end;
            margin-top: 10px;
            min-width: 120px;
            min-height: 40px;
            box-shadow: 
                0 3px 0 #3a2c1a,
                0 0 10px rgba(255, 215, 0, 0.4),
                inset 0 0 8px rgba(255, 215, 0, 0.2);
            transition: all 0.15s;
            position: relative;
            z-index: 3;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .next-button:hover {
            background: #8b7355;
            border-color: #b89a6d #8b7355 #8b7355 #b89a6d;
            box-shadow: 
                0 4px 0 #3a2c1a,
                0 0 15px rgba(255, 215, 0, 0.6),
                inset 0 0 12px rgba(255, 215, 0, 0.3);
            transform: translateY(-2px);
        }

        .next-button:active {
            transform: translateY(2px);
            box-shadow: 
                0 1px 0 #3a2c1a,
                0 0 8px rgba(255, 215, 0, 0.2),
                inset 0 0 5px rgba(255, 215, 0, 0.1);
            border-color: #5a4320 #8b7355 #8b7355 #5a4320;
        }

        .next-button::after {
            content: '‚ñ∂';
            font-size: 12px;
            animation: arrowPulse 1s infinite;
        }

        @keyframes arrowPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* –ö–Ω–æ–ø–∫–∏ –≤ –∏–≥—Ä–µ */
        .pixel-button {
            background: #3a2c1a;
            border: 3px solid;
            border-color: #8b7355 #5a4320 #5a4320 #8b7355;
            color: #ffd700;
            font-family: 'Press Start 2P', cursive;
            font-size: 11px;
            padding: 8px 15px;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.1s;
            box-shadow: 
                0 2px 0 #3a2c1a,
                inset 0 0 5px rgba(255, 215, 0, 0.2);
        }

        .pixel-button:hover {
            background: #5a4320;
            border-color: #b89a6d #8b7355 #8b7355 #b89a6d;
            box-shadow: 
                0 3px 0 #3a2c1a,
                inset 0 0 8px rgba(255, 215, 0, 0.3);
        }

        .pixel-button:active {
            transform: translateY(2px);
            box-shadow: 
                0 1px 0 #3a2c1a,
                inset 0 0 3px rgba(255, 215, 0, 0.1);
            border-color: #5a4320 #8b7355 #8b7355 #5a4320;
        }

        /* –ú–∏–Ω–∏-–∏–≥—Ä–∞ –∫–ª–∏–∫–µ—Ä —Å –ø–∏–≤–æ–º */
        #clicker-game {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 20;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .beer-container {
            position: relative;
            width: 300px;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }

        .beer-glass {
            width: 180px;
            height: 270px;
            cursor: pointer;
            transition: transform 0.1s;
            z-index: 2;
            object-fit: contain;
            image-rendering: pixelated;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.5));
        }

        .beer-glass:hover {
            transform: scale(1.05);
        }

        .beer-glass:active {
            transform: scale(0.95);
        }

        .beer-foam {
            position: absolute;
            width: 150px;
            height: 35px;
            background: #f8e473;
            border-radius: 50%;
            bottom: 230px;
            filter: blur(3px);
            opacity: 0.9;
            z-index: 1;
        }

        .beer-bubbles {
            position: absolute;
            width: 180px;
            height: 225px;
            z-index: 1;
        }

        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: bubbleRise 3s infinite;
        }

        @keyframes bubbleRise {
            0% {
                transform: translateY(0) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-180px) scale(1);
                opacity: 0;
            }
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å —Å–æ–±—ã—Ç–∏–µ–º */
        .progress-event-container {
            width: 500px;
            margin-bottom: 15px;
            position: relative;
        }

        .progress-container {
            width: 100%;
            background: #1a0f0a;
            border: 3px solid #5a4320;
            padding: 3px;
        }

        .progress-bar {
            height: 30px;
            background: #1a0f0a;
            position: relative;
            border: 2px solid #3a2c1a;
            overflow: hidden;
        }

        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, #8b7355, #b89a6d, #ffd700);
            width: 100%;
            transition: width 0.3s ease-out;
        }

        .progress-label {
            position: absolute;
            width: 100%;
            text-align: center;
            font-size: 11px;
            color: #000;
            line-height: 30px;
            z-index: 1;
            font-weight: bold;
            text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.3);
        }

        /* –°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏ */
        .event-message {
            position: absolute;
            top: -50px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 12px;
            color: #ff6b6b;
            font-weight: bold;
            text-shadow: 0 0 5px #000;
            animation: eventMessage 2s forwards;
            z-index: 100;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes eventMessage {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            20% {
                opacity: 1;
                transform: translateY(0);
            }
            80% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è */
        .event-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
            opacity: 0;
        }

        .event-shake {
            animation: eventShake 0.5s;
        }

        @keyframes eventShake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-3px); }
            100% { transform: translateX(0); }
        }

        .event-flash {
            animation: eventFlash 0.3s;
        }

        @keyframes eventFlash {
            0% { background-color: transparent; }
            50% { background-color: rgba(255, 107, 107, 0.3); }
            100% { background-color: transparent; }
        }

        .stats-container {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .stat-box {
            background: #1a0f0a;
            border: 3px solid #5a4320;
            padding: 10px;
            min-width: 130px;
            text-align: center;
        }

        .stat-label {
            font-size: 9px;
            color: #b8a282;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 14px;
            color: #ffd700;
        }

        .game-instruction {
            font-size: 10px;
            color: #b8a282;
            text-align: center;
            margin-top: 10px;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∞ –≤ –∫–ª–∏–∫–µ—Ä–µ */
        #clicker-next-btn {
            margin-top: 20px;
            display: none;
        }

        /* –§–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω */
        #final-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #0a0500;
            z-index: 30;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            text-align: center;
        }

        .rewards-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
            max-width: 400px;
        }

        .reward-item {
            background: #1a0f0a;
            border: 3px solid #5a4320;
            padding: 10px;
            font-size: 10px;
            color: #ffd700;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—á–∞—Ç–∞—é—â–µ–≥–æ—Å—è —Ç–µ–∫—Å—Ç–∞ */
        .typing-text {
            overflow: hidden;
            white-space: pre-wrap;
            position: relative;
        }

        .typing-cursor {
            display: inline-block;
            width: 2px;
            height: 1em;
            background-color: #ffd700;
            animation: cursorBlink 1s infinite;
            vertical-align: middle;
            margin-left: 2px;
        }

        @keyframes cursorBlink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .text-char {
            display: inline-block;
            opacity: 0;
            animation: fadeInChar 0.05s forwards;
        }

        @keyframes fadeInChar {
            to { opacity: 1; }
        }

        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ä–∞–º–∫–∞ –≤–Ω—É—Ç—Ä–∏ */
        .inner-frame {
            position: absolute;
            top: 3px;
            left: 3px;
            right: 3px;
            bottom: 3px;
            border: 2px solid rgba(255, 215, 0, 0.2);
            pointer-events: none;
            z-index: 2;
        }

        /* –ö–Ω–æ–ø–∫–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ */
        .buttons-container {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏ -->
    <audio id="background-music" loop preload="auto">
        <source src="audio/Spa Music Paradise Zone, Ambient Music Collective, Wellness, Hea - Spa Piano Music [audiovk.com].mp3" type="audio/mpeg">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
    </audio>

    <div id="game-container">
        <!-- –ö–Ω–æ–ø–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç—å—é -->
        <button id="toggle-volume-btn" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é">üîä</button>
        
        <!-- –ú–∏–∫—à–µ—Ä –≥—Ä–æ–º–∫–æ—Å—Ç–∏ -->
        <div id="volume-controls">
            <div class="volume-label" style="font-size: 8px; color: #b89a6d; margin-bottom: 5px;">–ì—Ä–æ–º–∫–æ—Å—Ç—å –º—É–∑—ã–∫–∏</div>
            <div class="volume-slider-container">
                <span class="volume-icon">üîá</span>
                <input type="range" id="volume-slider" class="volume-slider" min="0" max="100" value="50">
                <span class="volume-icon">üîä</span>
                <span id="volume-value" class="volume-value">50%</span>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="main-menu" class="visible">
            <div class="pixel-noise"></div>
            
            <!-- –°–≤–µ—á–∏ –ø–æ –±–æ–∫–∞–º -->
            <div class="candle candle-left">
                <div class="candle-flame"></div>
                <div class="candle-body"></div>
            </div>
            <div class="candle candle-right">
                <div class="candle-flame"></div>
                <div class="candle-body"></div>
            </div>
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ "–¢–ê–í–ï–†–ù–ê" -->
            <div class="tavern-title">
                <div class="tavern-title-text">–¢–∞–≤–µ—Ä–Ω–∞</div>
            </div>
            
            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="content-container">
                <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–≤–µ—Ä–Ω—ã -->
                <div class="tavern-image-container">
                    <img src="img/Taverna snaruji.png" 
                         alt="–¢–∞–≤–µ—Ä–Ω–∞ –≠–ª–∏–∞–Ω–æ—Ä—â–∏–Ω–∞" 
                         class="tavern-main-image"
                         onerror="this.onerror=null; this.src='https://via.placeholder.com/620x200/1a0f0a/8b7355?text=–¢–ê–í–ï–†–ù–ê+–≠–õ–ò–ê–ù–û–†–©–ò–ù–ê'">
                    <div class="image-frame"></div>
                    <div class="inner-frame"></div>
                </div>
                
                <!-- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ -->
                <div class="tavern-description">
                    <div class="inner-frame"></div>
                    <div class="description-text">
                        <span class="highlight">¬´–≠–ª–∏–∞–Ω–æ—Ä—â–∏–Ω–∞¬ª</span> ‚Äî –º–µ—Å—Ç–æ, –≥–¥–µ –≤—Ä–µ–º—è —Ç–µ—Ä—è–µ—Ç —Å–º—ã—Å–ª.<br>
                        –ó–¥–µ—Å—å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Ç–µ, –∫—Ç–æ –±–æ–ª—å—à–µ –Ω–µ —Å—á–∏—Ç–∞–µ—Ç —á–∞—Å—ã –∏ –∫—Ä—É–∂–∫–∏.<br>
                        –®—É–º, –¥—ã–º, —à—ë–ø–æ—Ç—ã –∏ —Ä–µ—à–µ–Ω–∏—è, –æ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–∂–∞–ª–µ—é—Ç –∑–∞–≤—Ç—Ä–∞.
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ -->
                <div class="enter-button-container">
                    <button id="enter-tavern-btn">
                        –í–æ–π—Ç–∏ –≤ —Ç–∞–≤–µ—Ä–Ω—É
                    </button>
                </div>
                
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
                <div id="loading-indicator">
                    –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–≤–µ—Ä–Ω—ã...
                    <div class="loading-bar">
                        <div class="loading-progress"></div>
                    </div>
                </div>
            </div>
            
            <!-- –ü–æ–¥–ø–∏—Å—å -->
            <div class="footer-note">
                –ó–∞–π–¥–∏ –Ω–∞ –º–∏–Ω—É—Ç—É. –í—ã–π–¥–∏ —á–µ—Ä–µ–∑ –ø—è—Ç—å —á–∞—Å–æ–≤.
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ü–µ–Ω–∞ -->
        <div id="main-scene" class="scene-content hidden">
            <!-- –†–∞–º–∫–∞ —Å –≤–∏–¥–µ–æ -->
            <div class="video-frame-container">
                <div class="pixel-noise"></div>
                <div class="inner-frame"></div>
                <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤–∏–¥–µ–æ -->
                <div class="video-container">
                    <!-- –ü–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≤–∏–¥ —Ç–∞–≤–µ—Ä–Ω—ã -->
                    <video id="tavern-inside-video" class="tavern-video" autoplay muted loop>
                        <source src="video/Taverna vnutri.mp4" type="video/mp4">
                        <!-- Fallback –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –≤–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è -->
                        <img src="img/Taverna snaruji.png" alt="–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≤–∏–¥ —Ç–∞–≤–µ—Ä–Ω—ã" class="tavern-background">
                    </video>
                    <!-- –í—Ç–æ—Ä–æ–µ –≤–∏–¥–µ–æ - –ø–∏–≤–æ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–æ) -->
                    <video id="beer-video" class="tavern-video" muted loop style="display: none;">
                        <source src="video/Pivo.mp4" type="video/mp4">
                        <!-- Fallback –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –≤–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è -->
                        <img src="img/stakan.png" alt="–ü–∏–≤–æ" class="tavern-background">
                    </video>
                </div>
                
                <div id="timer">[–í—Ä–µ–º—è: 0:00]</div>
            </div>
            
            <!-- –†–∞–º–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º -->
            <div class="text-frame-container">
                <div class="inner-frame"></div>
                <div class="text-container">
                    <div class="dialogue-container">
                        <div id="main-text" class="main-text"></div>
                        <!-- –í–ê–ñ–ù–û: –ö–Ω–æ–ø–∫–∞ –î–∞–ª–µ–µ –í–°–ï–ì–î–ê –≤–∏–¥–∏–º–∞ –≤ —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ -->
                        <button id="next-btn" class="next-button">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–ª–∏–∫–µ—Ä –∏–≥—Ä–∞ —Å –ø–∏–≤–æ–º -->
        <div id="clicker-game" class="scene-content hidden">
            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–±—ã—Ç–∏—è -->
            <div class="progress-event-container">
                <div id="event-message" class="event-message" style="display: none;"></div>
                <div id="event-effect" class="event-effect" style="display: none;"></div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill" style="width: 100%;"></div>
                        <div class="progress-label">–£—Ä–æ–≤–µ–Ω—å –ø–∏–≤–∞</div>
                    </div>
                </div>
            </div>
            
            <div class="game-instruction">
                –ë—ã—Å—Ç—Ä–æ –∫–ª–∏–∫–∞–π –Ω–∞ –ø–∏–≤–æ!<br>
                –ù–æ –≤–Ω–∏–º–∞–π ‚Äî –≤ —Ç–∞–≤–µ—Ä–Ω–µ –≤—Å—ë –º–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è...
            </div>
            
            <div class="beer-container">
                <div class="beer-foam"></div>
                <div class="beer-bubbles" id="bubbles-container"></div>
                <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º stakan.png –¥–ª—è –∫–ª–∏–∫–µ—Ä–∞ -->
                <img src="img/stakan.png" alt="–ü–∏–≤–æ" class="beer-glass" id="beer-clicker"
                     onerror="this.onerror=null; this.src='https://via.placeholder.com/180x270/ffd700/5a4320?text=–ü–ò–í–û'">
            </div>
            
            <div class="stats-container">
                <div class="stat-box">
                    <div class="stat-label">–°–¥–µ–ª–∞–Ω–æ –≥–ª–æ—Ç–∫–æ–≤</div>
                    <div id="click-count" class="stat-value">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å —Ö–º–µ–ª—è</div>
                    <div id="drunk-level" class="stat-value">0%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">–°–∫–æ—Ä–æ—Å—Ç—å</div>
                    <div id="speed-level" class="stat-value">1.0x</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">–¶–µ–ª—å</div>
                    <div id="goal-count" class="stat-value">50 –≥–ª–æ—Ç–∫–æ–≤</div>
                </div>
            </div>
            
            <button id="clicker-next-btn" class="next-button" style="display: none;">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>

        <!-- –ö–æ–º–Ω–∞—Ç–∞: –ü–ê–õ–ê–î–ò–ù–°–û–ë–û–õ -->
        <div id="room-paladin" class="scene-content hidden">
            <!-- –†–∞–º–∫–∞ —Å –≤–∏–¥–µ–æ -->
            <div class="video-frame-container">
                <div class="pixel-noise"></div>
                <div class="inner-frame"></div>
                <img src="img/Paladinsobol.png" alt="–ö–æ–º–Ω–∞—Ç–∞ –ü–∞–ª–∞–¥–∏–Ω—Å–æ–±–æ–ª" class="room-image"
                     onerror="this.onerror=null; this.style.display='none'; this.parentElement.style.background='#1a0f0a'">
            </div>
            
            <!-- –†–∞–º–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º -->
            <div class="text-frame-container">
                <div class="inner-frame"></div>
                <div class="text-container">
                    <div class="dialogue-container">
                        <div id="paladin-text" class="main-text"></div>
                        <button id="paladin-next-btn" class="next-button">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–æ–º–Ω–∞—Ç–∞: –ö–†–´–°–ò–¢–¨ -->
        <div id="room-rats" class="scene-content hidden">
            <!-- –†–∞–º–∫–∞ —Å –≤–∏–¥–µ–æ -->
            <div class="video-frame-container">
                <div class="pixel-noise"></div>
                <div class="inner-frame"></div>
                <img src="img/Krisit.png" alt="–ö–æ–º–Ω–∞—Ç–∞ –ö—Ä—ã—Å–∏—Ç—å" class="room-image"
                     onerror="this.onerror=null; this.style.display='none'; this.parentElement.style.background='#1a0f0a'">
            </div>
            
            <!-- –†–∞–º–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º -->
            <div class="text-frame-container">
                <div class="inner-frame"></div>
                <div class="text-container">
                    <div class="dialogue-container">
                        <div id="rats-text" class="main-text"></div>
                        <button id="rats-next-btn" class="next-button">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–æ–º–Ω–∞—Ç–∞: –ë–û–ì–õ–Æ–ë–ò–¢–¢–†–û–ò–¶–£ -->
        <div id="room-godloves" class="scene-content hidden">
            <!-- –†–∞–º–∫–∞ —Å –≤–∏–¥–µ–æ -->
            <div class="video-frame-container">
                <div class="pixel-noise"></div>
                <div class="inner-frame"></div>
                <img src="img/Bog lubit.png" alt="–ö–æ–º–Ω–∞—Ç–∞ –ë–æ–≥–ª—é–±–∏—Ç—Ç—Ä–æ–∏—Ü—É" class="room-image"
                     onerror="this.onerror=null; this.style.display='none'; this.parentElement.style.background='#1a0f0a'">
            </div>
            
            <!-- –†–∞–º–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º -->
            <div class="text-frame-container">
                <div class="inner-frame"></div>
                <div class="text-container">
                    <div class="dialogue-container">
                        <div id="godloves-text" class="main-text"></div>
                        <button id="godloves-next-btn" class="next-button">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–æ–º–Ω–∞—Ç–∞: –°–£–ü–ï–†–ú–ï–ì–ê–¢–ê–ô–ù–ê -->
        <div id="room-secret" class="scene-content hidden">
            <!-- –†–∞–º–∫–∞ —Å –≤–∏–¥–µ–æ -->
            <div class="video-frame-container">
                <div class="pixel-noise"></div>
                <div class="inner-frame"></div>
                <img src="img/Taina.png" alt="–ö–æ–º–Ω–∞—Ç–∞ –°—É–ø–µ—Ä–ú–µ–≥–∞–¢–∞–π–Ω–∞" class="room-image"
                     onerror="this.onerror=null; this.style.display='none'; this.parentElement.style.background='#1a0f0a'">
            </div>
            
            <!-- –†–∞–º–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º -->
            <div class="text-frame-container">
                <div class="inner-frame"></div>
                <div class="text-container">
                    <div class="dialogue-container">
                        <div id="secret-text" class="main-text"></div>
                        <button id="secret-next-btn" class="next-button">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–æ–º–Ω–∞—Ç–∞: –ß–ê–ô –í–î–í–û–Å–ú -->
        <div id="room-tea" class="scene-content hidden">
            <!-- –†–∞–º–∫–∞ —Å –≤–∏–¥–µ–æ -->
            <div class="video-frame-container">
                <div class="pixel-noise"></div>
                <div class="inner-frame"></div>
                <img src="img/Chai.png" alt="–ö–æ–º–Ω–∞—Ç–∞ –ß–∞–π –≤–¥–≤–æ—ë–º" class="room-image"
                     onerror="this.onerror=null; this.style.display='none'; this.parentElement.style.background='#1a0f0a'">
            </div>
            
            <!-- –†–∞–º–∫–∞ —Å —Ç–µ–∫—Å—Ç–æ–º -->
            <div class="text-frame-container">
                <div class="inner-frame"></div>
                <div class="text-container">
                    <div class="dialogue-container">
                        <div id="tea-text" class="main-text"></div>
                        <button id="tea-next-btn" class="next-button">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –§–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="final-screen" class="scene-content hidden">
            <div class="tavern-title">
                <div class="tavern-title-text">–¢–∞–≤–µ—Ä–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∞</div>
            </div>
            
            <div class="tavern-description" style="width: 500px; margin: 15px 0;">
                <div class="inner-frame"></div>
                <div class="description-text">
                    –®—É–º —Å–º–æ–ª–∫. –°–≤–µ—Ç –≥–∞—Å–Ω–µ—Ç.<br>
                    <span style="color: #ffd700;">–ù–∏–∫ –º—ã—Å–ª–µ–Ω–Ω–æ: –Ø –≤–µ–¥—å –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–µ–ª –∑–∞–π—Ç–∏ –Ω–∞ –º–∏–Ω—É—Ç—É...<br>–ù–æ —ç—Ç–∞ –º–∏–Ω—É—Ç–∞ –¥–ª–∏–ª–∞—Å—å –≤–µ—á–Ω–æ.</span>
                </div>
            </div>
            
            <div class="rewards-container">
                <div class="reward-item">‚úî –ò—Å—Ç–æ—Ä–∏—è, –∫–æ—Ç–æ—Ä—É—é –∑–∞–±—É–¥–µ—à—å</div>
                <div class="reward-item">‚úî –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —É–π–¥—ë—Ç</div>
                <div class="reward-item">‚úî –ü—É—Å—Ç–æ—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Å—Ç–∞–Ω–µ—Ç—Å—è</div>
                <div class="reward-item">‚úî –û—Å–∞–¥–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–∂–∏–≤—ë—Ç—Å—è</div>
            </div>
            
            <div class="enter-button-container" style="margin-top: 20px;">
                <button id="restart-btn" class="pixel-button" style="font-size: 12px; padding: 12px 25px;">
                    –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Ç–∞–≤–µ—Ä–Ω—É
                </button>
            </div>
        </div>
    </div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        const gameState = {
            currentScene: 'main_menu',
            timeInTavern: 0,
            drunkLevel: 0,
            beerLevel: 100,
            clickerActive: false,
            clickCount: 0,
            gameSpeed: 1.0,
            clickerCompleted: false,
            progressInterval: null,
            visitedRooms: [],
            playerName: '–ù–∏–∫',
            currentVideo: 'tavern_inside',
            currentDialogueIndex: 0,
            currentDialogueSet: 'tavern_enter',
            clicksSinceLastEvent: 0,
            clicksForNextEvent: getRandomClicksForEvent(),
            eventsTriggered: 0,
            maxEvents: 8,
            eventActive: false,
            requiredClicks: 50,
            actionButtonsShown: false,
            isTyping: false,
            currentText: '',
            typingInterval: null,
            typingSpeed: 30,
            skipTyping: false,
            musicVolume: 0.5,
            musicMuted: false,
            volumeControlsVisible: false
        };
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∏–∫–æ–≤ –¥–æ —Å–æ–±—ã—Ç–∏—è
        function getRandomClicksForEvent() {
            return Math.floor(Math.random() * 11) + 5;
        }
        
        // –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
        const tavernEvents = [
            {
                id: 1,
                name: '–ü–µ–Ω–∞ —â–µ–∫–æ—á–µ—Ç –Ω–æ—Å',
                message: '–ü–µ–Ω–∞ –≤—ã—Å–∫–æ—á–∏–ª–∞ –∏ —â–µ–∫–æ—á–µ—Ç —Ç–µ–±—è –≤ –Ω–æ—Å!',
                description: '–¢—ã —á–∏—Ö–∞–µ—à—å –∏ –ø—Ä–æ–ª–∏–≤–∞–µ—à—å –Ω–µ–º–Ω–æ–≥–æ.',
                beerLoss: 20,
                effect: 'sneeze'
            },
            {
                id: 2,
                name: '–ö—Ç–æ-—Ç–æ –ø–æ—ë—Ç –Ω–µ –≤ —Ç–∞–∫—Ç',
                message: '–°–æ—Å–µ–¥ –∑–∞–ø–µ–ª –Ω–µ –≤ —Ç–∞–∫—Ç!',
                description: '–¢—ã –æ—Ç–≤–ª–µ–∫–∞–µ—à—å—Å—è –Ω–∞ —Å–µ–∫—É–Ω–¥—É.',
                beerLoss: 15,
                effect: 'singing'
            },
            {
                id: 3,
                name: '–ú—ã—à–∫–∞ –æ–ø—Ä–æ–∫–∏–Ω—É–ª–∞ —Ç–∞–±—É—Ä–µ—Ç',
                message: '–ú—ã—à–∫–∞ –æ–ø—Ä–æ–∫–∏–Ω—É–ª–∞ —Ç–∞–±—É—Ä–µ—Ç!',
                description: '–í–∑–¥—Ä–æ–≥–Ω—É–ª –∏ —á—É—Ç—å –ø—Ä–æ–ª–∏–ª.',
                beerLoss: 20,
                effect: 'mouse'
            },
            {
                id: 4,
                name: '–ü—Ä–æ–ª–µ—Ç–µ–ª –º–æ—Ç—ã–ª—ë–∫',
                message: '–ú–æ—Ç—ã–ª—ë–∫ –ø—Ä—è–º–æ –≤ –ø–∏–≤–æ!',
                description: '–í—ã–ª–æ–≤–∏–ª –º–æ—Ç—ã–ª—å–∫–∞ –∏–∑ –∫—Ä—É–∂–∫–∏.',
                beerLoss: 18,
                effect: 'moth'
            },
            {
                id: 5,
                name: '–°–∫—Ä–∏–ø–Ω—É–ª–∞ –¥–≤–µ—Ä—å',
                message: '–°–∫—Ä–∏–ø –¥–≤–µ—Ä–∏ –æ—Ç–≤–ª—ë–∫ —Ç–µ–±—è!',
                description: '–û–≥–ª—è–Ω—É–ª—Å—è –Ω–∞ —Å–∫—Ä–∏–ø.',
                beerLoss: 12,
                effect: 'door'
            },
            {
                id: 6,
                name: '–ü—å—è–Ω—ã–π –∑–∞–ø–µ–ª –≥—Ä–æ–º—á–µ',
                message: '–ü—å—è–Ω—ã–π –∑–∞ —Å—Ç–æ–ª–æ–º –Ω–∞—á–∞–ª –æ—Ä–∞—Ç—å –ø–µ—Å–Ω—é!',
                description: '–û—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–ª–∏–ª.',
                beerLoss: 25,
                effect: 'drunk_sing'
            }
        ];
        
        // –î–∏–∞–ª–æ–≥–∏
        const dialogues = {
            tavern_enter: [
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–¢–æ—á–Ω–æ, –Ω–∞ –ø—è—Ç—å –º–∏–Ω—É—Ç. –ú–∞–∫—Å–∏–º—É–º –Ω–∞ –¥–µ—Å—è—Ç—å. –ò —Ç–æ—á–∫–∞.' },
                { speaker: '–î—É—Ö —Ç–∞–≤–µ—Ä–Ω—ã', text: '–ü—Ä–∏—Å—è–¥—å. –•–æ—Ç—è –±—ã –Ω–∞ –º–∏–Ω—É—Ç–æ—á–∫—É...' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ë–∞—Ä–º–µ–Ω —è–≤–Ω–æ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –º–æ—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤–æ–≤—Ä–µ–º—è —É–π—Ç–∏.' },
                { speaker: '–°—Ç–∞—Ä—ã–π –±–∞—Ä–º–µ–Ω', text: '–í–∏–∂—É –≤ —Ç–µ–±–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª... –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –ø—Ä–æ—Å–∏–¥–µ—Ç—å –¥–æ —É—Ç—Ä–∞.' }
            ],
            
            friend_meet: [
                { speaker: '–ò–≥–æ—Ä—å', text: '–ù–∏–∫! –°—Ç–∞—Ä–∏–∫! –Ø —Ç–µ–±—è –∂–¥–∞–ª!' },
                { speaker: '–ù–∏–∫', text: '–¢—ã –∂–µ –ø–æ–º–Ω–∏—à—å –Ω–∞—à—É –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å? –û–¥–∏–Ω –≥–ª–æ—Ç–æ–∫ –∏...' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ò –¥–∞–ª—å—à–µ –ø–æ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞–º! –û–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ —É–∂–µ –∑–¥–µ—Å—å.' },
                { speaker: '–ù–∏–∫', text: '–û–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ –≤—ã–≥–ª—è–¥—è—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –º–æ–∫—Ä—ã–º–∏.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–≠—Ç–æ –Ω–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞, —ç—Ç–æ –ø—Ä–æ–ª–∏—Ç–æ–µ –ø–∏–≤–æ. –ü—Ä–∏—Å–∞–∂–∏–≤–∞–π—Å—è, –¥—Ä—É–≥.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ü–æ–º–Ω–∏—à—å, –∫–∞–∫ –≤ –¥–µ—Ç—Å—Ç–≤–µ –º—ã –ø—Ä—è—Ç–∞–ª–∏—Å—å –≤ —Å–∞—Ä–∞–µ —Å –ø–µ—Ä–≤–æ–π –±—É—Ç—ã–ª–∫–æ–π?' },
                { speaker: '–ù–∏–∫', text: '–¢—ã –µ—ë —Ä–∞–∑–±–∏–ª, –∞ —Å–∫–∞–∑–∞–ª, —á—Ç–æ –∫–æ—à–∫–∞.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ê —Ç—ã –ø–æ–≤–µ—Ä–∏–ª! –í—Å–µ–≥–¥–∞ –±—ã–ª –¥–æ–≤–µ—Ä—á–∏–≤—ã–º.' }
            ],
            
            friend_offer: [
                { speaker: '–ò–≥–æ—Ä—å', text: '–í–∏–¥–∏—à—å —ç—Ç—É –ø–µ–Ω—É? –û–Ω–∞ –∂–¥—ë—Ç —Ç–µ–±—è —Å —Ç–µ—Ö –ø–æ—Ä, –∫–∞–∫ –º—ã –µ—ë –æ—Ç–∫—Ä—ã–ª–∏.' },
                { speaker: '–ù–∏–∫', text: '–ê –µ—Å–ª–∏ —è –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–∏–∂—É –∏ –ø–æ—Å–ª—É—à–∞—é?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–®—É–º —Ç–∞–≤–µ—Ä–Ω—ã –≥–æ–≤–æ—Ä–∏—Ç: "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è, –∫–∞–∫ –≤ —Å—Ç–∞—Ä—ã–µ –≤—Ä–µ–º–µ–Ω–∞".' },
                { speaker: '–ù–∏–∫', text: '–Ø –Ω–µ —Ö–æ—á—É –ø–æ–≤—Ç–æ—Ä—è—Ç—å –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑...' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —Å—Ç–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å. –î–ª—è –Ω–æ—Å—Ç–∞–ª—å–≥–∏–∏.' },
                { speaker: '–°—Ç–∞—Ä—ã–π –ø—å—è–Ω–∏—Ü–∞', text: '–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ ‚Äî –º–∞—Ç—å... —ç—ç—ç... —á–µ–≥–æ-—Ç–æ —Ç–∞–º!' },
                { speaker: '–ù–∏–∫', text: '–ú–∞—Ç—å –ø–æ—Ö–º–µ–ª—å—è?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–û, —É–∂–µ –≤—Ö–æ–¥–∏—à—å –≤ —Ä–∏—Ç–º! –ö–∞–∫ –≤ —à–∫–æ–ª–µ –∑–∞ –≥–∞—Ä–∞–∂–∞–º–∏.' }
            ],
            
            tavern_noise: [
                { speaker: '–ì–æ–ª–æ—Å –∏–∑ —Ç–æ–ª–ø—ã', text: '–ê –ø–æ–º–Ω–∏—à—å, –∫–∞–∫ –º—ã –≥–Ω–∞–ª–∏—Å—å –∑–∞ —Ç–µ–º –≥–Ω–æ–º–æ–º?' },
                { speaker: '–î—Ä—É–≥–æ–π –≥–æ–ª–æ—Å', text: '–Ø –µ–≥–æ –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –Ω–∞—à—ë–ª!' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—Ä–∏–π –∑–¥–µ—Å—å —É—Ç–æ–Ω—É–ª–æ?' },
                { speaker: '–°—Ç–∞—Ä—ã–π –±–∞—Ä–º–µ–Ω', text: '–ò—Å—Ç–æ—Ä–∏–∏ –Ω–µ —Ç–æ–Ω—É—Ç. –û–Ω–∏ –ø—Ä–æ–ø–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –¥–µ—Ä–µ–≤–æ —Å—Ç–æ–ª–∞.' },
                { speaker: '–ù–∏–∫', text: '–ò —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —á–∞—Å—Ç—å—é –º–µ–±–µ–ª–∏?' },
                { speaker: '–°—Ç–∞—Ä—ã–π –±–∞—Ä–º–µ–Ω', text: '–ù–µ—Ç. –°—Ç–∞–Ω–æ–≤—è—Ç—Å—è —á–∞—Å—Ç—å—é —Ç–∞–≤–µ—Ä–Ω—ã.' },
                { speaker: '–ü—å—è–Ω—ã–π —ç–ª—å—Ñ', text: '–ê –º–æ–π –¥—Ä—É–≥ —Å—Ç–∞–ª —á–∞—Å—Ç—å—é –ø–æ–ª–∞! –ù–æ —ç—Ç–æ –¥—Ä—É–≥–∞—è –∏—Å—Ç–æ—Ä–∏—è...' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ù–µ —Å–ª—É—à–∞–π –µ–≥–æ. –û–Ω –ø—Ä–æ—Å—Ç–æ —É–ø–∞–ª. –ö–∞–∫ —Ç—ã –≤ —Ç–æ—Ç —Ä–∞–∑ –Ω–∞ –≤—ã–ø—É—Å–∫–Ω–æ–º.' }
            ],
            
            clicker_end: [
                { speaker: '–ò–≥–æ—Ä—å', text: '...—Ç—ã —Å–¥–µ–ª–∞–ª –±–æ–ª—å—à–µ –≥–ª–æ—Ç–∫–æ–≤, —á–µ–º —è –æ–∂–∏–¥–∞–ª.' },
                { speaker: '–ù–∏–∫', text: '–Ø –≤–æ–æ–±—â–µ –Ω–µ –ø–æ–º–Ω—é, —á—Ç–æ –±—ã–ª —á—É–∂–∏–º.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ò–¥–µ–∞–ª—å–Ω–æ! –¢–∞–≤–µ—Ä–Ω–∞ –ø—Ä–∏–Ω—è–ª–∞ —Ç–µ–±—è.' },
                { speaker: '–ù–∏–∫', text: '–ê —á—Ç–æ –¥–∞–ª—å—à–µ? –ë–æ–ª—å—à–µ –ø–∏–≤–∞?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–î–∞–ª—å—à–µ ‚Äî –∏—Å—Ç–æ—Ä–∏–∏. –£ –∫–∞–∂–¥–æ–≥–æ –≥–ª–æ—Ç–∫–∞ —Å–≤–æ—è.' },
                { speaker: '–ù–∏–∫', text: '–£ –º–µ–Ω—è —É–∂–µ —Å–≤–æ—è –∏—Å—Ç–æ—Ä–∏—è ‚Äî –∫–∞–∫ —è —Å–¥–µ–ª–∞–ª 50 –≥–ª–æ—Ç–∫–æ–≤.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–≠—Ç–æ –Ω–µ –∏—Å—Ç–æ—Ä–∏—è. –≠—Ç–æ –∞–Ω—Ç—Ä–∞–∫—Ç.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ü–æ–º–Ω–∏—à—å, –∫–∞–∫ –º—ã –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –Ω–∞–ø–∏–ª–∏—Å—å —É —Ä–µ–∫–∏?' },
                { speaker: '–ù–∏–∫', text: '–¢—ã —É–ø–∞–ª –≤ –≤–æ–¥—É, –∞ —è —Ç–µ–±—è –≤—ã—Ç–∞—â–∏–ª.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ò —Å —Ç–µ—Ö –ø–æ—Ä —è —Ç–µ–±–µ –¥–æ–ª–∂–µ–Ω. –í–æ—Ç –∏ –æ—Ç–¥–∞—é.' }
            ],
            
            room_select: [
                { speaker: '–¢–∞–≤–µ—Ä–Ω–∞', text: '–ü—è—Ç—å –¥–≤–µ—Ä–µ–π. –ü—è—Ç—å –∏—Å—Ç–æ—Ä–∏–π. –ü—è—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–í—ã–±–∏—Ä–∞–π –ª—é–±—É—é. –ò–ª–∏ –≤—Å–µ –ø–æ –æ—á–µ—Ä–µ–¥–∏.' },
                { speaker: '–ù–∏–∫', text: '–ê –µ—Å–ª–∏ —è –Ω–µ –≤—ã–±–µ—Ä—É?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–í—ã–±–µ—Ä–µ—Ç –∑–∞ —Ç–µ–±—è –≤—Ä–µ–º—è. –û–Ω–æ –∑–¥–µ—Å—å –Ω–µ —Ç–æ—Ä–æ–ø–∏—Ç—Å—è.' },
                { speaker: '–ù–∏–∫', text: '–ê –∫–∞–∫–∞—è –¥–≤–µ—Ä—å –≤–µ–¥—ë—Ç –∫ –≤—ã—Ö–æ–¥—É?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ó–∞–±–∞–≤–Ω–æ. –¢—ã –≤—Å—ë –µ—â—ë –¥—É–º–∞–µ—à—å –æ –≤—ã—Ö–æ–¥–µ. –ö–∞–∫ –≤ —Ç–æ—Ç —Ä–∞–∑ –≤ –ª–∞–≥–µ—Ä–µ.' }
            ],
            
            paladin_dialogue: [
                { speaker: '–ü–∞–ª–∞–¥–∏–Ω—Å–æ–±–æ–ª', text: '–ó–¥–µ—Å—å –≤—Å–µ –∫–æ–≥–¥–∞-—Ç–æ –±—ã–ª–∏ —Ä—ã—Ü–∞—Ä—è–º–∏.' },
                { speaker: '–ù–∏–∫ (—Ç–∏—Ö–æ)', text: '–Ø –¥—É–º–∞–ª, –º—ã –±—É–¥–µ–º –≥–µ—Ä–æ—è–º–∏...' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ì–µ—Ä–æ–∏ —Ç–æ–∂–µ –ø—å—é—Ç. –¢–æ–ª—å–∫–æ —Ç–∏—à–µ.' },
                { speaker: '–°—Ç–∞—Ä—ã–π –≤–æ–∏–Ω', text: '–ì–µ—Ä–æ–∏ ‚Äî —ç—Ç–æ —Ç–µ, –∫—Ç–æ –ø–æ–º–Ω–∏—Ç, –∑–∞—á–µ–º –≤–∑—è–ª –º–µ—á.' },
                { speaker: '–ù–∏–∫', text: '–ê –∑–∞—á–µ–º –µ–≥–æ –±—Ä–∞–ª–∏?' },
                { speaker: '–°—Ç–∞—Ä—ã–π –≤–æ–∏–Ω', text: '–ß—Ç–æ–±—ã –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –ø–æ–ª–æ–∂–∏—Ç—å.' },
                { speaker: '–ù–∏–∫', text: '–ò —á—Ç–æ –ø–æ—Ç–æ–º?' },
                { speaker: '–°—Ç–∞—Ä—ã–π –≤–æ–∏–Ω', text: '–ü–æ—Ç–æ–º –±–µ—Ä—É—Ç –∫—Ä—É–∂–∫—É. –û–Ω–∞ –ª–µ–≥—á–µ.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ò –Ω–µ —Ä–∂–∞–≤–µ–µ—Ç. –ï—Å–ª–∏ –Ω–µ –ø—Ä–æ–ª–∏–≤–∞—Ç—å.' }
            ],
            
            rats_dialogue: [
                { speaker: '–°—Ç–∞—Ä–∏–∫-–±–∞—Ä–º–µ–Ω', text: '–ê —Ç—ã —Å–ª—ã—à–∞–ª –ø—Ä–æ —Ç–æ–≥–æ —Å–∫–µ–ª–µ—Ç–∞ –≤ –ø–æ–¥–≤–∞–ª–µ?..' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ö–æ–Ω–µ—á–Ω–æ –Ω–µ —Å–ª—ã—à–∞–ª. –ù–æ —Å–∏–ª—å–Ω–æ –æ—Å—É–∂–¥–∞—é.' },
                { speaker: '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–ø', text: '–û–Ω –Ω–µ —Å–∫–µ–ª–µ—Ç. –û–Ω –ø—Ä–æ—Å—Ç–æ –æ—á–µ–Ω—å —Ö—É–¥–æ–π.' },
                { speaker: '–ù–∏–∫', text: '–ò —á—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç –≤ –ø–æ–¥–≤–∞–ª–µ?' },
                { speaker: '–°—Ç–∞—Ä–∏–∫-–±–∞—Ä–º–µ–Ω', text: '–°—á–∏—Ç–∞–µ—Ç –∫—Ä—ã—Å. –°—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ –∑–∞–≥–æ–≤–æ—Ä—â–∏–∫–∏.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–í—Å–µ –∫—Ä—ã—Å—ã ‚Äî –∑–∞–≥–æ–≤–æ—Ä—â–∏–∫–∏. –û—Å–æ–±–µ–Ω–Ω–æ –∂–∏—Ä–Ω—ã–µ.' },
                { speaker: '–ù–∏–∫', text: '–ê –ø—Ä–æ—Ç–∏–≤ –∫–æ–≥–æ –æ–Ω–∏ –∑–∞–≥–æ–≤–æ—Ä?' },
                { speaker: '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–ø', text: '–ü—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–∑–≤–æ—Å—Ç–∏. –≠—Ç–æ —Å—Ç—Ä–∞—à–Ω–∞—è —à—Ç—É–∫–∞.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–°–∞–º–∞—è —Å—Ç—Ä–∞—à–Ω–∞—è. –•—É–∂–µ –¥—Ä–∞–∫–æ–Ω–∞.' }
            ],
            
            godloves_dialogue: [
                { speaker: '–ù–∏–∫', text: '–ù–∞—Å –¥–≤–æ–µ. –ê –ë–æ–≥ –ª—é–±–∏—Ç —Ç—Ä–æ–∏—Ü—É...' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ó–¥–µ—Å—å —Ç—Ä–∏ –∫—Ä–æ–≤–∞—Ç–∏ –∏ —Å–µ–º—å –∫—Ä—É–∂–µ–∫. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —è–≤–Ω–æ –Ω–µ —Å—Ö–æ–¥–∏—Ç—Å—è.' },
                { speaker: '–ì–æ–ª–æ—Å –∏–∑ —Ç—å–º—ã', text: '–ë—ã–ª–æ –∏ –±–æ–ª—å—à–µ. –û–Ω–∏... —É—à–ª–∏.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–î–∞–≤–∞–π –ø—Ä–æ—Å—Ç–æ –Ω–µ —Å—á–∏—Ç–∞—Ç—å. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ ‚Äî —ç—Ç–æ —Å–∫—É—á–Ω–æ.' },
                { speaker: '–ù–∏–∫', text: '–ê —á—Ç–æ –∑–¥–µ—Å—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º?' },
                { speaker: '–ì–æ–ª–æ—Å –∏–∑ —Ç—å–º—ã', text: '–¢–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Ç—ã –Ω–µ –º–æ–∂–µ—à—å –∑–∞–±—ã—Ç—å.' },
                { speaker: '–ù–∏–∫', text: '–ê –µ—Å–ª–∏ —è –≤—Å—ë –∑–∞–±—ã–ª?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ó–Ω–∞—á–∏—Ç, —Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∏–ª.' },
                { speaker: '–ì–æ–ª–æ—Å –∏–∑ —Ç—å–º—ã', text: '–ò–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∂–∏–ª.' },
                { speaker: '–ù–∏–∫', text: '–ö–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ü—Ä–∏–º–µ—Ä–Ω–æ –≤ —Ç—Ä–∏ –≥–ª–æ—Ç–∫–∞.' }
            ],
            
            secret_dialogue: [
                { speaker: '–°—É–ø–µ—Ä–ú–µ–≥–∞–¢–∞–π–Ω–∞', text: '–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –±—ã—Ç—å —Ç–µ–º, –∫–µ–º –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Å–º–µ–ª–∏–ª—Å—è –±—ã.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ê –µ—Å–ª–∏ —è —Ö–æ—á—É –±—ã—Ç—å... –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º?' },
                { speaker: '–°—Ç–µ–Ω–∞ —à–µ–ø—á–µ—Ç', text: '–≠—Ç–æ —Å–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —Ä–æ–ª—å.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ù–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ –º–∏—Ñ. –ö–∞–∫ —Ä—É—Å–∞–ª–∫–∏.' },
                { speaker: '–ù–∏–∫', text: '–ê –µ—Å–ª–∏ —è –≤–µ—Ä—é –≤ —Ä—É—Å–∞–ª–æ–∫?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–¢–æ–≥–¥–∞ —Ç—ã —É–∂–µ –∑–¥–µ—Å—å, –≥–¥–µ –Ω—É–∂–Ω–æ.' },
                { speaker: '–ù–∏–∫', text: '–Ø –∑–¥–µ—Å—å –±—ã–ª... –º–Ω–æ–≥–æ —Ä–∞–∑.' },
                { speaker: '–°—É–ø–µ—Ä–ú–µ–≥–∞–¢–∞–π–Ω–∞', text: '–ú—ã –∑–Ω–∞–µ–º. –¢—ã –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ö–∞–∫ –∏ —è. –ú—ã –æ–±–∞ –∑–Ω–∞–µ–º —ç—Ç—É –∫–æ–º–Ω–∞—Ç—É –ª—É—á—à–µ, —á–µ–º —Å–≤–æ–∏ –∫–∞—Ä–º–∞–Ω—ã.' },
                { speaker: '–ù–∏–∫', text: '–ó–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –µ—Å—Ç—å... –¥–∞–∂–µ –∫–æ–≥–¥–∞ –Ω–∏–∫–æ–≥–æ –Ω–µ—Ç.' },
                { speaker: '–°—Ç–µ–Ω–∞ —à–µ–ø—á–µ—Ç', text: '–ü–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã –ø—Ä–∏–Ω–æ—Å–∏—à—å —Å–≤–æ–∏—Ö –¥–µ–º–æ–Ω–æ–≤ —Å —Å–æ–±–æ–π.' }
            ],
            
            tea_dialogue: [
                { speaker: '–ò–≥–æ—Ä—å', text: '–ó–Ω–∞–µ—à—å... –∏–Ω–æ–≥–¥–∞ —Ç–∏—à–∏–Ω–∞ –≥—Ä–æ–º—á–µ –ª—é–±–æ–≥–æ —à—É–º–∞.' },
                { speaker: '–ù–∏–∫', text: '–û—Å–æ–±–µ–Ω–Ω–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–µ—Ä–µ—Å—Ç–∞—ë—à—å –µ—ë –∏–∑–±–µ–≥–∞—Ç—å.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ú—ã –≤—Å–µ–≥–¥–∞ —à—É–º–µ–ª–∏. –í —à–∫–æ–ª–µ, –Ω–∞ —É–ª–∏—Ü–µ, –∑–¥–µ—Å—å...' },
                { speaker: '–ù–∏–∫', text: '–ü–æ—Ç–æ–º—É —á—Ç–æ –≤ —Ç–∏—à–∏–Ω–µ —Å–ª—ã—à–Ω–æ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–°–≤–æ–∏ –º—ã—Å–ª–∏. –°–≤–æ–∏ —Å–æ–∂–∞–ª–µ–Ω–∏—è. –°–≤–æ–∏ "–∞ —á—Ç–æ –µ—Å–ª–∏".' },
                { speaker: '–ù–∏–∫', text: '–ü–æ—ç—Ç–æ–º—É –º—ã –∑–¥–µ—Å—å. –ß—Ç–æ–±—ã –∑–∞–≥–ª—É—à–∏—Ç—å.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ù–µ –∑–∞–≥–ª—É—à–∏—Ç—å. –ü—Ä–æ—Å—Ç–æ... —Å–¥–µ–ª–∞—Ç—å —Ç–∏—à–µ.' },
                { speaker: '–ù–∏–∫', text: '–≠—Ç–æ—Ç —á–∞–π... –æ–Ω –Ω–µ –¥–µ–ª–∞–µ—Ç —Ç–∏—à–µ.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ù–µ—Ç. –û–Ω –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª—É—à–∞—Ç—å. –ü–æ—ç—Ç–æ–º—É –º—ã –µ–≥–æ –Ω–µ –ø—å—ë–º.' },
                { speaker: '–ù–∏–∫', text: '–ê –∑–∞—á–µ–º –æ–Ω —Ç–æ–≥–¥–∞ –∑–¥–µ—Å—å?' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ß—Ç–æ–±—ã –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å, —á—Ç–æ —Ç–∏—à–∏–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.' },
                { speaker: '–ù–∏–∫', text: '–ò —á—Ç–æ –º—ã –µ—ë –±–æ–∏–º—Å—è.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–ë–æ–ª—å—à–µ, —á–µ–º —á–µ–≥–æ –±—ã —Ç–æ –Ω–∏ –±—ã–ª–æ.' },
                { speaker: '–ù–∏–∫', text: '–î–∞–≤–∞–π –≤–µ—Ä–Ω—ë–º—Å—è –∫ —à—É–º—É.' },
                { speaker: '–ò–≥–æ—Ä—å', text: '–î–∞–≤–∞–π. –û–Ω –Ω–∞–¥—ë–∂–Ω–µ–µ.' }
            ],
            
            final_dialogues: [
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ü—è—Ç—å —á–∞—Å–æ–≤. –Ø —Ö–æ—Ç–µ–ª –Ω–∞ –ø—è—Ç—å –º–∏–Ω—É—Ç.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ù–æ –≤ —Ç–∞–≤–µ—Ä–Ω–µ –≤—Ä–µ–º—è —Ç–µ—á—ë—Ç –∏–Ω–∞—á–µ.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ó–¥–µ—Å—å –º–∏–Ω—É—Ç—ã —Ä–∞—Å—Ç—è–≥–∏–≤–∞—é—Ç—Å—è –≤ —á–∞—Å—ã, –∞ —á–∞—Å—ã ‚Äî –≤ –≤–µ—á–Ω–æ—Å—Ç—å.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ò–≥–æ—Ä—å —É–∂–µ —É—à—ë–ª. –ò–ª–∏ –Ω–µ—Ç? –Ø –Ω–µ –ø–æ–º–Ω—é.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ë–∞—Ä–º–µ–Ω –≤—ã—Ç–∏—Ä–∞–µ—Ç —Å—Ç–æ–π–∫—É. –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ—Å—Ç–∏ –∫–æ–≤—ã–ª—è—é—Ç –∫ –≤—ã—Ö–æ–¥—É.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ê —è –≤—Å—ë —Å–∏–∂—É. –ü–æ—Ç–æ–º—É —á—Ç–æ –≤—ã–π—Ç–∏ ‚Äî –∑–Ω–∞—á–∏—Ç –ø—Ä–∏–∑–Ω–∞—Ç—å, —á—Ç–æ –≤—Ä–µ–º—è –ø—Ä–æ—à–ª–æ.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ß—Ç–æ —ç—Ç–∏ –ø—è—Ç—å —á–∞—Å–æ–≤ –±—ã–ª–∏ –ø–æ—Ç—Ä–∞—á–µ–Ω—ã. –ß—Ç–æ —è —Å–Ω–æ–≤–∞ –ø—Ä–æ–∏–≥—Ä–∞–ª.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ù–æ –≤ —Ç–∞–≤–µ—Ä–Ω–µ –Ω–µ—Ç –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –∏ –ø—Ä–æ–∏–≥—Ä–∞–≤—à–∏—Ö.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ó–¥–µ—Å—å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ, –∫—Ç–æ –µ—â—ë —Å–∏–¥–∏—Ç, –∏ —Ç–µ, –∫—Ç–æ —É–∂–µ —É—à—ë–ª.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–°–µ–≥–æ–¥–Ω—è —è –µ—â—ë —Å–∏–∂—É.' },
                { speaker: '–ù–∏–∫ (–º—ã—Å–ª–µ–Ω–Ω–æ)', text: '–ó–∞–≤—Ç—Ä–∞... –∑–∞–≤—Ç—Ä–∞ –ø–æ—Å–º–æ—Ç—Ä–∏–º.' },
                { speaker: '–ë–∞—Ä–º–µ–Ω', text: '–ó–∞–∫—Ä—ã–≤–∞–µ–º—Å—è. –ò–¥–∏ –¥–æ–º–æ–π, –ù–∏–∫.' },
                { speaker: '–ù–∏–∫', text: '–î–æ–º–æ–π? –ê –≥–¥–µ —ç—Ç–æ?' },
                { speaker: '–ë–∞—Ä–º–µ–Ω', text: '–¢–∞–º, –≥–¥–µ —Ç–µ–±—è –∂–¥—É—Ç. –ò–ª–∏ –Ω–µ –∂–¥—É—Ç. –ö–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞?' },
                { speaker: '–ù–∏–∫', text: '–î–∞. –ö–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞...' }
            ]
        };
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const mainMenu = document.getElementById('main-menu');
        const mainScene = document.getElementById('main-scene');
        const clickerGame = document.getElementById('clicker-game');
        const finalScreen = document.getElementById('final-screen');
        const mainText = document.getElementById('main-text');
        const nextButton = document.getElementById('next-btn'); // –ì–õ–ê–í–ù–ê–Ø –ö–ù–û–ü–ö–ê "–î–ê–õ–ï–ï"
        const clickerNextButton = document.getElementById('clicker-next-btn');
        const timer = document.getElementById('timer');
        const progressFill = document.getElementById('progress-fill');
        const beerClicker = document.getElementById('beer-clicker');
        const clickCount = document.getElementById('click-count');
        const drunkLevelEl = document.getElementById('drunk-level');
        const speedLevel = document.getElementById('speed-level');
        const goalCount = document.getElementById('goal-count');
        const bubblesContainer = document.getElementById('bubbles-container');
        const tavernInsideVideo = document.getElementById('tavern-inside-video');
        const beerVideo = document.getElementById('beer-video');
        const enterTavernBtn = document.getElementById('enter-tavern-btn');
        const loadingIndicator = document.getElementById('loading-indicator');
        const restartBtn = document.getElementById('restart-btn');
        const eventMessage = document.getElementById('event-message');
        const eventEffect = document.getElementById('event-effect');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∞—É–¥–∏–æ
        const backgroundMusic = document.getElementById('background-music');
        const volumeSlider = document.getElementById('volume-slider');
        const volumeValue = document.getElementById('volume-value');
        const toggleVolumeBtn = document.getElementById('toggle-volume-btn');
        const volumeControls = document.getElementById('volume-controls');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∫–æ–º–Ω–∞—Ç
        const roomTextElements = {
            paladin: document.getElementById('paladin-text'),
            rats: document.getElementById('rats-text'),
            godloves: document.getElementById('godloves-text'),
            secret: document.getElementById('secret-text'),
            tea: document.getElementById('tea-text')
        };
        
        // –ö–Ω–æ–ø–∫–∏ –∫–æ–º–Ω–∞—Ç
        const roomNextButtons = {
            paladin: document.getElementById('paladin-next-btn'),
            rats: document.getElementById('rats-next-btn'),
            godloves: document.getElementById('godloves-next-btn'),
            secret: document.getElementById('secret-next-btn'),
            tea: document.getElementById('tea-next-btn')
        };
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—á–∞—Ç–∞—é—â–µ–≥–æ—Å—è —Ç–µ–∫—Å—Ç–∞
        function typeText(element, text, onComplete) {
            if (gameState.isTyping) {
                clearInterval(gameState.typingInterval);
                gameState.isTyping = false;
                element.innerHTML = text;
                if (onComplete) onComplete();
                return;
            }
            
            gameState.isTyping = true;
            element.innerHTML = '';
            
            let charIndex = 0;
            let speakerName = '';
            let dialogueText = '';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–º—è –≥–æ–≤–æ—Ä—è—â–µ–≥–æ
            const lines = text.split('<br>');
            if (lines[0].includes('speaker-name')) {
                speakerName = lines[0];
                dialogueText = lines.slice(1).join('<br>');
            } else {
                dialogueText = text;
            }
            
            if (speakerName) {
                element.innerHTML = speakerName + '<br>';
            }
            
            const textSpan = document.createElement('span');
            textSpan.className = 'typing-text';
            element.appendChild(textSpan);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫—É—Ä—Å–æ—Ä
            const cursor = document.createElement('span');
            cursor.className = 'typing-cursor';
            textSpan.appendChild(cursor);
            
            gameState.typingInterval = setInterval(() => {
                if (charIndex < dialogueText.length) {
                    const char = dialogueText[charIndex];
                    
                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ HTML —Ç–µ–≥–æ–≤
                    if (char === '<') {
                        const tagEnd = dialogueText.indexOf('>', charIndex);
                        if (tagEnd !== -1) {
                            const tag = dialogueText.substring(charIndex, tagEnd + 1);
                            const tempDiv = document.createElement('div');
                            tempDiv.innerHTML = tag;
                            const node = tempDiv.firstChild;
                            if (node) {
                                textSpan.insertBefore(node, cursor);
                            }
                            charIndex = tagEnd;
                        }
                    } else {
                        const charSpan = document.createElement('span');
                        charSpan.className = 'text-char';
                        charSpan.textContent = char;
                        charSpan.style.animationDelay = `${charIndex * 0.03}s`;
                        textSpan.insertBefore(charSpan, cursor);
                    }
                    
                    charIndex++;
                } else {
                    clearInterval(gameState.typingInterval);
                    gameState.isTyping = false;
                    
                    // –£–±–∏—Ä–∞–µ–º –∫—É—Ä—Å–æ—Ä
                    cursor.remove();
                    
                    // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" –ø–æ—Å–ª–µ –ø–µ—á–∞—Ç–∏ —Ç–µ–∫—Å—Ç–∞
                    if (nextButton) {
                        nextButton.style.display = 'flex';
                        nextButton.style.opacity = '1';
                    }
                    
                    if (onComplete) onComplete();
                }
            }, gameState.typingSpeed);
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º—É–∑—ã–∫–æ–π
        function initAudio() {
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
            gameState.musicVolume = 0.5;
            backgroundMusic.volume = gameState.musicVolume;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–∞–π–¥–µ—Ä–∞
            if (volumeSlider) {
                volumeSlider.value = gameState.musicVolume * 100;
                updateVolumeDisplay();
                
                // –°–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏
                volumeSlider.addEventListener('input', function() {
                    gameState.musicVolume = this.value / 100;
                    backgroundMusic.volume = gameState.musicVolume;
                    updateVolumeDisplay();
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –º–∏–∫—à–µ—Ä–∞
            if (toggleVolumeBtn) {
                toggleVolumeBtn.addEventListener('click', toggleVolumeControls);
            }
            
            // –ü–æ–ø—ã—Ç–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º—É–∑—ã–∫–∏ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
            document.addEventListener('click', function() {
                if (backgroundMusic.paused) {
                    backgroundMusic.play().catch(e => {
                        console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –º—É–∑—ã–∫—É:', e);
                    });
                }
            });
        }
        
        function updateVolumeDisplay() {
            if (volumeValue) {
                volumeValue.textContent = `${Math.round(gameState.musicVolume * 100)}%`;
            }
        }
        
        function toggleVolumeControls() {
            gameState.volumeControlsVisible = !gameState.volumeControlsVisible;
            
            if (gameState.volumeControlsVisible) {
                volumeControls.classList.add('visible');
            } else {
                volumeControls.classList.remove('visible');
            }
        }
        
        function startBackgroundMusic() {
            backgroundMusic.volume = gameState.musicVolume;
            backgroundMusic.play().then(() => {
                console.log('–§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞');
            }).catch(e => {
                console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –º—É–∑—ã–∫—É:', e);
                // –ü–æ–ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ
                document.addEventListener('click', function startOnClick() {
                    backgroundMusic.play().catch(e => console.log('–í—Å–µ –µ—â–µ –Ω–µ —É–¥–∞–ª–æ—Å—å:', e));
                    document.removeEventListener('click', startOnClick);
                });
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–≤–µ—Ä–Ω—ã...');
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏–æ
            initAudio();
            
            // –°–æ–±—ã—Ç–∏—è –∫–Ω–æ–ø–æ–∫
            enterTavernBtn.addEventListener('click', startGame);
            restartBtn.addEventListener('click', restartGame);
            
            // –ì–õ–ê–í–ù–û–ï: –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–î–∞–ª–µ–µ"
            if (nextButton) {
                nextButton.addEventListener('click', handleNextButton);
                nextButton.style.display = 'flex'; // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–∏–º–∞
                nextButton.style.opacity = '1';
            } else {
                console.error('–ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
            }
            
            clickerNextButton.addEventListener('click', handleClickerNextButton);
            beerClicker.addEventListener('click', handleBeerClick);
            
            // –ö–Ω–æ–ø–∫–∏ –∫–æ–º–Ω–∞—Ç
            roomNextButtons.paladin.addEventListener('click', () => handleRoomNext('paladin'));
            roomNextButtons.rats.addEventListener('click', () => handleRoomNext('rats'));
            roomNextButtons.godloves.addEventListener('click', () => handleRoomNext('godloves'));
            roomNextButtons.secret.addEventListener('click', () => handleRoomNext('secret'));
            roomNextButtons.tea.addEventListener('click', () => handleRoomNext('tea'));
            
            // –¢–∞–π–º–µ—Ä
            setInterval(updateTimer, 1000);
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–∑—ã—Ä—å–∫–æ–≤
            createBubbles();
            
            console.log('–¢–∞–≤–µ—Ä–Ω–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º');
        }
        
        function createBubbles() {
            if (!bubblesContainer) return;
            
            for (let i = 0; i < 25; i++) {
                createBubble();
            }
        }
        
        function createBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            const size = Math.random() * 15 + 5;
            bubble.style.width = `${size}px`;
            bubble.style.height = `${size}px`;
            bubble.style.left = `${Math.random() * 100 + 10}px`;
            bubble.style.animationDelay = `${Math.random() * 5}s`;
            bubble.style.animationDuration = `${Math.random() * 2 + 2}s`;
            bubble.style.backgroundColor = `rgba(255, 255, 255, ${0.3 + Math.random() * 0.4})`;
            bubble.style.borderRadius = '50%';
            bubblesContainer.appendChild(bubble);
            
            setTimeout(() => {
                if (bubble.parentNode === bubblesContainer) {
                    bubble.remove();
                    createBubble();
                }
            }, 5000);
        }
        
        function startGame() {
            console.log('–í—Ö–æ–¥ –≤ —Ç–∞–≤–µ—Ä–Ω—É...');
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
            enterTavernBtn.style.animation = 'none';
            enterTavernBtn.style.transform = 'scale(0.95)';
            enterTavernBtn.style.opacity = '0.7';
            enterTavernBtn.disabled = true;
            enterTavernBtn.innerHTML = 'üö™ –í—Ö–æ–¥–∏–º...';
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            loadingIndicator.style.display = 'block';
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤—É—é –º—É–∑—ã–∫—É
            startBackgroundMusic();
            
            // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞
            setTimeout(() => {
                mainMenu.classList.remove('visible');
                mainMenu.classList.add('hidden');
                mainScene.classList.remove('hidden');
                mainScene.classList.add('visible');
                gameState.currentScene = 'main_scene';
                
                // –°–∫—Ä—ã—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                loadingIndicator.style.display = 'none';
                
                // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É
                enterTavernBtn.style.animation = 'buttonPulse 3s infinite';
                enterTavernBtn.style.transform = '';
                enterTavernBtn.style.opacity = '';
                enterTavernBtn.disabled = false;
                enterTavernBtn.innerHTML = 'üö™ –í–æ–π—Ç–∏ –≤ —Ç–∞–≤–µ—Ä–Ω—É';
                
                // –ì–õ–ê–í–ù–û–ï: –î–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" –≤–∏–¥–∏–º–æ–π
                if (nextButton) {
                    nextButton.style.display = 'flex';
                    nextButton.style.opacity = '1';
                }
                
                // –ù–∞—á–∏–Ω–∞–µ–º –ø–µ—Ä–≤—ã–π –¥–∏–∞–ª–æ–≥
                startDialogue('tavern_enter');
            }, 1500);
        }
        
        function startDialogue(dialogueSet) {
            console.log('–ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–ª–æ–≥:', dialogueSet);
            gameState.currentDialogueSet = dialogueSet;
            gameState.currentDialogueIndex = 0;
            
            if (dialogues[dialogueSet]) {
                showCurrentDialogue();
            }
        }
        
        function showCurrentDialogue() {
            const dialogueSet = dialogues[gameState.currentDialogueSet];
            
            if (!dialogueSet || gameState.currentDialogueIndex >= dialogueSet.length) {
                // –î–∏–∞–ª–æ–≥–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ü–µ–Ω–µ
                console.log('–î–∏–∞–ª–æ–≥–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –¥–∞–ª—å—à–µ');
                handleDialogueEnd();
                return;
            }
            
            const dialogue = dialogueSet[gameState.currentDialogueIndex];
            const dialogueHTML = `<span class="speaker-name">${dialogue.speaker}</span><br>${dialogue.text}`;
            
            console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥:', dialogue.speaker, dialogue.text);
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–µ–∫—Å—Ç
            if (mainText) {
                mainText.innerHTML = '';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            if (mainText) {
                typeText(mainText, dialogueHTML, () => {
                    // –ö–æ–≥–¥–∞ —Ç–µ–∫—Å—Ç –Ω–∞–ø–µ—á–∞—Ç–∞–Ω, —É–±–µ–¥–∏–º—Å—è —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–∏–º–∞
                    if (nextButton) {
                        nextButton.style.display = 'flex';
                        nextButton.style.opacity = '1';
                    }
                });
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" (–Ω–æ –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π –ø–æ–∫–∞ –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è)
            if (nextButton) {
                nextButton.style.display = 'flex';
                nextButton.style.opacity = '0.7';
            }
        }
        
        // –ì–õ–ê–í–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –ö–ù–û–ü–ö–ò "–î–ê–õ–ï–ï"
        function handleNextButton() {
            console.log('–ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ", —Ç–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å:', gameState.currentDialogueIndex);
            
            // –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è, –∑–∞–≤–µ—Ä—à–∞–µ–º –ø–µ—á–∞—Ç—å
            if (gameState.isTyping) {
                console.log('–ó–∞–≤–µ—Ä—à–∞–µ–º –ø–µ—á–∞—Ç—å —Ç–µ–∫—Å—Ç–∞');
                clearInterval(gameState.typingInterval);
                gameState.isTyping = false;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç —Å—Ä–∞–∑—É
                const dialogueSet = dialogues[gameState.currentDialogueSet];
                const dialogue = dialogueSet[gameState.currentDialogueIndex];
                const dialogueHTML = `<span class="speaker-name">${dialogue.speaker}</span><br>${dialogue.text}`;
                
                if (mainText) {
                    mainText.innerHTML = dialogueHTML;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
                if (nextButton) {
                    nextButton.style.display = 'flex';
                    nextButton.style.opacity = '1';
                }
                
                return;
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–∏–∞–ª–æ–≥—É
            gameState.currentDialogueIndex++;
            console.log('–ù–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å –¥–∏–∞–ª–æ–≥–∞:', gameState.currentDialogueIndex);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –¥–∏–∞–ª–æ–≥
            showCurrentDialogue();
        }
        
        function handleDialogueEnd() {
            console.log('–î–∏–∞–ª–æ–≥ –∑–∞–≤–µ—Ä—à–µ–Ω, —Ç–µ–∫—É—â–∏–π –Ω–∞–±–æ—Ä:', gameState.currentDialogueSet);
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —á—Ç–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
            switch (gameState.currentDialogueSet) {
                case 'tavern_enter':
                    console.log('–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ friend_meet');
                    startDialogue('friend_meet');
                    break;
                    
                case 'friend_meet':
                    console.log('–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ friend_offer');
                    startDialogue('friend_offer');
                    break;
                    
                case 'friend_offer':
                    console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è');
                    // –ü–æ—Å–ª–µ –¥–∏–∞–ª–æ–≥–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è
                    if (!gameState.actionButtonsShown) {
                        showActionChoice();
                        gameState.actionButtonsShown = true;
                    }
                    break;
                    
                case 'tavern_noise':
                    // –ü–æ—Å–ª–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è —à—É–º–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—é
                    startDialogue('friend_offer');
                    break;
                    
                case 'clicker_end':
                    // –ü–æ—Å–ª–µ –∫–ª–∏–∫–µ—Ä–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤—ã–±–æ—Ä—É –∫–æ–º–Ω–∞—Ç
                    startDialogue('room_select');
                    break;
                    
                case 'room_select':
                    // –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–æ–º–Ω–∞—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –≤—ã–±–æ—Ä–∞
                    showRoomSelection();
                    break;
                    
                case 'paladin_dialogue':
                case 'rats_dialogue':
                case 'godloves_dialogue':
                case 'secret_dialogue':
                    // –ü–æ—Å–ª–µ –¥–∏–∞–ª–æ–≥–æ–≤ –≤ –∫–æ–º–Ω–∞—Ç–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≤—ã–±–æ—Ä—É –∫–æ–º–Ω–∞—Ç
                    goBackToRoomSelect();
                    break;
                    
                case 'tea_dialogue':
                    // –ü–æ—Å–ª–µ –¥–∏–∞–ª–æ–≥–∞ –≤ –∫–æ–º–Ω–∞—Ç–µ —á–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª
                    showFinalScreenWithDialogues();
                    break;
            }
        }
        
        function showActionChoice() {
            console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è');
            
            // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞
            const buttonsContainer = document.createElement('div');
            buttonsContainer.className = 'buttons-container';
            buttonsContainer.style.marginTop = '15px';
            buttonsContainer.style.display = 'flex';
            buttonsContainer.style.gap = '10px';
            buttonsContainer.style.justifyContent = 'center';
            
            const button1 = document.createElement('button');
            button1.className = 'pixel-button';
            button1.textContent = 'üç∫ –ü—Ä–∏–Ω—è—Ç—å –≤—ã–∑–æ–≤';
            button1.style.fontSize = '10px';
            button1.style.padding = '8px 12px';
            button1.addEventListener('click', startClickerGame);
            
            const button2 = document.createElement('button');
            button2.className = 'pixel-button';
            button2.textContent = 'üëÇ –°–ª—É—à–∞—Ç—å —à—É–º';
            button2.style.fontSize = '10px';
            button2.style.padding = '8px 12px';
            button2.addEventListener('click', () => {
                startDialogue('tavern_noise');
                buttonsContainer.remove();
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
                if (nextButton) {
                    nextButton.style.display = 'flex';
                }
            });
            
            buttonsContainer.appendChild(button1);
            buttonsContainer.appendChild(button2);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" –Ω–∞ –≤—Ä–µ–º—è –≤—ã–±–æ—Ä–∞
            if (nextButton) {
                nextButton.style.display = 'none';
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞
            if (mainText && mainText.parentNode) {
                mainText.parentNode.appendChild(buttonsContainer);
            }
        }
        
        function showRoomSelection() {
            console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –∫–æ–º–Ω–∞—Ç');
            
            // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–æ–º–Ω–∞—Ç
            const buttonsContainer = document.createElement('div');
            buttonsContainer.className = 'buttons-container';
            buttonsContainer.style.marginTop = '15px';
            buttonsContainer.style.display = 'flex';
            buttonsContainer.style.flexWrap = 'wrap';
            buttonsContainer.style.gap = '10px';
            buttonsContainer.style.justifyContent = 'center';
            
            const rooms = [
                { id: 'paladin', text: '‚öîÔ∏è –ü–∞–ª–∞–¥–∏–Ω—Å–æ–±–æ–ª', dialogue: 'paladin_dialogue' },
                { id: 'rats', text: 'üêÄ –ö—Ä—ã—Å–∏—Ç—å', dialogue: 'rats_dialogue' },
                { id: 'godloves', text: '‚ò¶Ô∏è –ë–æ–≥–ª—é–±–∏—Ç—Ç—Ä–æ–∏—Ü—É', dialogue: 'godloves_dialogue' },
                { id: 'secret', text: 'üîÆ –°—É–ø–µ—Ä–ú–µ–≥–∞–¢–∞–π–Ω–∞', dialogue: 'secret_dialogue' },
                { id: 'tea', text: '‚òï –ß–∞–π –≤–¥–≤–æ—ë–º', dialogue: 'tea_dialogue' }
            ];
            
            rooms.forEach(room => {
                const button = document.createElement('button');
                button.className = 'pixel-button';
                button.textContent = room.text;
                button.style.fontSize = '10px';
                button.style.padding = '6px 10px';
                button.addEventListener('click', () => {
                    showRoom(room.id, room.dialogue);
                    buttonsContainer.remove();
                });
                buttonsContainer.appendChild(button);
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" –Ω–∞ –≤—Ä–µ–º—è –≤—ã–±–æ—Ä–∞
            if (nextButton) {
                nextButton.style.display = 'none';
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞
            if (mainText && mainText.parentNode) {
                mainText.parentNode.appendChild(buttonsContainer);
            }
        }
        
        function handleClickerNextButton() {
            console.log('–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ –∫–ª–∏–∫–µ—Ä–∞');
            
            // –£–±–∏—Ä–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
            const buttonsContainer = document.querySelector('.buttons-container');
            if (buttonsContainer) {
                buttonsContainer.remove();
            }
            
            // –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
            if (gameState.progressInterval) {
                clearInterval(gameState.progressInterval);
                gameState.progressInterval = null;
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–ª–∏–∫–µ—Ä
            clickerGame.classList.remove('visible');
            clickerGame.classList.add('hidden');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ü–µ–Ω—É
            mainScene.classList.remove('hidden');
            mainScene.classList.add('visible');
            gameState.currentScene = 'main_scene';
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
            if (nextButton) {
                nextButton.style.display = 'flex';
            }
            
            // –ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–ª–æ–≥ –ø–æ—Å–ª–µ –∫–ª–∏–∫–µ—Ä–∞
            startDialogue('clicker_end');
        }
        
        function updateTimer() {
            gameState.timeInTavern++;
            const minutes = Math.floor(gameState.timeInTavern / 60);
            const seconds = gameState.timeInTavern % 60;
            
            let timeText = `[${minutes}:${seconds.toString().padStart(2, '0')}]`;
            
            if (minutes >= 1) {
                timeText = `[–£–∂–µ ${minutes} –º–∏–Ω${minutes === 1 ? '—É—Ç–∞' : '—É—Ç'}]`;
            }
            
            if (minutes >= 5) {
                timeText = `[${minutes} –º–∏–Ω—É—Ç... —Ç—ã –∂–µ —Ö–æ—Ç–µ–ª –Ω–∞ –º–∏–Ω—É—Ç—É!]`;
            }
            
            if (timer) {
                timer.textContent = timeText;
            }
        }
        
        function startClickerGame() {
            console.log('–ó–∞–ø—É—Å–∫ –ø–∏–≤–Ω–æ–≥–æ –∫–ª–∏–∫–µ—Ä–∞ - –Ω—É–∂–Ω–æ 50 –≥–ª–æ—Ç–∫–æ–≤!');
            
            // –£–±–∏—Ä–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
            const buttonsContainer = document.querySelector('.buttons-container');
            if (buttonsContainer) {
                buttonsContainer.remove();
            }
            
            mainScene.classList.remove('visible');
            mainScene.classList.add('hidden');
            clickerGame.classList.remove('hidden');
            clickerGame.classList.add('visible');
            gameState.currentScene = 'clicker_game';
            
            gameState.clickerActive = true;
            gameState.beerLevel = 100;
            gameState.clickCount = 0;
            gameState.drunkLevel = 0;
            gameState.gameSpeed = 1.0;
            gameState.clickerCompleted = false;
            gameState.clicksSinceLastEvent = 0;
            gameState.clicksForNextEvent = getRandomClicksForEvent();
            gameState.eventsTriggered = 0;
            gameState.eventActive = false;
            
            if (goalCount) {
                goalCount.textContent = `${gameState.requiredClicks} –≥–ª–æ—Ç–∫–æ–≤`;
            }
            
            console.log(`–ü–µ—Ä–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ —á–µ—Ä–µ–∑ ${gameState.clicksForNextEvent} –∫–ª–∏–∫–æ–≤`);
            
            // –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
            clickerNextButton.style.display = 'none';
            
            updateClickerDisplay();
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
            if (gameState.progressInterval) {
                clearInterval(gameState.progressInterval);
            }
            
            // –ü—Ä–æ–≥—Ä–µ—Å—Å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ú–ï–î–õ–ï–ù–ù–ï–ï
            gameState.progressInterval = setInterval(() => {
                if (!gameState.clickerActive) {
                    clearInterval(gameState.progressInterval);
                    return;
                }
                
                // –û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø–∏–≤–∞
                gameState.beerLevel -= (0.15 * gameState.gameSpeed);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ –µ—Å–ª–∏ –ø–∏–≤–∞ –æ—á–µ–Ω—å –º–∞–ª–æ
                if (gameState.beerLevel < 15 && !gameState.eventActive && gameState.eventsTriggered < gameState.maxEvents) {
                    triggerRandomEvent();
                }
                
                if (gameState.beerLevel <= 0) {
                    gameState.beerLevel = 0;
                    endClickerGame(false);
                    clearInterval(gameState.progressInterval);
                }
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
                if (gameState.clickCount > 15) gameState.gameSpeed = 1.1;
                if (gameState.clickCount > 30) gameState.gameSpeed = 1.3;
                if (gameState.clickCount > 40) gameState.gameSpeed = 1.5;
                
                updateClickerDisplay();
            }, 100);
        }
        
        function triggerRandomEvent() {
            if (gameState.eventActive) return;
            
            gameState.eventActive = true;
            gameState.eventsTriggered++;
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
            const randomIndex = Math.floor(Math.random() * tavernEvents.length);
            const event = tavernEvents[randomIndex];
            
            console.log(`–°–æ–±—ã—Ç–∏–µ ${gameState.eventsTriggered}: ${event.name}, –ø–æ—Ç–µ—Ä—è –ø–∏–≤–∞: ${event.beerLoss}% (–≤—Å–µ–≥–æ ${gameState.beerLevel}%)`);
            
            // –û—Ç–Ω–∏–º–∞–µ–º –ø–∏–≤–æ
            const oldBeerLevel = gameState.beerLevel;
            gameState.beerLevel = Math.max(0, gameState.beerLevel - event.beerLoss);
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–±—ã—Ç–∏—è
            gameState.clicksSinceLastEvent = 0;
            gameState.clicksForNextEvent = getRandomClicksForEvent();
            console.log(`–°–ª–µ–¥—É—é—â–µ–µ —Å–æ–±—ã—Ç–∏–µ —á–µ—Ä–µ–∑ ${gameState.clicksForNextEvent} –∫–ª–∏–∫–æ–≤`);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏
            if (eventMessage) {
                eventMessage.textContent = event.message;
                eventMessage.style.display = 'block';
                eventMessage.style.animation = 'none';
                setTimeout(() => {
                    eventMessage.style.animation = 'eventMessage 2s forwards';
                }, 10);
                
                // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    eventMessage.style.display = 'none';
                }, 2000);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ª–µ–≥–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç
            if (eventEffect) {
                eventEffect.style.display = 'block';
                eventEffect.className = 'event-effect event-shake';
                
                setTimeout(() => {
                    eventEffect.style.display = 'none';
                    eventEffect.className = 'event-effect';
                }, 500);
            }
            
            // –õ–µ–≥–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å—Ç–∞–∫–∞–Ω–∞ –ø–∏–≤–∞
            if (beerClicker) {
                beerClicker.style.transform = 'scale(1.05)';
                
                setTimeout(() => {
                    beerClicker.style.transform = 'scale(1)';
                }, 200);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateClickerDisplay();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å –ª–∏ –ø–∏–≤–æ
            if (gameState.beerLevel <= 0) {
                setTimeout(() => {
                    gameState.beerLevel = 0;
                    endClickerGame(false);
                    if (gameState.progressInterval) {
                        clearInterval(gameState.progressInterval);
                    }
                }, 500);
            }
            
            // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                gameState.eventActive = false;
            }, 1500);
        }
        
        function handleBeerClick() {
            if (!gameState.clickerActive || gameState.clickerCompleted || gameState.eventActive) return;
            
            gameState.clickCount++;
            gameState.clicksSinceLastEvent++;
            gameState.beerLevel += 7;
            gameState.drunkLevel += 1.5;
            
            if (gameState.beerLevel > 100) {
                gameState.beerLevel = 100;
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞
            beerClicker.style.transform = 'scale(0.9)';
            setTimeout(() => {
                beerClicker.style.transform = 'scale(1)';
            }, 80);
            
            // –°–æ–∑–¥–∞—ë–º –ø—É–∑—ã—Ä—ë–∫
            createClickBubble();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–±—ã—Ç–∏—è
            if (gameState.clicksSinceLastEvent >= gameState.clicksForNextEvent && 
                gameState.eventsTriggered < gameState.maxEvents && 
                !gameState.eventActive) {
                triggerRandomEvent();
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã - –Ω—É–∂–Ω–æ 50 –≥–ª–æ—Ç–∫–æ–≤
            if (gameState.clickCount >= gameState.requiredClicks) {
                gameState.clickerCompleted = true;
                endClickerGame(true);
            }
            
            updateClickerDisplay();
        }
        
        function createClickBubble() {
            if (!bubblesContainer) return;
            
            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            const size = Math.random() * 15 + 6;
            bubble.style.width = `${size}px`;
            bubble.style.height = `${size}px`;
            bubble.style.left = `${Math.random() * 100 + 10}px`;
            bubble.style.bottom = '30px';
            bubble.style.position = 'absolute';
            bubble.style.animation = 'bubbleRise 1.2s forwards';
            bubble.style.backgroundColor = `rgba(255, 255, 255, ${0.4 + Math.random() * 0.3})`;
            bubble.style.borderRadius = '50%';
            bubblesContainer.appendChild(bubble);
            
            setTimeout(() => {
                bubble.remove();
            }, 1200);
        }
        
        function updateClickerDisplay() {
            if (progressFill) {
                progressFill.style.width = `${gameState.beerLevel}%`;
                
                // –¶–≤–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
                if (gameState.beerLevel > 70) {
                    progressFill.style.background = 'linear-gradient(90deg, #8b7355, #b89a6d, #ffd700)';
                } else if (gameState.beerLevel > 30) {
                    progressFill.style.background = 'linear-gradient(90deg, #b89a6d, #ffd700, #ffa500)';
                } else {
                    progressFill.style.background = 'linear-gradient(90deg, #ffa500, #ff6b6b, #ff0000)';
                    // –ú–∏–≥–∞–Ω–∏–µ –ø—Ä–∏ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ
                    if (gameState.beerLevel < 20) {
                        progressFill.style.animation = 'pulse 0.5s infinite';
                    } else {
                        progressFill.style.animation = 'none';
                    }
                }
            }
            
            if (clickCount) {
                clickCount.textContent = gameState.clickCount;
                // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫ —Ü–µ–ª–∏
                if (goalCount) {
                    goalCount.textContent = `${gameState.clickCount}/${gameState.requiredClicks} –≥–ª–æ—Ç–∫–æ–≤`;
                }
            }
            
            if (drunkLevelEl) {
                drunkLevelEl.textContent = `${Math.min(100, Math.floor(gameState.drunkLevel))}%`;
            }
            
            if (speedLevel) {
                speedLevel.textContent = `${gameState.gameSpeed.toFixed(1)}x`;
            }
        }
        
        function endClickerGame(success) {
            console.log('–ö–æ–Ω–µ—Ü –∫–ª–∏–∫–µ—Ä–∞, —É—Å–ø–µ—Ö:', success);
            gameState.clickerActive = false;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
            clickerNextButton.style.display = 'block';
            
            if (success) {
                clickerNextButton.textContent = 'üéâ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å!';
                clickerNextButton.onclick = handleClickerNextButton;
            } else {
                clickerNextButton.textContent = 'üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞';
                clickerNextButton.onclick = startClickerGame;
            }
        }
        
        function showRoom(roomName, dialogueSet) {
            console.log('–í—Ö–æ–¥–∏–º –≤ –∫–æ–º–Ω–∞—Ç—É:', roomName);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–Ω–∞—Ç—É –≤ –ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ
            if (!gameState.visitedRooms.includes(roomName)) {
                gameState.visitedRooms.push(roomName);
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∫–æ–º–Ω–∞—Ç—ã –∏ –¥—Ä—É–≥–∏–µ —Å—Ü–µ–Ω—ã
            document.querySelectorAll('.scene-content').forEach(el => {
                el.classList.remove('visible');
                el.classList.add('hidden');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ–º–Ω–∞—Ç—É
            const roomElement = document.getElementById(`room-${roomName}`);
            if (roomElement) {
                roomElement.classList.remove('hidden');
                roomElement.classList.add('visible');
                gameState.currentScene = `room_${roomName}`;
                
                // –ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–ª–æ–≥ –∫–æ–º–Ω–∞—Ç—ã
                startDialogue(dialogueSet);
            }
        }
        
        function handleRoomNext(roomName) {
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–ø–ª–∏–∫–µ –≤ –∫–æ–º–Ω–∞—Ç–µ
            gameState.currentDialogueIndex++;
            
            if (gameState.currentDialogueIndex < dialogues[`${roomName}_dialogue`].length) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Ä–µ–ø–ª–∏–∫—É
                const dialogue = dialogues[`${roomName}_dialogue`][gameState.currentDialogueIndex];
                const dialogueHTML = `<span class="speaker-name">${dialogue.speaker}</span><br>${dialogue.text}`;
                const textElement = roomTextElements[roomName];
                
                if (textElement) {
                    typeText(textElement, dialogueHTML);
                }
            } else {
                // –î–∏–∞–ª–æ–≥–∏ –≤ –∫–æ–º–Ω–∞—Ç–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å
                if (roomName === 'tea') {
                    // –î–ª—è –∫–æ–º–Ω–∞—Ç—ã —á–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª
                    showFinalScreenWithDialogues();
                } else {
                    // –î–ª—è –¥—Ä—É–≥–∏—Ö –∫–æ–º–Ω–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≤—ã–±–æ—Ä—É
                    goBackToRoomSelect();
                }
            }
        }
        
        function goBackToRoomSelect() {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∫–æ–º–Ω–∞—Ç—ã
            document.querySelectorAll('.scene-content').forEach(el => {
                if (el.id.startsWith('room-')) {
                    el.classList.remove('visible');
                    el.classList.add('hidden');
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ü–µ–Ω—É
            mainScene.classList.remove('hidden');
            mainScene.classList.add('visible');
            gameState.currentScene = 'main_scene';
            
            // –°–±—Ä–æ—Å –∏–Ω–¥–µ–∫—Å–∞ –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–º–Ω–∞—Ç
            gameState.currentDialogueIndex = 0;
            gameState.currentDialogueSet = 'room_select';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –∫–æ–º–Ω–∞—Ç —Å–Ω–æ–≤–∞
            showRoomSelection();
        }
        
        function showFinalScreenWithDialogues() {
            console.log('–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∫–≤–µ—Å—Ç–∞ —Å –¥–∏–∞–ª–æ–≥–∞–º–∏');
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞
            if (gameState.isTyping) {
                clearInterval(gameState.typingInterval);
                gameState.isTyping = false;
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ü–µ–Ω—ã
            document.querySelectorAll('.scene-content').forEach(el => {
                if (el.id !== 'final-screen') {
                    el.classList.remove('visible');
                    el.classList.add('hidden');
                }
            });
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –≤–∏–¥–µ–æ
            if (tavernInsideVideo) tavernInsideVideo.pause();
            if (beerVideo) beerVideo.pause();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
            finalScreen.classList.remove('hidden');
            finalScreen.classList.add('visible');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const timePlayed = Math.floor(gameState.timeInTavern / 60);
            const drunkPercent = Math.min(100, gameState.drunkLevel);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≥—Ä–∞–¥—ã
            const rewards = finalScreen.querySelectorAll('.reward-item');
            if (rewards.length >= 4) {
                rewards[0].textContent = `‚úî –ü–æ—Å–µ—â–µ–Ω–æ –∫–æ–º–Ω–∞—Ç: ${gameState.visitedRooms.length}/5`;
                rewards[1].textContent = `‚úî –°–¥–µ–ª–∞–Ω–æ –≥–ª–æ—Ç–∫–æ–≤: ${gameState.clickCount}`;
                rewards[2].textContent = `‚úî –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –≤—Ä–µ–º–µ–Ω–∏: ${timePlayed} –º–∏–Ω`;
                rewards[3].textContent = `‚úî –£—Ä–æ–≤–µ–Ω—å —Ö–º–µ–ª—è: ${drunkPercent}%`;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≤–µ—Ä—à–∞—é—â–∏–µ –¥–∏–∞–ª–æ–≥–∏
            setTimeout(() => {
                const description = finalScreen.querySelector('.description-text');
                if (description) {
                    let dialogueIndex = 0;
                    const finalDialogues = dialogues.final_dialogues;
                    
                    function showNextFinalDialogue() {
                        if (dialogueIndex < finalDialogues.length) {
                            const dialogue = finalDialogues[dialogueIndex];
                            description.innerHTML = `<span style="color: #ffd700;">${dialogue.speaker}</span><br>${dialogue.text}`;
                            dialogueIndex++;
                            setTimeout(showNextFinalDialogue, 3000);
                        }
                    }
                    
                    showNextFinalDialogue();
                }
            }, 2000);
        }
        
        function restartGame() {
            console.log('–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ç–∞–≤–µ—Ä–Ω—ã');
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞
            if (gameState.isTyping) {
                clearInterval(gameState.typingInterval);
                gameState.isTyping = false;
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –º—É–∑—ã–∫—É
            backgroundMusic.currentTime = 0;
            
            finalScreen.classList.remove('visible');
            finalScreen.classList.add('hidden');
            mainMenu.classList.remove('hidden');
            mainMenu.classList.add('visible');
            
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
            gameState.timeInTavern = 0;
            gameState.drunkLevel = 0;
            gameState.clickCount = 0;
            gameState.beerLevel = 100;
            gameState.gameSpeed = 1.0;
            gameState.clickerCompleted = false;
            gameState.currentScene = 'main_menu';
            gameState.visitedRooms = [];
            gameState.currentVideo = 'tavern_inside';
            gameState.currentDialogueIndex = 0;
            gameState.currentDialogueSet = 'tavern_enter';
            gameState.clicksSinceLastEvent = 0;
            gameState.clicksForNextEvent = getRandomClicksForEvent();
            gameState.eventsTriggered = 0;
            gameState.eventActive = false;
            gameState.requiredClicks = 50;
            gameState.actionButtonsShown = false;
            gameState.isTyping = false;
            gameState.skipTyping = false;
            
            // –°–±—Ä–æ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            updateClickerDisplay();
            if (timer) timer.textContent = '[–í—Ä–µ–º—è: 0:00]';
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', init);
        
        // –î–æ–±–∞–≤–ª—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes pulse {
                0% { opacity: 1; }
                50% { opacity: 0.5; }
                100% { opacity: 1; }
            }
            
            @keyframes arrowPulse {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.5; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>