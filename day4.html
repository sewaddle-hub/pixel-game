<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ–Ω—å 4. –ü–æ–∏—Å–∫–∏ –∞–ª—Ç–∞—Ä—è</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        /* ===================== –°–ë–†–û–° –ò –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ===================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            color: #e8d8b6;
            font-family: 'Press Start 2P', cursive;
            line-height: 1.8;
            height: 100vh;
            padding: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            transition: background-image 0.5s ease;
        }

        /* ===================== –§–û–ù–û–í–´–ï –ö–õ–ê–°–°–´ –î–õ–Ø BODY ===================== */
        body.default-bg {
            background-image: url('img/Fon day 4 perviy.png');
            background-color: #2a1a0a;
        }

        body.shadow-world-bg {
            background-image: url('img/Fon mir Teny.png');
            background-color: #1a0a2a;
        }

        /* –¢–µ–º–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π –ø–æ–≤–µ—Ä—Ö —Ñ–æ–Ω–∞ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(20, 10, 0, 0.4);
            z-index: -1;
        }

        body.shadow-world-bg::before {
            background: rgba(30, 0, 50, 0.3);
        }

        /* ===================== –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ó–í–£–ö–û–ú ===================== */
        .audio-controls {
            position: fixed;
            top: 25px;
            right: 25px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(42, 32, 20, 0.8);
            padding: 15px 20px;
            border-radius: 12px;
            border: 4px solid #8b6b36;
        }

        .audio-btn {
            background: #8b6b36;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #ffd700;
            font-size: 24px;
            transition: all 0.3s;
        }

        .audio-btn:hover {
            background: #9b7b46;
            transform: scale(1.1);
        }

        .volume-slider {
            width: 120px;
            -webkit-appearance: none;
            height: 10px;
            background: #5a4a2a;
            border-radius: 5px;
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: #ffd700;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid #8b6b36;
        }

        /* ===================== –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† ===================== */
        .container {
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            overflow-y: auto;
            max-height: 100vh;
            padding: 15px 0;
        }

        /* ===================== –ó–ê–ì–û–õ–û–í–ö–ò ===================== */
        .title {
            background: rgba(139, 107, 54, 0.9);
            color: #ffd700;
            padding: 20px 40px;
            font-size: 22px;
            border: 8px solid #8b6b36;
            margin-bottom: 40px;
            display: inline-block;
            text-shadow: 3px 3px 0 #5a4a2a;
            position: relative;
            box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.5), 0 10px 20px rgba(0, 0, 0, 0.5);
            text-align: center;
            width: 100%;
            max-width: 900px;
        }

        .procrastinatus-title {
            background: rgba(147, 112, 219, 0.9);
            color: #e6d5ff;
            border: 8px solid #8A2BE2;
            text-shadow: 3px 3px 0 #4B0082;
            margin: 30px auto 40px auto;
            text-align: center;
            display: block;
            width: 100%;
            max-width: 900px;
        }

        /* ===================== –¢–ï–ö–°–¢–û–í–´–ï –ö–û–ù–¢–ï–ô–ù–ï–†–´ ===================== */
        .text-container {
            background: rgba(139, 107, 54, 0.85);
            border: 8px solid #8b6b36;
            padding: 35px 30px;
            box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.4), 0 12px 25px rgba(0, 0, 0, 0.5);
            text-align: center;
            font-size: 16px;
            position: relative;
            margin-bottom: 40px;
            color: #f5f0e6;
            text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.5);
            font-weight: normal;
            width: 100%;
            max-width: 900px;
        }

        /* ===================== –ö–ù–û–ü–ö–ò ===================== */
        .pixel-button {
            background: linear-gradient(to bottom, #cd7f32, #8b5a2b);
            color: #ffd700;
            border: none;
            padding: 20px 40px;
            font-family: 'Press Start 2P', cursive;
            font-size: 16px;
            cursor: pointer;
            border: 5px solid #5a3a2a;
            transition: all 0.2s;
            text-transform: uppercase;
            text-shadow: 2px 2px 0 #3a2a1a;
            position: relative;
            box-shadow: 0 8px 0 #3a2a1a, 0 15px 25px rgba(0, 0, 0, 0.4);
            margin: 15px 10px;
            text-align: center;
        }

        .pixel-button:hover {
            background: linear-gradient(to bottom, #d88f42, #9b6a3b);
            box-shadow: 0 10px 0 #3a2a1a, 0 20px 30px rgba(0, 0, 0, 0.5), 0 0 20px rgba(255, 215, 0, 0.3);
            transform: translateY(-3px);
        }

        /* ===================== –í–ò–î–ï–û –≠–ö–†–ê–ù ===================== */
        .video-screen {
            display: none;
        }

        .video-container {
            background: rgba(42, 32, 20, 0.8);
            border: 10px solid #8b6b36;
            padding: 15px;
            box-shadow: inset 0 0 35px rgba(0, 0, 0, 0.6), 0 10px 20px rgba(0, 0, 0, 0.5);
            position: relative;
            margin-bottom: 30px;
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: center;
        }

        .video-player {
            width: 100%;
            height: 350px;
            background-color: #1a100a;
            position: relative;
            overflow: hidden;
            border: 5px solid #5a4a2a;
            box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.8);
        }

        .video-player video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* ===================== –°–¢–û–†–ò –ö–û–ù–¢–ï–ô–ù–ï–† ===================== */
        .story-container {
            background: rgba(139, 107, 54, 0.85);
            border: 8px solid #8b6b36;
            padding: 25px;
            box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.4), 0 12px 25px rgba(0, 0, 0, 0.5);
            font-size: 15px;
            line-height: 1.8;
            color: #f5f0e6;
            text-align: left;
            position: relative;
            margin-bottom: 30px;
            min-height: 200px;
            text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 900px;
        }

        .story-scene {
            display: none;
        }

        .story-scene.active {
            display: block;
        }

        /* ===================== –ê–ù–ò–ú–ê–¶–ò–Ø –¢–ï–ö–°–¢–ê ===================== */
        .typing-text {
            display: inline-block;
            overflow: hidden;
            white-space: pre-wrap;
            border-right: 3px solid #ffd700;
            animation: blink-caret 0.75s step-end infinite;
        }

        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: #ffd700; }
        }

        /* ===================== –ö–ù–û–ü–ö–ê "–î–ê–õ–ï–ï" ===================== */
        .next-button-container {
            text-align: right;
            margin-top: 20px;
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: center;
        }

        /* ===================== –î–ò–ê–õ–û–ì–ò ===================== */
        .dialogue-container {
            margin: 20px 0;
            width: 100%;
            max-width: 900px;
        }

        .speaker-name {
            color: #8bc34a;
            font-size: 14px;
            margin-bottom: 10px;
            text-shadow: 0 0 12px rgba(139, 195, 74, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .dialogue-text {
            background: rgba(30, 20, 10, 0.7);
            border-left: 4px solid #8bc34a;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 14px;
            line-height: 1.6;
            border-radius: 0 8px 8px 0;
            text-align: left;
        }

        /* ===================== –û–ü–¶–ò–ò ===================== */
        .options-container {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }

        .option-button {
            background: rgba(70, 50, 30, 0.7);
            border: 3px solid #8b6b36;
            padding: 15px 20px;
            color: #e8d8b6;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s;
            border-radius: 8px;
            width: 100%;
        }

        .option-button:hover {
            background: rgba(139, 107, 54, 0.7);
            border-color: #ffd54f;
            transform: translateX(8px);
        }

        /* ===================== –í–û–ü–†–û–°–´ ===================== */
        .questions-container {
            margin-top: 20px;
            padding: 15px;
            background: rgba(42, 32, 20, 0.8);
            border: 4px solid #8b6b36;
            border-radius: 8px;
            width: 100%;
            max-width: 900px;
        }

        .question-item {
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(30, 20, 10, 0.5);
            border-left: 4px solid #ffd54f;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }

        .question-item:hover {
            background: rgba(139, 107, 54, 0.3);
            transform: translateX(8px);
        }

        /* ===================== –ö–ù–û–ü–ö–ê "–ù–ê–ó–ê–î" ===================== */
        .back-button {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(139, 107, 54, 0.7);
            border: 3px solid #8b6b36;
            color: #e8d8b6;
            padding: 10px 15px;
            font-family: 'Press Start 2P', cursive;
            font-size: 11px;
            cursor: pointer;
            border-radius: 8px;
            z-index: 10;
        }

        .back-button:hover {
            background: rgba(205, 127, 50, 0.7);
            border-color: #ffd54f;
        }

        /* ===================== –ú–ò–ù–ò-–ò–ì–†–ê –ê–ö–¢–ò–í–ê–¶–ò–ò –ê–õ–¢–ê–†–Ø ===================== */
        .mini-game-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9998;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
        }

        .mini-game-container.active {
            display: flex;
        }

        .mini-game-title {
            color: #ffd700;
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
            width: 100%;
            max-width: 800px;
        }

        .altar-game {
            background: rgba(42, 32, 20, 0.95);
            border: 10px solid #8b6b36;
            padding: 25px;
            border-radius: 12px;
            max-width: 800px;
            width: 100%;
            box-shadow: inset 0 0 35px rgba(0, 0, 0, 0.8), 0 0 45px rgba(139, 107, 54, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .instructions {
            color: #e8d8b6;
            font-size: 12px;
            text-align: center;
            margin-bottom: 20px;
            line-height: 1.6;
            padding: 12px;
            background: rgba(30, 20, 10, 0.5);
            border-radius: 8px;
            border: 2px solid #5a4a2a;
            width: 100%;
        }

        .voice-hint {
            color: #8bc34a;
            font-size: 11px;
            text-align: center;
            margin-bottom: 25px;
            padding: 12px;
            background: rgba(30, 20, 10, 0.7);
            border-radius: 8px;
            border-left: 4px solid #8bc34a;
            font-style: italic;
            line-height: 1.5;
            width: 100%;
        }

        .runes-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
            width: 100%;
        }

        .rune-item {
            background: rgba(30, 20, 10, 0.7);
            border: 4px solid #5a4a2a;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 110px;
        }

        .rune-item:hover {
            border-color: #ffd54f;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 213, 79, 0.2);
        }

        .rune-item.selected {
            border-color: #8bc34a;
            background: rgba(139, 195, 74, 0.15);
            box-shadow: 0 0 20px rgba(139, 195, 74, 0.4);
        }

        .sequence-container {
            background: rgba(20, 10, 0, 0.8);
            border: 5px solid #5a4a2a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            min-height: 110px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .sequence-slots {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            width: 100%;
        }

        .sequence-slot {
            width: 70px;
            height: 70px;
            background: rgba(42, 32, 20, 0.5);
            border: 3px dashed #8b6b36;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s;
        }

        .sequence-slot.filled {
            border: 4px solid #8bc34a;
            background: rgba(139, 195, 74, 0.1);
        }

        .game-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            width: 100%;
        }

        .hint-button {
            background: linear-gradient(to bottom, #4a6b8b, #2a4a6b);
            color: #a5d6ff;
            border: 4px solid #2a4a6b;
        }

        .reset-button {
            background: linear-gradient(to bottom, #8b4a4a, #6b2a2a);
            color: #ffa5a5;
            border: 4px solid #6b2a2a;
        }

        .activate-button {
            background: linear-gradient(to bottom, #4a8b4a, #2a6b2a);
            color: #a5ffa5;
            border: 4px solid #2a6b2a;
        }

        /* ===================== –†–ï–ó–£–õ–¨–¢–ê–¢ –ò–ì–†–´ ===================== */
        .game-result {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 25px;
            text-align: center;
            overflow-y: auto;
        }

        .game-result.active {
            display: flex;
        }

        .result-title {
            color: #ffd700;
            font-size: 28px;
            margin-bottom: 25px;
            text-shadow: 0 0 25px rgba(255, 215, 0, 0.7);
            width: 100%;
            max-width: 600px;
        }

        .result-text {
            color: #e8d8b6;
            font-size: 14px;
            line-height: 1.7;
            max-width: 600px;
            margin-bottom: 30px;
            padding: 0 15px;
        }

        .portal-animation {
            font-size: 60px;
            margin: 25px 0;
            animation: portal-spin 3s infinite linear;
        }

        @keyframes portal-spin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
            100% { transform: rotate(360deg) scale(1); }
        }

        /* ===================== –ü–ï–†–ï–•–û–î–ù–´–ï –≠–ö–†–ê–ù–´ ===================== */
        .shadow-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .shadow-transition.active {
            display: flex;
        }

        .transition-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* ===================== –ú–ò–† –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°–ê ===================== */
        .procrastinatus-world {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 99999;
            overflow-y: auto;
            max-height: 100vh;
            padding: 25px;
        }

        .procrastinatus-world.active {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        .procrastinatus-container {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100%;
        }

        .procrastinatus-scene {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            padding: 0;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            text-align: center;
        }

        .procrastinatus-scene.active {
            display: flex;
        }

        .procrastinatus-video-container {
            background: rgba(50, 0, 100, 0.8);
            border: 10px solid #9370DB;
            margin: 0 auto 35px auto;
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: center;
        }

        .procrastinatus-video-player {
            width: 100%;
            height: 350px;
            background-color: #1a001a;
            border: 5px solid #8A2BE2;
            overflow: hidden;
        }

        .procrastinatus-video-player video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* –ü–æ—à–∞–≥–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ */
        .dialogue-step {
            display: none;
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: rgba(50, 0, 100, 0.9);
            border: 8px solid #9370DB;
            border-radius: 12px;
            color: #e6d5ff;
            box-shadow: 0 0 25px rgba(147, 112, 219, 0.5);
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .dialogue-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dialogue-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            width: 100%;
            max-width: 800px;
        }

        .dialogue-next {
            background: linear-gradient(to bottom, #9370DB, #663399);
            color: #e6d5ff;
            border: 5px solid #8A2BE2;
            padding: 15px 35px;
            font-size: 16px;
            min-width: 180px;
        }

        .dialogue-next:hover {
            background: linear-gradient(to bottom, #a37beb, #7744aa);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.5);
        }

        /* –ú–µ—Ö–∞–Ω–∏–∫–∞ –ø–µ—Ç–ª–∏ –≤—Ä–µ–º–µ–Ω–∏ */
        .loop-mechanic {
            width: 100%;
            max-width: 800px;
            margin: 25px auto;
            padding: 25px;
            background: rgba(50, 0, 100, 0.8);
            border: 8px solid #9370DB;
            border-radius: 12px;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .loop-mechanic.active {
            display: block;
        }

        .stuck-message {
            color: #ff6b9d;
            font-size: 16px;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: rgba(50, 0, 50, 0.7);
            border-radius: 8px;
            border: 4px solid #ff6b9d;
            animation: pulse 1.5s infinite;
            font-family: 'Press Start 2P', cursive;
        }

        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        /* ===================== –ö–û–ú–ü–ê–ö–¢–ù–ê–Ø –ú–ò–ù–ò-–ò–ì–†–ê: –ü–ï–¢–õ–Ø –í–†–ï–ú–ï–ù–ò ===================== */
        .loop-status-compact {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin: 15px 0;
            padding: 12px;
            background: rgba(30, 0, 60, 0.7);
            border-radius: 10px;
            border: 4px solid #9370DB;
        }

        .loop-stat-item {
            flex: 1;
            text-align: center;
            padding: 8px;
        }

        .loop-stat-label {
            color: #c9a9ff;
            font-size: 10px;
            margin-bottom: 5px;
        }

        .loop-stat-value {
            color: #ffd54f;
            font-size: 18px;
            font-weight: bold;
        }

        /* –ö–û–ú–ü–ê–ö–¢–ù–ê–Ø –°–¶–ï–ù–ê */
        .loop-scene-compact {
            background: rgba(40, 0, 80, 0.8);
            border: 4px solid #9370DB;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .loop-scene-emoji {
            font-size: 40px;
            min-width: 50px;
            text-align: center;
        }

        .loop-scene-text {
            font-size: 13px;
            line-height: 1.5;
            flex: 1;
            color: #e6d5ff;
        }

        /* –ö–û–ú–ü–ê–ö–¢–ù–´–ï –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô */
        .loop-actions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 15px 0;
        }

        @media (max-width: 480px) {
            .loop-actions-grid {
                grid-template-columns: 1fr;
            }
        }

        .loop-action-btn {
            background: linear-gradient(135deg, #4B0082, #2d0050);
            color: #c9a9ff;
            border: 4px solid #8A2BE2;
            padding: 12px;
            font-size: 12px;
            text-align: left;
            cursor: pointer;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
            min-height: 65px;
            font-family: 'Press Start 2P', cursive;
        }

        .loop-action-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #5b1092, #3d1060);
            transform: translateY(-3px);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
        }

        .loop-action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .loop-action-emoji {
            font-size: 24px;
            min-width: 40px;
        }

        .loop-action-text {
            flex: 1;
        }

        .loop-action-title {
            color: #ffd54f;
            font-size: 11px;
            margin-bottom: 5px;
        }

        .loop-action-cost {
            color: #ff6b9d;
            font-size: 10px;
            margin-top: 5px;
        }

        /* –ö–û–ú–ü–ê–ö–¢–ù–ê–Ø –ü–ê–ù–ï–õ–¨ –Æ–ú–ò */
        .loop-yumi-compact {
            display: flex;
            gap: 15px;
            margin: 15px 0;
        }

        .loop-yumi-hint-box {
            flex: 3;
            background: rgba(80, 40, 120, 0.7);
            border-radius: 10px;
            padding: 12px;
            border-left: 4px solid #FFD700;
            min-height: 65px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .loop-yumi-hint-text {
            font-size: 11px;
            line-height: 1.4;
            color: #ffd54f;
            text-align: left;
        }

        .loop-yumi-controls {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
            justify-content: center;
        }

        .loop-yumi-btn {
            background: linear-gradient(135deg, #9370DB, #663399);
            color: #e6d5ff;
            border: 4px solid #8A2BE2;
            padding: 10px;
            font-size: 10px;
            height: 55px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-family: 'Press Start 2P', cursive;
        }

        .loop-yumi-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* –ö–û–ú–ü–ê–ö–¢–ù–´–ô –ü–†–û–ì–†–ï–°–° */
        .loop-progress-compact {
            margin: 15px 0;
        }

        .loop-progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 11px;
        }

        .loop-progress-label {
            color: #c9a18e;
        }

        .loop-progress-percent {
            color: #ffd54f;
        }

        .loop-progress-bar {
            height: 16px;
            background: rgba(50, 0, 100, 0.5);
            border-radius: 8px;
            overflow: hidden;
            border: 3px solid #8A2BE2;
        }

        .loop-progress-fill {
            height: 100%;
            background: linear-gradient(to right, #8A2BE2, #BA55D3);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 7px;
        }

        /* –ö–û–ú–ü–ê–ö–¢–ù–´–ô –õ–û–ì */
        .loop-log-compact {
            background: rgba(20, 0, 40, 0.9);
            border: 4px solid #9370DB;
            border-radius: 10px;
            padding: 12px;
            margin: 15px 0;
            height: 130px;
            overflow-y: auto;
        }

        .loop-log-header {
            color: #ba55d3;
            font-size: 11px;
            margin-bottom: 8px;
            text-align: left;
            border-bottom: 3px solid #9370DB;
            padding-bottom: 5px;
        }

        .loop-log-entry {
            font-size: 10px;
            line-height: 1.4;
            margin-bottom: 6px;
            padding: 5px;
            background: rgba(30, 0, 60, 0.5);
            border-radius: 5px;
            border-left: 4px solid #BA55D3;
            animation: fadeIn 0.3s ease;
            font-family: 'Press Start 2P', cursive;
        }

        .loop-log-yumi {
            border-left-color: #FFD700;
            background: rgba(80, 40, 0, 0.3);
        }

        .loop-log-action {
            border-left-color: #8bc34a;
        }

        /* –ö–ù–û–ü–ö–ê –í–´–•–û–î–ê */
        .loop-finish-btn {
            background: linear-gradient(135deg, #4B0082, #2d0050);
            color: #c9a9ff;
            border: 4px solid #8A2BE2;
            padding: 15px 25px;
            font-size: 13px;
            margin: 15px auto;
            display: none;
            width: 240px;
            font-family: 'Press Start 2P', cursive;
        }

        .loop-finish-btn.active {
            display: block;
        }

        /* ===================== –ú–ò–ù–ò-–ò–ì–†–ê: –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –°–¢–ê–ì–ù–ê–¶–ò–ò ===================== */
        .stagnation-game-container {
            background: rgba(50, 0, 100, 0.8);
            border: 5px solid #9370DB;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            width: 100%;
            max-width: 800px;
        }
        
        .stagnation-actions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 480px) {
            .stagnation-actions-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .stagnation-action-btn {
            background: linear-gradient(135deg, #2d0050, #1a0035);
            color: #c9a9ff;
            border: 4px solid #4B0082;
            padding: 15px;
            font-size: 12px;
            text-align: center;
            cursor: pointer;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            min-height: 100px;
            font-family: 'Press Start 2P', cursive;
        }
        
        .stagnation-action-btn:hover {
            background: linear-gradient(135deg, #3d1060, #2a0045);
            border-color: #8A2BE2;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(138, 43, 226, 0.3);
        }
        
        .stagnation-action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .stagnation-action-btn.selected {
            background: linear-gradient(135deg, #4B0082, #2d0050);
            border-color: #BA55D3;
            box-shadow: 0 0 20px rgba(186, 85, 211, 0.5);
        }
        
        .stagnation-action-emoji {
            font-size: 30px;
        }
        
        .stagnation-action-text {
            font-size: 11px;
            line-height: 1.4;
            color: #e6d5ff;
        }
        
        .stagnation-hint {
            color: #ffd54f;
            font-size: 11px;
            text-align: center;
            padding: 12px;
            background: rgba(80, 40, 0, 0.3);
            border-radius: 10px;
            border-left: 4px solid #FFD700;
            margin-top: 15px;
            font-style: italic;
        }
        
        /* ===================== –≠–ö–†–ê–ù –ó–ê–í–ï–†–®–ï–ù–ò–Ø –ì–õ–ê–í–´ ===================== */
        .chapter-complete-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 100000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 30px;
            text-align: center;
            animation: fadeIn 0.8s ease;
        }
        
        .chapter-complete-screen.active {
            display: flex;
        }
        
        .completion-container {
            background: linear-gradient(135deg, rgba(42, 32, 20, 0.95), rgba(30, 20, 10, 0.95));
            border: 12px solid #8b6b36;
            padding: 40px;
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            box-shadow: 
                inset 0 0 40px rgba(0, 0, 0, 0.7),
                0 0 60px rgba(139, 107, 54, 0.5),
                0 0 100px rgba(255, 215, 0, 0.3);
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .completion-title {
            color: #ffd700;
            font-size: 32px;
            margin-bottom: 20px;
            text-shadow: 
                0 0 15px #ffd700,
                0 0 30px #ffd700,
                0 0 45px #ffd700;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 15px #ffd700, 0 0 30px #ffd700, 0 0 45px #ffd700; }
            to { text-shadow: 0 0 20px #ffd700, 0 0 40px #ffd700, 0 0 60px #ffd700; }
        }
        
        .completion-subtitle {
            color: #8bc34a;
            font-size: 18px;
            margin-bottom: 25px;
            text-shadow: 0 0 10px rgba(139, 195, 74, 0.5);
        }
        
        .completion-message {
            color: #e8d8b6;
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(30, 20, 10, 0.5);
            border-radius: 12px;
            border: 3px solid #5a4a2a;
        }
        
        .completion-achievements {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .achievement-item {
            background: rgba(42, 32, 20, 0.8);
            border: 4px solid #8b6b36;
            padding: 15px;
            border-radius: 10px;
            min-width: 120px;
            transition: all 0.3s;
        }
        
        .achievement-item:hover {
            transform: scale(1.05);
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        .achievement-emoji {
            font-size: 30px;
            margin-bottom: 10px;
        }
        
        .achievement-text {
            font-size: 11px;
            color: #ffd54f;
        }
        
        .completion-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .completion-button {
            background: linear-gradient(135deg, #cd7f32, #8b5a2b);
            color: #ffd700;
            border: 5px solid #5a3a2a;
            padding: 20px 40px;
            font-size: 14px;
            min-width: 200px;
            text-transform: uppercase;
            text-shadow: 2px 2px 0 #3a2a1a;
            box-shadow: 0 8px 0 #3a2a1a, 0 15px 25px rgba(0, 0, 0, 0.4);
            transition: all 0.3s;
            font-family: 'Press Start 2P', cursive;
            text-decoration: none;
            display: inline-block;
        }
        
        .completion-button:hover {
            background: linear-gradient(135deg, #d88f42, #9b6a3b);
            transform: translateY(-5px);
            box-shadow: 0 12px 0 #3a2a1a, 0 20px 30px rgba(0, 0, 0, 0.5);
            color: #ffd700;
        }
        
        .completion-button.menu {
            background: linear-gradient(135deg, #4a8b4a, #2a6b2a);
            border-color: #2a6b2a;
        }
        
        .completion-button.restart {
            background: linear-gradient(135deg, #8b4a4a, #6b2a2a);
            border-color: #6b2a2a;
        }
        
        /* ===================== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ===================== */
        @media (max-width: 768px) {
            body { padding: 20px; }
            .title, .procrastinatus-title { 
                font-size: 18px; 
                padding: 15px 25px; 
                margin-bottom: 30px; 
                max-width: 800px;
            }
            .video-player, .procrastinatus-video-player { 
                height: 300px; 
            }
            .pixel-button { 
                padding: 15px 25px; 
                font-size: 14px; 
            }
            .runes-container { 
                grid-template-columns: repeat(2, 1fr); 
            }
            .text-container, .story-container {
                max-width: 800px;
            }
            .video-container, .procrastinatus-video-container {
                max-width: 800px;
            }
            .audio-controls {
                top: 15px;
                right: 15px;
                padding: 10px 15px;
            }
            .completion-container {
                padding: 25px;
            }
            .completion-title {
                font-size: 26px;
            }
            .completion-button {
                padding: 15px 25px;
                font-size: 12px;
                min-width: 160px;
            }
        }

        @media (max-width: 480px) {
            body { padding: 15px; }
            .title, .procrastinatus-title { 
                font-size: 16px; 
                padding: 12px 20px; 
                margin-bottom: 25px; 
                max-width: 100%;
            }
            .video-player, .procrastinatus-video-player { 
                height: 250px; 
            }
            .pixel-button { 
                padding: 12px 20px; 
                font-size: 12px; 
            }
            .runes-container { 
                grid-template-columns: 1fr; 
            }
            .text-container, .story-container {
                max-width: 100%;
                padding: 20px;
            }
            .video-container, .procrastinatus-video-container {
                max-width: 100%;
            }
            .mini-game-title {
                font-size: 20px;
            }
            .altar-game {
                padding: 20px;
            }
            .dialogue-step {
                padding: 15px;
            }
            .audio-controls {
                top: 10px;
                right: 10px;
                flex-direction: column;
                gap: 8px;
            }
            .volume-slider {
                width: 100px;
            }
            .completion-container {
                padding: 20px;
                margin: 15px;
            }
            .completion-title {
                font-size: 22px;
            }
            .completion-subtitle {
                font-size: 16px;
            }
            .completion-message {
                font-size: 14px;
                padding: 15px;
            }
            .completion-controls {
                flex-direction: column;
                align-items: center;
            }
            .completion-button {
                width: 100%;
                max-width: 250px;
            }
            .achievement-item {
                min-width: 100px;
                padding: 10px;
            }
        }
    </style>
</head>
<body class="default-bg">
    <!-- –ê–£–î–ò–û –ö–û–ù–¢–†–û–õ–õ–ï–† -->
    <div class="audio-controls" id="audioControls">
        <button class="audio-btn" id="audioToggle">üîä</button>
        <input type="range" min="0" max="100" value="50" class="volume-slider" id="volumeSlider">
    </div>

    <!-- –ê–£–î–ò–û –î–õ–Ø –§–û–ù–û–í–û–ô –ú–£–ó–´–ö–ò -->
    <audio id="backgroundMusic" loop>
        <source src="audio/Floating Thru Space (Ambient Music For Sleep) - Shining Moonlight [audiovk.com].mp3" type="audio/mpeg">
    </audio>

    <!-- –ü–ï–†–ï–•–û–î–ù–û–ï –í–ò–î–ï–û –¢–ï–õ–ï–ü–û–†–¢–ê–¶–ò–ò -->
    <div class="shadow-transition" id="shadowTransition">
        <video class="transition-video" id="transitionVideoPlayer" muted autoplay>
            <source src="video/Vnytri portala.mp4" type="video/mp4">
            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
        </video>
    </div>

    <!-- –≠–ö–†–ê–ù –ó–ê–í–ï–†–®–ï–ù–ò–Ø –ì–õ–ê–í–´ (–¢–û–õ–¨–ö–û –ï–°–õ–ò –í–´–ë–†–ê–ù –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô –í–ê–†–ò–ê–ù–¢) -->
    <div class="chapter-complete-screen" id="chapterCompleteScreen">
        <div class="completion-container">
            <div class="completion-title">‚ö†Ô∏è –í–´ –û–°–¢–ê–õ–ò–°–¨ –í –ú–ò–†–ï –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°–ê! ‚ö†Ô∏è</div>
            <div class="completion-subtitle">"–í—ã –≤—ã–±—Ä–∞–ª–∏ –æ–¥–∏–Ω –∏–∑ —Ç—Ä—ë—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤"</div>
            
            <div class="completion-message">
                –í—ã —Ä–µ—à–∏–ª–∏ –∑–∞–Ω—è—Ç—å—Å—è –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏ –¥–µ–ª–∞–º–∏ –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–¥—É–º–∞—Ç—å –æ –ø–æ–±–µ–≥–µ.<br>
                –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å –¥–æ–≤–æ–ª–µ–Ω - –≤—ã –æ—Å—Ç–∞–ª–∏—Å—å –≤ –µ–≥–æ –º–∏—Ä–µ –Ω–∞–≤—Å–µ–≥–¥–∞.<br><br>
                <em>"–ó–∞–≤—Ç—Ä–∞ –ø–æ–¥—É–º–∞–µ—à—å... –∏–ª–∏ –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞..."</em>
            </div>
            
            <div class="completion-achievements">
                <div class="achievement-item">
                    <div class="achievement-emoji">üíê</div>
                    <div class="achievement-text">–°–æ–±—Ä–∞–ª–∏ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ —Ü–≤–µ—Ç—ã</div>
                </div>
                <div class="achievement-item">
                    <div class="achievement-emoji">üñåÔ∏è</div>
                    <div class="achievement-text">–†–∏—Å–æ–≤–∞–ª–∏ –Ω–∞ –ø–µ—Å–∫–µ</div>
                </div>
                <div class="achievement-item">
                    <div class="achievement-emoji">üå≥</div>
                    <div class="achievement-text">–ì–æ–≤–æ—Ä–∏–ª–∏ —Å –¥–µ—Ä–µ–≤—å—è–º–∏</div>
                </div>
                <div class="achievement-item">
                    <div class="achievement-emoji">üò¥</div>
                    <div class="achievement-text">–ü–æ–ø–∞–ª–∏—Å—å –≤ –ª–æ–≤—É—à–∫—É</div>
                </div>
            </div>
            
            <div class="completion-controls">
                <a href="index1.html" class="pixel-button completion-button menu">
                    üè† –í –ú–ï–ù–Æ
                </a>
                <button class="pixel-button completion-button restart" id="restartChapterButton">
                    üîÑ –ü–û–ü–†–û–ë–û–í–ê–¢–¨ –°–ù–û–í–ê
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–ò–† –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°–ê -->
    <div class="procrastinatus-world" id="procrastinatusWorld">
        <div class="procrastinatus-container">
            <!-- –°–¶–ï–ù–ê 1: –í—Ö–æ–¥ –≤ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –º–∏—Ä -->
            <div class="procrastinatus-scene active" id="procrastinatusScene1">
                <div class="title procrastinatus-title">
                    –ú–ò–† –¢–ï–ù–ò: –§–∏–æ–ª–µ—Ç–æ–≤–∞—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å
                </div>
                
                <div class="procrastinatus-video-container">
                    <div class="procrastinatus-video-player" id="procrastinatusVideoPlayer1">
                        <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                            <source src="video/Mir Teny.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                        </video>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 1 -->
                <div class="dialogue-step active" id="firstDialogueStep">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–ì–¥–µ –º—ã? –í—Å—ë... —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–µ. –í–æ–∑–¥—É—Ö –≥—É—Å—Ç–æ–π, –∫–∞–∫ —Å–∏—Ä–æ–ø.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 2 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–ú–µ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ç—É, —á—Ç–æ –æ–ø–∏—Å–∞–Ω–∞ –≤ –ª–µ–≥–µ–Ω–¥–∞—Ö. –ó–¥–µ—Å—å —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫. –î–µ—Ä–µ–≤—å—è... –æ–Ω–∏ —Å—Ç—Ä–∞–Ω–Ω—ã–µ.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
            
            <!-- –°–¶–ï–ù–ê 2: –†—É–∫–∞ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞ -->
            <div class="procrastinatus-scene" id="procrastinatusScene2">
                <div class="title procrastinatus-title">
                    –®–Å–ü–û–¢ –í –¢–£–ú–ê–ù–ï
                </div>
                
                <div class="procrastinatus-video-container">
                    <div class="procrastinatus-video-player" id="procrastinatusVideoPlayer2">
                        <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                            <source src="video/Prokrastinator ryka.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                        </video>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 1 -->
                <div class="dialogue-step active">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–¢—É–º–∞–Ω —Å–≥—É—â–∞–µ—Ç—Å—è. –ò–∑-–∑–∞ –æ–¥–∏–Ω–æ–∫–æ–≥–æ –¥–µ—Ä–µ–≤–∞ —Å–ª—ã—à–µ–Ω —à—ë–ø–æ—Ç...</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 2 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–ö—Ç–æ –∑–¥–µ—Å—å?</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 3 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ì–û–õ–û–° (—ç—Ö–æ–º)</div>
                    <div class="dialogue-text">–ö—Ç–æ... –∑–¥–µ—Å—å...</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 4 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ì–û–õ–û–°</div>
                    <div class="dialogue-text">–¢—ã... –∏–¥—ë—à—å?</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 5 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–í —Ç—É–º–∞–Ω–µ –º–µ–ª—å–∫–∞—é—Ç: –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ä—É–∫–∞, –æ–±–≤–∏–≤–∞—é—â–∞—è —Å—Ç–≤–æ–ª... –î–≤–∞ –≥–ª–∞–∑–∞ –≤ —Ç—É–º–∞–Ω–µ... –ö–æ–Ω—Ç—É—Ä –≤—ã—Å–æ–∫–æ–≥–æ —Å—É—Ç—É–ª–æ–≥–æ —Å–∏–ª—É—ç—Ç–∞...</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
            
            <!-- –°–¶–ï–ù–ê 3: –ü–æ–ª–æ–≤–∏–Ω–∞ —Ç–µ–ª–∞ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞ -->
            <div class="procrastinatus-scene" id="procrastinatusScene3">
                <div class="title procrastinatus-title">
                    –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°
                </div>
                
                <div class="procrastinatus-video-container">
                    <div class="procrastinatus-video-player" id="procrastinatusVideoPlayer3">
                        <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                            <source src="video/Prokrastinator polovina tela.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                        </video>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 1 -->
                <div class="dialogue-step active">
                    <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°</div>
                    <div class="dialogue-text">–Ø... –∂–¥–∞–ª. <span style="opacity: 0.7">(–ø–∞—É–∑–∞)</span><br>–í—Å–µ –∂–¥—É—Ç. –ñ–¥—É—Ç —Ä–µ—à–µ–Ω–∏—è.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 2 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°</div>
                    <div class="dialogue-text">–ê —Ä–µ—à–µ–Ω–∏–µ... –∂–¥—ë—Ç —Ç–µ–±—è.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 3 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–ß—Ç–æ —Ç—ã —Ç–∞–∫–æ–µ?</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 4 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°</div>
                    <div class="dialogue-text">–Ø... —Ç–æ, –º–µ–∂–¥—É. –ú–µ–∂–¥—É "—Å–¥–µ–ª–∞—Ç—å" –∏ "–Ω–µ —Å–¥–µ–ª–∞—Ç—å". –ú–µ–∂–¥—É "–∏–¥—Ç–∏" –∏ "—Å—Ç–æ—è—Ç—å".</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 5 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°</div>
                    <div class="dialogue-text">–ú–µ–∂–¥—É "–Ω–∞—á–∞—Ç—å" –∏ "–æ—Ç–ª–æ–∂–∏—Ç—å".</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 6 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–Æ–º–∏</div>
                    <div class="dialogue-text">*—à–µ–ø–æ—Ç–æ–º* –°—É—â–µ—Å—Ç–≤–æ –º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Ç—É–º–∞–Ω–∞, –Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é. –ü–æ–ª–æ–≤–∏–Ω–∞ —Ç–µ–ª–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –¥—ã–º–∫–µ.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 7 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–Æ–º–∏</div>
                    <div class="dialogue-text">–ü–µ—Ä–≤–æ–µ —á—ë—Ç–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äî –Ω–æ —Ç–æ–ª—å–∫–æ –≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å, –Ω–æ–≥–∏ –≤ —Ç—É–º–∞–Ω–µ.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
            </div>
            
            <!-- –°–¶–ï–ù–ê 4: –ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –¥–æ—Ä–æ–≥–∞ -->
            <div class="procrastinatus-scene" id="procrastinatusScene4">
                <div class="title procrastinatus-title">
                    –ë–ï–°–ö–û–ù–ï–ß–ù–û–°–¢–¨
                </div>
                
                <div class="procrastinatus-video-container">
                    <div class="procrastinatus-video-player" id="procrastinatusVideoPlayer4">
                        <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                            <source src="video/Mir Teny1.1.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                        </video>
                    </div>
                </div>
                
                <!-- –î–ò–ê–õ–û–ì–ò -->
                <!-- –®–∞–≥ 1 -->
                <div class="dialogue-step active">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–û–Ω –∏—Å—á–µ–∑... –ü–æ—à–ª–∏, –Æ–º–∏. –ù–∞–¥–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥ –∏–∑ —ç—Ç–æ–≥–æ –º–µ—Å—Ç–∞.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 2 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–Æ–º–∏</div>
                    <div class="dialogue-text">*–∫–∏–≤–∞–µ—Ç* –î–∞–≤–∞–π —Å–∫–æ—Ä–µ–µ —É–π–¥—ë–º –æ—Ç—Å—é–¥–∞. –≠—Ç–æ—Ç —Ç—É–º–∞–Ω... –æ–Ω –∫–∞–∂–µ—Ç—Å—è –∂–∏–≤—ã–º.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 3 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–°—Ç–æ–ø... –¢—ã –∑–∞–º–µ—Ç–∏–ª? –≠—Ç–æ –¥–µ—Ä–µ–≤–æ... –ú—ã —É–∂–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –∑–¥–µ—Å—å.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 4 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ù–∏–∫</div>
                    <div class="dialogue-text">–¢–æ —Å–∞–º–æ–µ –¥–µ—Ä–µ–≤–æ —Å –æ–±–≤–∏—Ç–æ–π —Ä—É–∫–æ–π.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 5 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–Æ–º–∏</div>
                    <div class="dialogue-text">*–∏—Å–ø—É–≥–∞–Ω–Ω–æ –ø–∏—â–∏—Ç* –ò –≤–æ–Ω —Ç–æ—Ç –∫–∞–º–µ–Ω—å... –∏ —Ç–æ—Ç –∫—É—Å—Ç...</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 6 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–Æ–º–∏</div>
                    <div class="dialogue-text">–í—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ! –ú—ã –∏–¥—ë–º –ø–æ –∫—Ä—É–≥—É!</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 7 -->
                <div class="dialogue-step">
                    <div class="speaker-name">–ì–û–õ–û–° (—ç—Ö–æ–º)</div>
                    <div class="dialogue-text">–í–°–Å –ü–û–í–¢–û–†–Ø–ï–¢–°–Ø. –¢–´ –í –õ–û–í–£–®–ö–ï –í–†–ï–ú–ï–ù–ò.</div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–ù–∞—á–∞—Ç—å –ø–æ–ø—ã—Ç–∫–∏</button>
                    </div>
                </div>
                
                <!-- ========= –ö–û–ú–ü–ê–ö–¢–ù–ê–Ø –ú–ò–ù–ò-–ò–ì–†–ê: –ü–ï–¢–õ–Ø –í–†–ï–ú–ï–ù–ò ========= -->
                <div class="loop-mechanic" id="loopMechanic">
                    <div class="stuck-message" style="font-size: 12px; padding: 10px; margin: 0 0 15px 0;">
                        ‚è≥ –ú–´ –í –õ–û–í–£–®–ö–ï –í–†–ï–ú–ï–ù–ò! –í—ã–±–∏—Ä–∞–π –¥–µ–π—Å—Ç–≤–∏—è, —á—Ç–æ–±—ã –≤—ã—Ä–≤–∞—Ç—å—Å—è.
                    </div>
                    
                    <!-- –ö–û–ú–ü–ê–ö–¢–ù–´–ô –°–¢–ê–¢–£–°-–ë–ê–† -->
                    <div class="loop-status-compact">
                        <div class="loop-stat-item">
                            <div class="loop-stat-label">–ü–û–ü–´–¢–ö–ê</div>
                            <div class="loop-stat-value" id="loopAttemptCount">1</div>
                        </div>
                        <div class="loop-stat-item">
                            <div class="loop-stat-label">–≠–ù–ï–†–ì–ò–Ø</div>
                            <div class="loop-stat-value" id="loopEnergyCount">10</div>
                        </div>
                        <div class="loop-stat-item">
                            <div class="loop-stat-label">–ü–û–î–°–ö–ê–ó–ö–ò</div>
                            <div class="loop-stat-value" id="loopHintCount">3</div>
                        </div>
                    </div>
                    
                    <!-- –ü–†–û–ì–†–ï–°–° -->
                    <div class="loop-progress-compact">
                        <div class="loop-progress-header">
                            <span class="loop-progress-label">–ü–†–û–ì–†–ï–°–° –í–´–•–û–î–ê</span>
                            <span class="loop-progress-percent" id="loopProgressPercent">0%</span>
                        </div>
                        <div class="loop-progress-bar">
                            <div class="loop-progress-fill" id="loopProgressFill"></div>
                        </div>
                    </div>
                    
                    <!-- –°–¶–ï–ù–ê -->
                    <div class="loop-scene-compact">
                        <div class="loop-scene-emoji" id="loopSceneEmoji">üîÑ</div>
                        <div class="loop-scene-text" id="loopSceneText">
                            ‚è≥ –í—ã –∑–∞—Å—Ç—Ä—è–ª–∏ –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø–µ—Ç–ª–µ –≤—Ä–µ–º–µ–Ω–∏. –í–æ–∫—Ä—É–≥ —Ç—É–º–∞–Ω, –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –¥–µ—Ä–µ–≤—å—è...
                        </div>
                    </div>
                    
                    <!-- –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô -->
                    <div class="loop-actions-grid" id="loopActionsContainer">
                        <!-- –î–æ–±–∞–≤—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                    
                    <!-- –ü–ê–ù–ï–õ–¨ –Æ–ú–ò -->
                    <div class="loop-yumi-compact">
                        <div class="loop-yumi-hint-box">
                            <div class="loop-yumi-hint-text" id="loopCurrentHint">
                                üê≠ "–Ø –∑–∞–º–µ—Ç–∏–ª–∞: –¥–µ—Ä–µ–≤–æ —Å —Ä—É–∫–æ–π –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ —Ç—Ä–∏ –∫—Ä—É–≥–∞!"
                            </div>
                        </div>
                        <div class="loop-yumi-controls">
                            <button class="pixel-button loop-yumi-btn" id="loopGetHintBtn" title="1 —ç–Ω–µ—Ä–≥–∏—è">
                                üí≠<br>–ü–æ–¥—Å–∫–∞–∑–∫–∞
                            </button>
                            <button class="pixel-button loop-yumi-btn" id="loopAnalyzeBtn">
                                üîç<br>–ê–Ω–∞–ª–∏–∑
                            </button>
                        </div>
                    </div>
                    
                    <!-- –õ–û–ì -->
                    <div class="loop-log-compact">
                        <div class="loop-log-header">üìù –°–û–ë–´–¢–ò–Ø:</div>
                        <div class="loop-log-entries" id="loopGameLog">
                            <div class="loop-log-entry">üåü –ú—ã –ø–æ–ø–∞–ª–∏ –≤ –ø–µ—Ç–ª—é –≤—Ä–µ–º–µ–Ω–∏...</div>
                            <div class="loop-log-entry loop-log-yumi">üê≠ –Æ–º–∏: "–ù–∏–∫, –≤—Å—ë –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è!"</div>
                        </div>
                    </div>
                    
                    <!-- –ö–ù–û–ü–ö–ê –í–´–•–û–î–ê -->
                    <div style="text-align: center;">
                        <button class="pixel-button loop-finish-btn" id="loopFinishBtn">
                            üö™ –í–´–ô–¢–ò –ò–ó –ü–ï–¢–õ–ò
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- –°–¶–ï–ù–ê 5: –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π (–ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏—è) -->
            <div class="procrastinatus-scene" id="procrastinatusScene5">
                <div class="title procrastinatus-title">–í–´–ë–û–† –ë–ï–ó –í–´–ë–û–†–ê</div>
                
                <div class="procrastinatus-video-container">
                    <div class="procrastinatus-video-player" id="procrastinatusVideoPlayer5">
                        <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                            <source src="video/Prokrastinatys vibor.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                        </video>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 1: –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç "–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" -->
                <div class="dialogue-step active">
                    <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°</div>
                    <div class="dialogue-text">
                        –Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é... –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.<br>
                        <em style="color:#ba55d3; font-size:12px;">(–æ–¥–Ω–∞ —Ä—É–∫–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –¥–æ—Ä–æ–≥—É)</em><br><br>
                        –ù–∏ —à–∞–≥—É –≤–ø–µ—Ä—ë–¥ ‚Äî –Ω–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫.<br>
                        –ù–∏ –æ–¥–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ ‚Äî –Ω–∏–∫–∞–∫–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.<br>
                        <em style="color:#ba55d3; font-size:12px;">(–¥—Ä—É–≥–∞—è —Ä—É–∫–∞ —Ä–∞–∑–≤–æ–¥–∏—Ç —Ç—É–º–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞—è 4 –ø—É—Ç–∏)</em><br><br>
                        –ê –µ—Å–ª–∏ –≤—ã–±–µ—Ä–µ—à—å... –∫—Ç–æ –∑–Ω–∞–µ—Ç, —á—Ç–æ —Ç–∞–º?
                    </div>
                    <div class="dialogue-controls" style="margin-top: 25px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 2: –í—ã–±–æ—Ä 4 –¥–µ–π—Å—Ç–≤–∏–π (–ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏—è) -->
                <div class="dialogue-step" id="choiceGameStep">
                    <div class="stuck-message" style="font-size: 12px; padding: 10px; margin: 0 0 20px 0;">
                        ‚ö†Ô∏è –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–° –ü–†–ï–î–õ–ê–ì–ê–ï–¢ –í–ê–ú –ó–ê–ù–Ø–¢–¨–°–Ø –ë–ï–°–°–ú–´–°–õ–ï–ù–ù–´–ú–ò –î–ï–õ–ê–ú–ò
                    </div>
                    
                    <div style="color:#e6d5ff; font-size: 13px; text-align: center; margin-bottom: 20px;">
                        –õ—é–±–æ–π –∏–∑ –ø–µ—Ä–≤—ã—Ö —Ç—Ä—ë—Ö –≤—ã–±–æ—Ä–æ–≤ –æ—Å—Ç–∞–≤–∏—Ç –≤–∞—Å –≤ —ç—Ç–æ–º –º–∏—Ä–µ, –∞ –≤—ã–±–æ—Ä "–ü–û–î–£–ú–ê–¢–¨" –≤—ã–≤–µ–¥–µ—Ç –≤–∞—Å!
                    </div>
                    
                    <div class="stagnation-game-container" id="procrastinationChoiceGame">
                        <div class="stagnation-actions-grid" id="procrastinationActions">
                            <!-- –ö–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                        </div>
                        
                        <div class="stagnation-hint" id="procrastinationHint">
                            üê≠ –Æ–º–∏: *—à–µ–ø—á–µ—Ç* "–ù–∏–∫, –æ–Ω —Ö–æ—á–µ—Ç —á—Ç–æ–±—ã –º—ã –±–µ–∑–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª–∏! –í—ã–±–µ—Ä–∏ '–ü–û–î–£–ú–ê–¢–¨' —á—Ç–æ–±—ã —Å–±–µ–∂–∞—Ç—å!"
                        </div>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 3: –†–µ–∞–∫—Ü–∏—è –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω—É—Å–∞ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω 4-–π –≤–∞—Ä–∏–∞–Ω—Ç) -->
                <div class="dialogue-step" id="panicReactionStep">
                    <div class="procrastinatus-video-container">
                        <div class="procrastinatus-video-player" id="raspadVideoPlayer">
                            <video muted playsinline style="width:100%; height:100%; object-fit:cover;">
                                <source src="video/Raspad.mp4" type="video/mp4">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                            </video>
                        </div>
                    </div>
                    
                    <div class="dialogue-container">
                        <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°</div>
                        <div class="dialogue-text">
                            –ù–ï–¢! –¢–´ –î–£–ú–ê–ï–®–¨?!<br>
                            –î–£–ú–ê–¢–¨ –û–ü–ê–°–ù–û! –î–£–ú–ê–¢–¨ ‚Äî –≠–¢–û –í–´–ë–ò–†–ê–¢–¨!<br>
                            <em style="color:#ff6b9d;">(–µ–≥–æ —Ñ–æ—Ä–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞—Å–ø–∞–¥–∞—Ç—å—Å—è)</em>
                        </div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 25px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 4: –§–∏–Ω–∞–ª—å–Ω—ã–π –¥–∏–∞–ª–æ–≥ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω—É—Å–∞ -->
                <div class="dialogue-step" id="finalDialogueStep">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–° (—Ä–∞—Å—Å—ã–ø–∞—è—Å—å)</div>
                        <div class="dialogue-text">–¢—ã... –≤—ã–±—Ä–∞–ª –¥—É–º–∞—Ç—å.<br>
                            <span style="opacity: 0.8;">(–≥–æ–ª–æ—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–∏—à–µ)</span><br>
                            –ü–æ–º–Ω–∏... —è –≤—Å–µ–≥–¥–∞ –∑–¥–µ—Å—å.<br>
                            –í –∫–∞–∂–¥–æ–º "–º–æ–∂–µ—Ç –±—ã—Ç—å". –í –∫–∞–∂–¥–æ–º "–ø–æ—Ç–æ–º".<br>
                            <span style="opacity: 0.6; font-size: 12px;">(–ø–æ—Å–ª–µ–¥–Ω–∏–π —à—ë–ø–æ—Ç)</span><br>
                            –ü—Ä–æ—Å—Ç–æ... –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è.
                        </div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 25px;">
                        <button class="pixel-button dialogue-next">
                            üö∂‚Äç‚ôÇÔ∏è –í–´–ô–¢–ò –ò–ó –ú–ò–†–ê –¢–ï–ù–ò
                        </button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 5: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω 1-3 –≤–∞—Ä–∏–∞–Ω—Ç) -->
                <div class="dialogue-step" id="wrongChoiceStep">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–° (–¥–æ–≤–æ–ª—å–Ω—ã–π)</div>
                        <div class="dialogue-text">
                            –•–æ—Ä–æ—à–æ... –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ...<br>
                            –û—Ç–¥–æ—Ö–Ω–∏... –ø–æ–¥–æ–∂–¥–∏...<br>
                            <em style="color:#ba55d3;">(—Ç—É–º–∞–Ω —Å–≥—É—â–∞–µ—Ç—Å—è)</em><br>
                            –ó–∞–≤—Ç—Ä–∞ –ø–æ–¥—É–º–∞–µ—à—å... –∏–ª–∏ –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞...
                        </div>
                    </div>
                    
                    <div class="stuck-message" style="font-size: 12px; padding: 10px; margin: 20px 0;">
                        ‚ö†Ô∏è –í–´ –û–°–¢–ê–õ–ò–°–¨ –í –ú–ò–†–ï –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°–ê!
                    </div>
                    
                    <div class="dialogue-controls" style="margin-top: 25px;">
                        <button class="pixel-button dialogue-next" id="tryAgainButton">
                            üîÑ –ü–û–ü–†–û–ë–û–í–ê–¢–¨ –°–ù–û–í–ê
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- –°–¶–ï–ù–ê 6: –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ü–µ–Ω–∞ —Å –ª–∞–≥–µ—Ä–µ–º (–¢–û–õ–¨–ö–û –ï–°–õ–ò –í–´–ë–†–ê–ù –ü–†–ê–í–ò–õ–¨–ù–´–ô –í–ê–†–ò–ê–ù–¢ 4) -->
            <div class="procrastinatus-scene" id="procrastinatusScene6">
                <div class="title procrastinatus-title">–û–¢–î–´–• –í –õ–ê–ì–ï–†–ï</div>
                
                <div class="procrastinatus-video-container">
                    <div class="procrastinatus-video-player" id="lagerVideoPlayer">
                        <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                            <source src="video/Lager.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                        </video>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 1 -->
                <div class="dialogue-step active" id="campStep1">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–∏–∫</div>
                        <div class="dialogue-text">–¢—É–º–∞–Ω —Ä–∞—Å—Å–µ–∏–≤–∞–µ—Ç—Å—è. –î–æ—Ä–æ–≥–∞ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –∫–æ–Ω–µ—Ü.</div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 2 -->
                <div class="dialogue-step" id="campStep2">
                    <div class="text-container" style="margin: 15px 0; background: rgba(50, 0, 100, 0.8); border-color: #9370DB;">
                        "–ù–∏–∫ —á—É–≤—Å—Ç–≤—É–µ—Ç –Ω–µ–æ–±—ã—á–Ω—É—é –ª—ë–≥–∫–æ—Å—Ç—å. –¢–µ–ø–µ—Ä—å –æ–Ω –≤–∏–¥–∏—Ç ‚Äî –≤ —Ä–µ–∞–ª—å–Ω–æ–º –º–∏—Ä–µ —Ç–æ–∂–µ –µ—Å—Ç—å '–º–µ–∂–¥—É'. –ú–æ–º–µ–Ω—Ç—ã, –∫–æ–≥–¥–∞ —Ä–µ—à–µ–Ω–∏–µ –≤–∏—Å–∏—Ç –≤ –≤–æ–∑–¥—É—Ö–µ. –ò –æ–Ω –ø–æ–Ω–∏–º–∞–µ—Ç: —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∏–∑ '–º–µ–∂–¥—É', –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ... –≤—ã–±—Ä–∞—Ç—å."
                    </div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 3 -->
                <div class="dialogue-step" id="campStep3">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–∏–∫</div>
                        <div class="dialogue-text">–°–º–æ—Ç—Ä–∏, –Æ–º–∏ ‚Äî –∑–∞–±—Ä–æ—à–µ–Ω–Ω—ã–π –ª–∞–≥–µ—Ä—å. –ú–æ–∂–µ—Ç, –æ—Ç–¥–æ—Ö–Ω—ë–º –∑–¥–µ—Å—å?</div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 4 -->
                <div class="dialogue-step" id="campStep4">
                    <div class="dialogue-container">
                        <div class="speaker-name">–Æ–º–∏</div>
                        <div class="dialogue-text">*—Ä–∞–¥–æ—Å—Ç–Ω–æ –ø–∏—â–∏—Ç* –î–∞, –ù–∏–∫! –Ø —Ç–∞–∫ —É—Å—Ç–∞–ª–∞ –æ—Ç —ç—Ç–∏—Ö –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –¥–æ—Ä–æ–≥...</div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 5 -->
                <div class="dialogue-step" id="campStep5">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–∏–∫</div>
                        <div class="dialogue-text">–û—Ç–ª–∏—á–Ω–æ. –ü–µ—Ä–µ–Ω–æ—á—É–µ–º –∑–¥–µ—Å—å, –∞ –∑–∞–≤—Ç—Ä–∞... –∑–∞–≤—Ç—Ä–∞ –æ—Ç–ø—Ä–∞–≤–∏–º—Å—è –∫ –¢–µ–Ω–∏. –ù–æ —Ç–µ–ø–µ—Ä—å —è –∑–Ω–∞—é, –∫–∞–∫ —Å –Ω–µ–π —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è.</div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 6 -->
                <div class="dialogue-step" id="campStep6">
                    <div class="dialogue-container">
                        <div class="speaker-name">–Æ–º–∏</div>
                        <div class="dialogue-text">–¢—ã —Å—Ç–∞–ª –¥—Ä—É–≥–∏–º, –ù–∏–∫. –ë–æ–ª–µ–µ... —Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–º.</div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 15px;">
                        <button class="pixel-button dialogue-next">–î–∞–ª–µ–µ</button>
                    </div>
                </div>
                
                <!-- –®–∞–≥ 7 -->
                <div class="dialogue-step" id="campStep7">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–∏–∫</div>
                        <div class="dialogue-text">–ü—Ä–æ—Å—Ç–æ –ø–æ–Ω—è–ª, —á—Ç–æ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫—É, —á–µ–º –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –≤–µ—á–Ω–æ–º "–º–µ–∂–¥—É". –î–∞–≤–∞–π —Ä–∞–∑–≤–µ–¥—ë–º –∫–æ—Å—Ç—ë—Ä.</div>
                    </div>
                    <div class="dialogue-controls" style="margin-top: 25px;">
                        <button class="pixel-button dialogue-next" id="finalCampButton">
                            üèïÔ∏è –ó–ê–ö–û–ù–ß–ò–¢–¨ –ì–õ–ê–í–£
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–ò–ù–ò-–ò–ì–†–ê –ê–ö–¢–ò–í–ê–¶–ò–ò –ê–õ–¢–ê–†–Ø -->
    <div class="mini-game-container" id="miniGame">
        <div class="mini-game-title">‚ö° –ê–ö–¢–ò–í–ê–¶–ò–Ø –î–†–ï–í–ù–ï–ì–û –ê–õ–¢–ê–†–Ø ‚ö°</div>
        
        <div class="altar-game">
            <div class="instructions">
                <strong>–ó–ê–î–ê–ù–ò–ï:</strong> –í—Å–ø–æ–º–Ω–∏ —Å–ª–æ–≤–∞ –ì–æ–ª–æ—Å–∞ –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–∏ —Ä—É–Ω—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.<br>
                <span style="color:#ff6b6b">–í—Ä–µ–º—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ!</span> –í—ã–±–µ—Ä–∏ 4 –∏–∑ 6 —Ä—É–Ω.
            </div>
            
            <div class="voice-hint" id="voiceHint">
                "–®–µ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤ –≤–∏–¥–Ω—ã –≥–ª–∞–∑—É, –Ω–æ –ª–∏—à—å —á–µ—Ç—ã—Ä–µ –æ—Ç–∫—Ä–æ—é—Ç –ø—É—Ç—å. –û–≥–æ–Ω—å, –∫–æ—Ç–æ—Ä—ã–π –¥–∞—Ä–∏—Ç –∂–∏–∑–Ω—å... –í–æ–¥–∞, —á—Ç–æ –Ω–µ—Å—ë—Ç... –í–æ–∑–¥—É—Ö, —á—Ç–æ —à–µ–ø—á–µ—Ç... –°–≤–µ—Ç, —á—Ç–æ –æ–∑–∞—Ä—è–µ—Ç..."
            </div>
            
            <div class="sequence-container">
                <div class="sequence-title">–ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –ê–ö–¢–ò–í–ê–¶–ò–ò (4 —Å–ª–æ—Ç–∞)</div>
                <div class="sequence-slots" id="sequenceSlots">
                    <div class="sequence-slot" data-slot="1">?</div>
                    <div class="sequence-slot" data-slot="2">?</div>
                    <div class="sequence-slot" data-slot="3">?</div>
                    <div class="sequence-slot" data-slot="4">?</div>
                </div>
            </div>
            
            <div class="runes-container" id="runesContainer">
                <!-- –†—É–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <div class="game-controls">
                <button class="pixel-button hint-button" id="hintButton">üí≠ –ü–æ–¥—Å–∫–∞–∑–∫–∞ (3 –æ—Å—Ç–∞–ª–æ—Å—å)</button>
                <button class="pixel-button reset-button" id="resetButton">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                <button class="pixel-button activate-button" id="activateButton">‚ö° –ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ ‚ö°</button>
            </div>
        </div>
    </div>
    
    <!-- –≠–ö–†–ê–ù –†–ï–ó–£–õ–¨–¢–ê–¢–ê –ê–õ–¢–ê–†–Ø -->
    <div class="game-result" id="gameResult">
        <div class="portal-animation">üåÄ</div>
        <div class="result-title" id="resultTitle">–ê–õ–¢–ê–†–¨ –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!</div>
        <div class="result-text" id="resultText">–ü–æ—Ä—Ç–∞–ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è... –î—Ä–µ–≤–Ω–∏–µ —Å–∏–ª—ã –ø—Ä–æ–±—É–∂–¥–∞—é—Ç—Å—è. –®–∞–≥–Ω–∏ –≤–Ω—É—Ç—Ä—å, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å.</div>
        <button class="pixel-button" id="enterPortal">–®–ê–ì–ù–£–¢–¨ –í –ü–û–†–¢–ê–õ</button>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† –ò–ì–†–´ -->
    <div class="container">
        <!-- –ü–ï–†–í–´–ô –≠–ö–†–ê–ù -->
        <div id="startScreen">
            <div class="title">–î–µ–Ω—å 4. –ü–æ–∏—Å–∫–∏ –∞–ª—Ç–∞—Ä—è</div>
            
            <div class="text-container">
                –ù–∏–∫ –∏ –º—ã—à–∫–∞ –Æ–º–∏ –ø–æ–ª—É—á–∏–ª–∏ –¥—Ä–µ–≤–Ω—é—é –∫–∞—Ä—Ç—É, —É–∫–∞–∑—ã–≤–∞—é—â—É—é –Ω–∞ –º–µ—Å—Ç–æ–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ —Å—Ç–∞—Ä–∏–Ω–Ω–æ–≥–æ –∞–ª—Ç–∞—Ä—è, –æ–±–ª–∞–¥–∞—é—â–µ–≥–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–π —Å–∏–ª–æ–π. –õ–µ–≥–µ–Ω–¥—ã –≥–ª–∞—Å—è—Ç, —á—Ç–æ —Ç–æ—Ç, –∫—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∞–ª—Ç–∞—Ä—å —Å–º–æ–∂–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –≤ –¥—Ä—É–≥–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.
            </div>
            
            <button class="pixel-button" id="searchButton">–í—ã–¥–≤–∏–Ω—É—Ç—å—Å—è –Ω–∞ –ø–æ–∏—Å–∫–∏</button>
        </div>
        
        <!-- –í–¢–û–†–û–ô –≠–ö–†–ê–ù —Å –≤–∏–¥–µ–æ –∏ —Ç–µ–∫—Å—Ç–æ–º -->
        <div class="video-screen" id="videoScreen">
            <div class="video-container">
                <div class="video-player" id="videoPlayer">
                    <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                        <source src="video/Idyt po snegy.mp4" type="video/mp4">
                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                    </video>
                </div>
            </div>
            
            <div class="story-container">
                <!-- –°–¶–ï–ù–´ 1-7: –ü–æ–∏—Å–∫–∏ –∞–ª—Ç–∞—Ä—è -->
                <div class="story-scene active" id="scene1">
                    <span class="typing-text" id="typing1"></span>
                </div>
                
                <div class="story-scene" id="scene2">
                    <span class="typing-text" id="typing2"></span>
                </div>
                
                <div class="story-scene" id="scene3">
                    <span class="typing-text" id="typing3"></span>
                </div>
                
                <div class="story-scene" id="scene4">
                    <span class="typing-text" id="typing4"></span>
                </div>
                
                <div class="story-scene" id="scene5">
                    <span class="typing-text" id="typing5"></span>
                </div>
                
                <div class="story-scene" id="scene6">
                    <span class="typing-text" id="typing6"></span>
                </div>
                
                <div class="story-scene" id="scene7">
                    <span class="typing-text" id="typing7"></span>
                </div>
                
                <!-- –°—Ü–µ–Ω–∞ 8: –ü–µ—Ä–≤–∞—è —Ä–µ–ø–ª–∏–∫–∞ –≥–æ–ª–æ—Å–∞ -->
                <div class="story-scene" id="scene8">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–µ–∑–Ω–∞–∫–æ–º—ã–π –≥–æ–ª–æ—Å</div>
                        <div class="dialogue-text">–¢—ã—Å—è—á–µ–ª–µ—Ç–∏—è —Å–ø—É—Å—Ç—è... –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –ø—Ä–∏—à–ª–∏. –ö–∞–º–µ–Ω—å –ø–æ–º–Ω–∏—Ç, –∫–∞–º–µ–Ω—å –∂–¥–∞–ª. –í—Ä–µ–º—è —Ç–µ—á–µ—Ç –∫–∞–∫ –ø–µ—Å–æ–∫, –∞ –≤—ã... –≤—ã –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –µ–≥–æ –±–µ–≥.</div>
                    </div>
                </div>
                
                <!-- –°—Ü–µ–Ω–∞ 9: –í—Ç–æ—Ä–∞—è —Ä–µ–ø–ª–∏–∫–∞ –≥–æ–ª–æ—Å–∞ -->
                <div class="story-scene" id="scene9">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–µ–∑–Ω–∞–∫–æ–º—ã–π –≥–æ–ª–æ—Å</div>
                        <div class="dialogue-text">–®–µ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤ –≤–∏–¥–Ω—ã –≥–ª–∞–∑—É, –Ω–æ –ª–∏—à—å —á–µ—Ç—ã—Ä–µ –æ—Ç–∫—Ä–æ—é—Ç –ø—É—Ç—å. –û–≥–æ–Ω—å, –∫–æ—Ç–æ—Ä—ã–π –¥–∞—Ä–∏—Ç –∂–∏–∑–Ω—å –∏ –∑–∞–±–∏—Ä–∞–µ—Ç –µ—ë. –í–æ–¥–∞, —á—Ç–æ –Ω–µ—Å—ë—Ç –∏ —Ç–æ–ø–∏—Ç. –í–æ–∑–¥—É—Ö, —á—Ç–æ —à–µ–ø—á–µ—Ç –∏ –∫—Ä—É—à–∏—Ç. –°–≤–µ—Ç, —á—Ç–æ –æ–∑–∞—Ä—è–µ—Ç –∏ –æ—Å–ª–µ–ø–ª—è–µ—Ç.</div>
                    </div>
                </div>
                
                <!-- –°—Ü–µ–Ω–∞ 10: –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="story-scene" id="scene10">
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–µ–∑–Ω–∞–∫–æ–º—ã–π –≥–æ–ª–æ—Å</div>
                        <div class="dialogue-text">–í—ã–±–µ—Ä–∏ –≤–µ—Ä–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫, –∏ –≤—Ä–∞—Ç–∞ –æ—Ç–∫—Ä–æ—é—Ç—Å—è. –û—à–∏–±–µ—à—å—Å—è... –∏ –æ—Å—Ç–∞–Ω–µ—à—å—Å—è –∑–¥–µ—Å—å, –∫–∞–∫ –º–Ω–æ–≥–∏–µ –¥–æ —Ç–µ–±—è.</div>
                        
                        <div class="options-container">
                            <button class="option-button" id="optionActivate">–ù–∞—á–∞—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏—é –∞–ª—Ç–∞—Ä—è</button>
                            <button class="option-button" id="optionAskMore">–°–ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                        </div>
                    </div>
                </div>
                
                <!-- –°—Ü–µ–Ω–∞ 11: –î–∏–∞–ª–æ–≥ —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ -->
                <div class="story-scene" id="scene11">
                    <button class="back-button" id="backFromQuestions">‚Üê –ù–∞–∑–∞–¥</button>
                    
                    <div class="dialogue-container">
                        <div class="speaker-name">–ù–µ–∑–Ω–∞–∫–æ–º—ã–π –≥–æ–ª–æ—Å</div>
                        <div class="dialogue-text">–ó–∞–¥–∞–π —Å–≤–æ–∏ –≤–æ–ø—Ä–æ—Å—ã, —Å—Ç—Ä–∞–Ω–Ω–∏–∫...</div>
                    </div>
                    
                    <div class="questions-container" id="questionsContainer"></div>
                    
                    <div class="dialogue-container" id="answerContainer" style="display: none;">
                        <div class="speaker-name">–ù–µ–∑–Ω–∞–∫–æ–º—ã–π –≥–æ–ª–æ—Å</div>
                        <div class="dialogue-text" id="answerText"></div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="pixel-button" id="continueToActivation" style="display: none;">–ü–æ–Ω—è—Ç–Ω–æ. –ü–µ—Ä–µ–π—Ç–∏ –∫ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</button>
                        <button class="pixel-button" id="askMoreQuestions" style="display: none;">–°–ø—Ä–æ—Å–∏—Ç—å –µ—â—ë</button>
                    </div>
                </div>
            </div>
            
            <div class="next-button-container">
                <button class="pixel-button" id="nextButton">–î–∞–ª–µ–µ</button>
            </div>
        </div>
    </div>

    <script>
    // ===================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====================
    let currentScene = 0;
    let isTyping = false;
    let typingInterval = null;
    let askedQuestions = new Set();
    let selectedRunes = [];
    let currentSlot = 1;
    let miniGameHints = 3;
    let currentProcrastinatusScene = 1;
    let currentVideoElement = null;
    let currentVideoSrc = '';
    let isInProcrastinatusWorld = false;
    let procrastinationChoiceMade = false;
    let procrastinationChoice = null;
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º
    let isSoundEnabled = true;
    let backgroundMusic = document.getElementById('backgroundMusic');
    let volumeLevel = 0.5;
    
    // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã –ø–µ—Ç–ª–∏ –≤—Ä–µ–º–µ–Ω–∏
    let loopGameState = {
        attempt: 1,
        energy: 10,
        hints: 3,
        progress: 0,
        sceneIndex: 0,
        usedActions: new Set(),
        lastAction: null
    };
    
    const loopGameData = {
        maxEnergy: 10,
        maxHints: 3,
        actions: [
            {
                id: 'analyze',
                title: 'üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å',
                cost: 2,
                successRate: 0.7,
                resultMessages: [
                    '–¢—ã –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—à—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å –≤ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ç—É–º–∞–Ω–∞...',
                    '–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –≤ –ø–µ—Ç–ª–µ...',
                    '–¢—ã –∑–∞–º–µ—á–∞–µ—à—å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã –Ω–∞ –¥–µ—Ä–µ–≤—å—è—Ö...'
                ]
            },
            {
                id: 'mark',
                title: 'üìç –ú–µ—Ç–∫–∞',
                cost: 1,
                successRate: 0.8,
                resultMessages: [
                    '–ú–µ—Ç–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è...',
                    '–¢—ã –æ—Å—Ç–∞–≤–ª—è–µ—à—å —Å–ª–µ–¥—ã, –Ω–æ –æ–Ω–∏ –∏—Å—á–µ–∑–∞—é—Ç...',
                    '–ú–µ—Ç–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–≤–∏–∂–µ—à—å—Å—è –ø–æ –∫—Ä—É–≥—É...'
                ]
            },
            {
                id: 'memory',
                title: 'üß† –ó–∞–ø–æ–º–Ω–∏—Ç—å',
                cost: 0,
                successRate: 0.9,
                resultMessages: [
                    '–¢—ã –∑–∞–ø–æ–º–∏–Ω–∞–µ—à—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ—Ä–µ–≤—å–µ–≤...',
                    '–ü–∞–º—è—Ç—å –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–±–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å...',
                    '–¢—ã –≤—Å–ø–æ–º–∏–Ω–∞–µ—à—å, –≥–¥–µ —É–∂–µ –±—ã–ª...'
                ]
            },
            {
                id: 'run',
                title: 'üèÉ –ë–µ–∂–∞—Ç—å',
                cost: 3,
                successRate: 0.5,
                resultMessages: [
                    '–¢—ã –±–µ–∂–∏—à—å –∏–∑–æ –≤—Å–µ—Ö —Å–∏–ª, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è –∫ –Ω–∞—á–∞–ª—É...',
                    '–ë–µ–≥ –∏—Å—Ç–æ—â–∞–µ—Ç —Å–∏–ª—ã, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Ö–æ–¥...',
                    '–°–∫–æ—Ä–æ—Å—Ç—å –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, –Ω—É–∂–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è...'
                ]
            }
        ],
        scenes: [
            { emoji: 'üîÑ', text: '‚è≥ –í—ã –∑–∞—Å—Ç—Ä—è–ª–∏ –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø–µ—Ç–ª–µ –≤—Ä–µ–º–µ–Ω–∏. –í–æ–∫—Ä—É–≥ —Ç—É–º–∞–Ω, –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –¥–µ—Ä–µ–≤—å—è...' },
            { emoji: 'üå´Ô∏è', text: '–¢—É–º–∞–Ω —Å–≥—É—â–∞–µ—Ç—Å—è... –§–∏–æ–ª–µ—Ç–æ–≤—ã–π —Å–≤–µ—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —è—Ä—á–µ. –î–µ—Ä–µ–≤—å—è —à–µ–ø—á—É—Ç...' },
            { emoji: 'üë£', text: '–¢–≤–æ–∏ —Å–ª–µ–¥—ã –∏—Å—á–µ–∑–∞—é—Ç –∑–∞ —Å–ø–∏–Ω–æ–π. –ö–∞–∂–µ—Ç—Å—è, —Ç—ã —É–∂–µ –±—ã–ª –∑–¥–µ—Å—å...' },
            { emoji: 'üåÄ', text: '–í—Ä–µ–º—è –∑–∞–∫—Ä—É—á–∏–≤–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Ä–∞–ª—å. –ü—Ä–æ—à–ª–æ–µ –∏ –±—É–¥—É—â–µ–µ —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è...' }
        ],
        yumiHints: {
            general: [
                'üê≠ "–Ø –∑–∞–º–µ—Ç–∏–ª–∞: –¥–µ—Ä–µ–≤–æ —Å —Ä—É–∫–æ–π –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ —Ç—Ä–∏ –∫—Ä—É–≥–∞!"',
                'üê≠ "–¢—É–º–∞–Ω —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Ç–≤–æ–∏ –º—ã—Å–ª–∏! –î—É–º–∞–π –æ –≤—ã—Ö–æ–¥–µ!"',
                'üê≠ "–í—Ä–µ–º—è –∑–¥–µ—Å—å —Ç–µ—á—ë—Ç –ø–æ —Å–ø–∏—Ä–∞–ª–∏, –∞ –Ω–µ –ø–æ –ø—Ä—è–º–æ–π!"',
                'üê≠ "–ü–æ–ø—Ä–æ–±—É–π –∏–¥—Ç–∏ –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏!"',
                'üê≠ "–°–º–æ—Ç—Ä–∏ –Ω–∞ —Ç–µ–Ω–∏! –û–Ω–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º!"'
            ],
            analyze: 'üê≠ "–ò—Å—Å–ª–µ–¥—É–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ! –Ø —á—É–≤—Å—Ç–≤—É—é —Å–ª–∞–±—ã–µ –≤–∏–±—Ä–∞—Ü–∏–∏ –≤ –≤–æ–∑–¥—É—Ö–µ..."',
            mark: 'üê≠ "–ú–µ—Ç–∫–∏ –∏—Å—á–µ–∑–∞—é—Ç, –Ω–æ –ø–∞–º—è—Ç—å –æ—Å—Ç–∞—ë—Ç—Å—è! –ó–∞–ø–æ–º–∏–Ω–∞–π!"',
            memory: 'üê≠ "–¢–≤–æ—è –ø–∞–º—è—Ç—å - –∫–ª—é—á! –í—Å–ø–æ–º–∏–Ω–∞–π –∫–∞–∂–¥—ã–π –ø–æ–≤–æ—Ä–æ—Ç!"',
            run: 'üê≠ "–ù–µ –±–µ–≥–∏! –î–≤–∏–≥–∞–π—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ!"'
        }
    };
    
    // –î–∞–Ω–Ω—ã–µ —Ä—É–Ω –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä—ã
    const runesData = [
        { id: 1, name: "–û–ì–û–ù–¨", symbol: "üî•", correctPosition: 1 },
        { id: 2, name: "–í–û–ó–î–£–•", symbol: "üí®", correctPosition: 3 },
        { id: 3, name: "–í–û–î–ê", symbol: "üíß", correctPosition: 2 },
        { id: 4, name: "–ó–ï–ú–õ–Ø", symbol: "ü™®", correctPosition: null },
        { id: 5, name: "–°–í–ï–¢", symbol: "‚ú®", correctPosition: 4 },
        { id: 6, name: "–¢–ï–ù–¨", symbol: "üåë", correctPosition: null }
    ];
    
    const correctSequence = [1, 3, 2, 5];
    
    // –¢–µ–∫—Å—Ç—ã —Å—Ü–µ–Ω
    const sceneTexts = [
        "–î–µ–Ω—å –≤—ã–¥–∞–ª—Å—è –º–æ—Ä–æ–∑–Ω—ã–º. –ù–∏–∫ –∏ –º—ã—à–∫–∞ –Æ–º–∏ –±—Ä–µ–¥—É—Ç –ø–æ –∑–∞—Å–Ω–µ–∂–µ–Ω–Ω–æ–º—É –ø–æ–ª—é, –ø—Ä–æ–≤–∞–ª–∏–≤–∞—è—Å—å –ø–æ –∫–æ–ª–µ–Ω–æ –≤ –ø—É—à–∏—Å—Ç—ã–π —Å–Ω–µ–≥.",
        "–ö–∞—Ä—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∞–ª—Ç–∞—Ä—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–¥–µ-—Ç–æ –ø–æ—Å—Ä–µ–¥–∏ —ç—Ç–æ–≥–æ –±–µ—Å–∫—Ä–∞–π–Ω–µ–≥–æ –ø–æ–ª—è.",
        "–° –∫–∞–∂–¥—ã–º —à–∞–≥–æ–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å—ë —Ö–æ–ª–æ–¥–Ω–µ–µ, –Ω–æ –ù–∏–∫ –∏ –Æ–º–∏ –Ω–µ —Å–¥–∞—é—Ç—Å—è.",
        "–í–Ω–µ–∑–∞–ø–Ω–æ –Æ–º–∏ –∑–∞–º–µ—á–∞–µ—Ç —Å—Ç—Ä–∞–Ω–Ω–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –≤–¥–∞–ª–µ–∫–µ.",
        "–î–æ–±—Ä–∞–≤—à–∏—Å—å –¥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–≤–µ—Ç–∞, –æ–Ω–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç –¥—Ä–µ–≤–Ω–∏–π –∫–∞–º–µ–Ω–Ω—ã–π –∞–ª—Ç–∞—Ä—å.",
        "–Æ–º–∏ –ø—Ä—ã–≥–∞–µ—Ç –Ω–∞ –∞–ª—Ç–∞—Ä—å –∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã.",
        "–ù–∞ –∞–ª—Ç–∞—Ä–µ –ª–µ–∂–∞—Ç –¥—Ä–µ–≤–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã: —Å–≤–µ—á–∏, –º–∏—Å–∫–∏ –∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã–µ —Å—Ç—É–ø—ã."
    ];
    
    // –í–∏–¥–µ–æ –¥–ª—è —Å—Ü–µ–Ω
    const sceneVideos = [
        'video/Idyt po snegy.mp4',
        'video/Idyt po snegy.mp4',
        'video/Idyt po snegy.mp4',
        'video/Idyt po snegy.mp4',
        'video/Obnaryjen altar.mp4',
        'video/Altar blige.mp4',
        'video/Altar blige.mp4',
        'video/Altar 3.mp4',
        'video/Altar 3.mp4',
        'video/Altar 3.mp4',
        'video/Altar 3.mp4'
    ];
    
    // –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –¥–∏–∞–ª–æ–≥–∞
    const questionsData = [
        { id: 1, question: "–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –µ—Å–ª–∏ —è –æ—à–∏–±—Å—è?", answer: "–û—à–∏–±–µ—à—å—Å—è - –∏ –æ—Å—Ç–∞–Ω–µ—à—å—Å—è –∑–¥–µ—Å—å –Ω–∞–≤—Å–µ–≥–¥–∞." },
        { id: 2, question: "–ö–∞–∫–∞—è —Ä—É–Ω–∞ –∏–¥–µ—Ç –ø–µ—Ä–≤–æ–π?", answer: "–ü–µ—Ä–≤–æ–µ - —Ç–æ, —á—Ç–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∏—Å–∫—Ä—ã." },
        { id: 3, question: "–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —ç—Ç–∏ —Å–∏–º–≤–æ–ª—ã?", answer: "–≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç—ã –±—ã—Ç–∏—è." }
    ];

    // –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –î–ê–ù–ù–´–ï –î–õ–Ø –í–´–ë–û–†–ê –î–ï–ô–°–¢–í–ò–ô
    const procrastinationActions = [
        {
            id: 1,
            title: "–°–û–ë–†–ê–¢–¨ –§–ò–û–õ–ï–¢–û–í–´–ï –¶–í–ï–¢–´",
            emoji: "üíê",
            description: "–°–æ–±—Ä–∞—Ç—å –±—É–∫–µ—Ç —Å—Ç—Ä–∞–Ω–Ω—ã—Ö —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã—Ö —Ü–≤–µ—Ç–æ–≤, —Ä–∞—Å—Ç—É—â–∏—Ö –∑–¥–µ—Å—å",
            isCorrect: false
        },
        {
            id: 2,
            title: "–ù–ê–†–ò–°–û–í–ê–¢–¨ –ù–ê –ü–ï–°–ö–ï",
            emoji: "üñåÔ∏è",
            description: "–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å —á—Ç–æ-–Ω–∏–±—É–¥—å –Ω–∞ –ø–µ—Å–∫–µ, –∫–æ—Ç–æ—Ä—ã–π —Ç—É—Ç –∂–µ –∏—Å—á–µ–∑–∞–µ—Ç",
            isCorrect: false
        },
        {
            id: 3,
            title: "–ü–û–ì–û–í–û–†–ò–¢–¨ –° –î–ï–†–ï–í–¨–Ø–ú–ò",
            emoji: "üå≥",
            description: "–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–≥–æ–≤–æ—Ä–∏—Ç—å —Å –¥–µ—Ä–µ–≤—å—è–º–∏-–ø—Ä–∏–∑—Ä–∞–∫–∞–º–∏",
            isCorrect: false
        },
        {
            id: 4,
            title: "–ü–û–î–£–ú–ê–¢–¨ –ö–ê–ö –í–´–ë–†–ê–¢–¨–°–Ø",
            emoji: "üß†",
            description: "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –∏ –ø–æ–¥—É–º–∞—Ç—å –æ —Å–ø–æ—Å–æ–±–µ –ø–æ–±–µ–≥–∞ –∏–∑ —ç—Ç–æ–≥–æ –º–∏—Ä–∞",
            isCorrect: true
        }
    ];

    // ===================== –§–£–ù–ö–¶–ò–ò –°–ú–ï–ù–´ –§–û–ù–ê =====================
    
    function setBackground(type) {
        const body = document.body;
        
        if (type === 'default') {
            body.classList.remove('shadow-world-bg');
            body.classList.add('default-bg');
        } else if (type === 'shadow-world') {
            body.classList.remove('default-bg');
            body.classList.add('shadow-world-bg');
        }
    }

    // ===================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–í–£–ö–û–ú =====================
    
    function initAudio() {
        backgroundMusic.volume = volumeLevel;
        
        function playMusic() {
            backgroundMusic.play().then(() => {
                console.log("üéµ –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ —É—Å–ø–µ—à–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è");
            }).catch(error => {
                console.log("‚ö†Ô∏è –ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –±—Ä–∞—É–∑–µ—Ä–æ–º. –ó–≤—É–∫ –≤–∫–ª—é—á–∏—Ç—Å—è –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.");
                console.log("–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ:", error.message);
                
                document.addEventListener('click', function enableMusic() {
                    if (isSoundEnabled && backgroundMusic.paused) {
                        backgroundMusic.play().then(() => {
                            console.log("üéµ –ú—É–∑—ã–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");
                        }).catch(e => {
                            console.log("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏:", e.message);
                        });
                    }
                    document.removeEventListener('click', enableMusic);
                }, { once: true });
            });
        }
        
        playMusic();
        
        document.getElementById('audioToggle').addEventListener('click', toggleSound);
        
        document.getElementById('volumeSlider').addEventListener('input', function(e) {
            volumeLevel = e.target.value / 100;
            if (isSoundEnabled) {
                backgroundMusic.volume = volumeLevel;
            }
        });
    }
    
    function toggleSound() {
        isSoundEnabled = !isSoundEnabled;
        const audioBtn = document.getElementById('audioToggle');
        
        if (isSoundEnabled) {
            backgroundMusic.volume = volumeLevel;
            backgroundMusic.play().catch(e => {
                console.log("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∑–≤—É–∫–∞:", e.message);
            });
            audioBtn.textContent = 'üîä';
        } else {
            backgroundMusic.volume = 0;
            audioBtn.textContent = 'üîá';
        }
    }
    
    // ===================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–ì–†–´ =====================
    
    function showScene(sceneIndex) {
        currentScene = sceneIndex;
        
        const scenes = document.querySelectorAll('.story-scene');
        scenes.forEach(scene => scene.classList.remove('active'));
        
        if (sceneIndex < scenes.length) {
            scenes[sceneIndex].classList.add('active');
        }
        
        updateVideo(sceneIndex);
        updateNextButton(sceneIndex);
        
        if (sceneIndex < 7) {
            const textElement = document.getElementById(`typing${sceneIndex + 1}`);
            if (textElement && sceneTexts[sceneIndex]) {
                typeText(textElement, sceneTexts[sceneIndex], 40);
            }
        }
        
        if (sceneIndex === 10) {
            initQuestionsScene();
        }
    }
    
    function updateVideo(sceneIndex) {
        const videoPlayer = document.getElementById('videoPlayer');
        
        if (sceneIndex < sceneVideos.length) {
            const videoSrc = sceneVideos[sceneIndex];
            
            if (currentVideoSrc !== videoSrc) {
                if (currentVideoElement) {
                    currentVideoElement.pause();
                    currentVideoElement.currentTime = 0;
                }
                
                videoPlayer.innerHTML = `
                    <video autoplay muted loop playsinline style="width:100%; height:100%; object-fit:cover;">
                        <source src="${videoSrc}" type="video/mp4">
                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                    </video>
                `;
                
                currentVideoElement = videoPlayer.querySelector('video');
                currentVideoSrc = videoSrc;
                
                if (currentVideoElement) {
                    currentVideoElement.play().catch(e => {
                        console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–∏–¥–µ–æ:", e.message);
                    });
                }
            } else {
                if (currentVideoElement) {
                    if (currentVideoElement.paused) {
                        currentVideoElement.play().catch(e => {
                            console.log("–û—à–∏–±–∫–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ:", e.message);
                        });
                    }
                }
            }
        }
    }
    
    function updateNextButton(sceneIndex) {
        const nextButton = document.getElementById('nextButton');
        
        if (sceneIndex === 9 || sceneIndex === 10) {
            nextButton.style.display = 'none';
        } else {
            nextButton.style.display = 'block';
        }
    }
    
    function typeText(element, text, speed = 40) {
        isTyping = true;
        element.innerHTML = '';
        let i = 0;
        
        typingInterval = setInterval(() => {
            if (i < text.length) {
                element.innerHTML += text.charAt(i);
                i++;
            } else {
                clearInterval(typingInterval);
                isTyping = false;
            }
        }, speed);
    }
    
    function stopTyping() {
        if (typingInterval) {
            clearInterval(typingInterval);
            isTyping = false;
        }
    }
    
    function showFullText() {
        if (currentScene < 7) {
            const textElement = document.getElementById(`typing${currentScene + 1}`);
            if (textElement && sceneTexts[currentScene]) {
                textElement.innerHTML = sceneTexts[currentScene];
            }
        }
    }
    
    // ===================== –§–£–ù–ö–¶–ò–ò –í–û–ü–†–û–°–û–í –ê–õ–¢–ê–†–Ø =====================
    
    function initQuestionsScene() {
        const questionsContainer = document.getElementById('questionsContainer');
        questionsContainer.innerHTML = '';
        
        const unansweredQuestions = questionsData.filter(q => !askedQuestions.has(q.id));
        
        if (unansweredQuestions.length > 0) {
            unansweredQuestions.forEach(question => {
                const questionElement = document.createElement('div');
                questionElement.className = 'question-item';
                questionElement.innerHTML = question.question;
                questionElement.addEventListener('click', () => showAnswer(question));
                questionsContainer.appendChild(questionElement);
            });
        } else {
            const message = document.createElement('div');
            message.className = 'question-item';
            message.innerHTML = "–í—ã –∑–∞–¥–∞–ª–∏ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∫ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–ª—Ç–∞—Ä—è.";
            questionsContainer.appendChild(message);
        }
        
        const continueBtn = document.getElementById('continueToActivation');
        const askMoreBtn = document.getElementById('askMoreQuestions');
        
        if (askedQuestions.size >= questionsData.length) {
            continueBtn.style.display = 'inline-block';
            askMoreBtn.style.display = 'none';
        } else {
            askMoreBtn.style.display = 'inline-block';
        }
    }
    
    function showAnswer(question) {
        askedQuestions.add(question.id);
        
        document.getElementById('answerText').textContent = question.answer;
        document.getElementById('answerContainer').style.display = 'block';
        document.getElementById('questionsContainer').style.display = 'none';
        
        document.getElementById('continueToActivation').style.display = 'inline-block';
        document.getElementById('askMoreQuestions').style.display = 'inline-block';
    }
    
    function resetQuestionsView() {
        document.getElementById('answerContainer').style.display = 'none';
        document.getElementById('questionsContainer').style.display = 'block';
        document.getElementById('continueToActivation').style.display = 'none';
        document.getElementById('askMoreQuestions').style.display = 'none';
        
        initQuestionsScene();
    }
    
    // ===================== –ú–ò–ù–ò-–ò–ì–†–ê –ê–õ–¢–ê–†–Ø =====================
    
    function startMiniGame() {
        document.getElementById('videoScreen').style.display = 'none';
        document.getElementById('miniGame').classList.add('active');
        
        initRunes();
        resetSequence();
        miniGameHints = 3;
        document.getElementById('hintButton').textContent = 'üí≠ –ü–æ–¥—Å–∫–∞–∑–∫–∞ (3 –æ—Å—Ç–∞–ª–æ—Å—å)';
        document.getElementById('hintButton').disabled = false;
    }
    
    function initRunes() {
        const runesContainer = document.getElementById('runesContainer');
        runesContainer.innerHTML = '';
        
        runesData.forEach(rune => {
            const runeElement = document.createElement('div');
            runeElement.className = 'rune-item';
            runeElement.innerHTML = `
                <div style="font-size: 30px; margin-bottom: 8px;">${rune.symbol}</div>
                <div style="font-size: 11px; color: #ffd54f;">${rune.name}</div>
            `;
            
            runeElement.addEventListener('click', () => {
                selectRune(rune);
            });
            
            runesContainer.appendChild(runeElement);
        });
    }
    
    function selectRune(rune) {
        if (selectedRunes.length >= 4) return;
        
        if (selectedRunes.find(r => r.id === rune.id)) return;
        
        selectedRunes.push(rune);
        
        const slot = document.querySelector(`.sequence-slot[data-slot="${currentSlot}"]`);
        slot.textContent = rune.symbol;
        slot.classList.add('filled');
        
        currentSlot++;
        
        if (selectedRunes.length === 4) {
            document.getElementById('activateButton').disabled = false;
        }
    }
    
    function resetSequence() {
        selectedRunes = [];
        currentSlot = 1;
        
        const slots = document.querySelectorAll('.sequence-slot');
        slots.forEach(slot => {
            slot.textContent = '?';
            slot.classList.remove('filled');
        });
        
        document.getElementById('activateButton').disabled = true;
    }
    
    function giveHint() {
        if (miniGameHints <= 0) return;
        miniGameHints--;
        
        document.getElementById('hintButton').textContent = `üí≠ –ü–æ–¥—Å–∫–∞–∑–∫–∞ (${miniGameHints} –æ—Å—Ç–∞–ª–æ—Å—å)`;
        
        const hints = [
            "–ü–µ—Ä–≤–∞—è —Ä—É–Ω–∞ - üî• –û–ì–û–ù–¨",
            "–í—Ç–æ—Ä–∞—è —Ä—É–Ω–∞ —Ç–µ—á—ë—Ç –∫–∞–∫ üíß –í–û–î–ê",
            "–¢—Ä–µ—Ç—å—è —Ä—É–Ω–∞ –Ω–µ–≤–∏–¥–∏–º–∞ –∫–∞–∫ üí® –í–û–ó–î–£–•",
            "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä—É–Ω–∞ –æ–∑–∞—Ä—è–µ—Ç –∫–∞–∫ ‚ú® –°–í–ï–¢",
            "–ü–æ—Ä—è–¥–æ–∫: –Ω–∞—á–∞–ª–æ —Å –æ–≥–Ω—è, –∑–∞—Ç–µ–º –≤–æ–¥–∞..."
        ];
        
        const randomHint = hints[Math.floor(Math.random() * hints.length)];
        
        const hintDisplay = document.createElement('div');
        hintDisplay.style.position = 'fixed';
        hintDisplay.style.top = '50%';
        hintDisplay.style.left = '50%';
        hintDisplay.style.transform = 'translate(-50%, -50%)';
        hintDisplay.style.background = 'rgba(42, 32, 20, 0.95)';
        hintDisplay.style.border = '5px solid #8bc34a';
        hintDisplay.style.padding = '25px';
        hintDisplay.style.borderRadius = '12px';
        hintDisplay.style.color = '#ffd54f';
        hintDisplay.style.fontSize = '14px';
        hintDisplay.style.zIndex = '10000';
        hintDisplay.style.textAlign = 'center';
        hintDisplay.innerHTML = `
            <div style="margin-bottom: 15px;">üí≠ –ü–û–î–°–ö–ê–ó–ö–ê:</div>
            <div>${randomHint}</div>
            <button style="margin-top: 20px; padding: 10px 20px; background: #4a8b4a; color: white; border: none; border-radius: 8px; cursor: pointer;" onclick="this.parentElement.remove()">
                –ü–æ–Ω—è—Ç–Ω–æ
            </button>
        `;
        
        document.body.appendChild(hintDisplay);
        
        if (miniGameHints <= 0) {
            document.getElementById('hintButton').disabled = true;
        }
    }
    
    function checkSequence() {
        const userSequence = selectedRunes.map(rune => rune.id);
        let correctCount = 0;
        
        for (let i = 0; i < 4; i++) {
            if (userSequence[i] === correctSequence[i]) correctCount++;
        }
        
        showAltarResult(correctCount);
    }
    
    function showAltarResult(correctCount) {
        document.getElementById('miniGame').classList.remove('active');
        
        if (correctCount === 4) {
            document.getElementById('gameResult').classList.add('active');
            document.getElementById('resultTitle').textContent = '–ê–õ–¢–ê–†–¨ –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!';
            document.getElementById('resultText').innerHTML = '–ü–æ—Ä—Ç–∞–ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è... –î—Ä–µ–≤–Ω–∏–µ —Å–∏–ª—ã –ø—Ä–æ–±—É–∂–¥–∞—é—Ç—Å—è. –®–∞–≥–Ω–∏ –≤–Ω—É—Ç—Ä—å, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å.<br><br><em style="color:#8bc34a; font-size:13px;">–¢–µ–Ω—å –∂–¥—ë—Ç –≤–∞—Å –≤ —ç—Ç–æ–º –º–∏—Ä–µ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã—Ö —Ç—É–º–∞–Ω–æ–≤. –ù–æ –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã - –∑–¥–µ—Å—å –ø—Ä–∞–≤–∏—Ç –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å, —Å—É—â–µ–Ω–æ–µ –≤–µ—á–Ω–æ–≥–æ –ø—Ä–æ–º–µ–¥–ª–µ–Ω–∏—è.</em>';
        } else {
            alert(`–í—ã —É–≥–∞–¥–∞–ª–∏ ${correctCount} –∏–∑ 4 —Ä—É–Ω.\n\n–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫:\n1. üî• –û–ì–û–ù–¨\n2. üíß –í–û–î–ê\n3. üí® –í–û–ó–î–£–•\n4. ‚ú® –°–í–ï–¢\n\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑!`);
            resetSequence();
        }
    }
    
    // ===================== –ü–ï–†–ï–•–û–î –í –ú–ò–† –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°–ê =====================
    
    function startShadowTransition() {
        document.getElementById('gameResult').classList.remove('active');
        document.getElementById('shadowTransition').classList.add('active');
        
        const video = document.getElementById('transitionVideoPlayer');
        
        video.currentTime = 0;
        video.play().catch(e => console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:", e));
        
        video.onended = () => {
            document.getElementById('shadowTransition').classList.remove('active');
            startProcrastinatusWorld();
        };
        
        setTimeout(() => {
            if (document.getElementById('shadowTransition').classList.contains('active')) {
                document.getElementById('shadowTransition').classList.remove('active');
                startProcrastinatusWorld();
            }
        }, 8000);
    }
    
    function startProcrastinatusWorld() {
        console.log('–ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∏—Ä–∞ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞');
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
        document.getElementById('videoScreen').style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∏—Ä –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞
        document.getElementById('procrastinatusWorld').classList.add('active');
        currentProcrastinatusScene = 1;
        isInProcrastinatusWorld = true;
        
        // –ú–µ–Ω—è–µ–º —Ñ–æ–Ω –Ω–∞ –º–∏—Ä –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞
        setBackground('shadow-world');
        console.log('–§–æ–Ω –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ shadow-world');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" –≤ –º–∏—Ä–µ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞
        document.getElementById('nextButton').style.display = 'block';
        
        showProcrastinatusScene(1);
    }
    
    function showProcrastinatusScene(sceneNumber) {
        const scenes = document.querySelectorAll('.procrastinatus-scene');
        scenes.forEach(scene => {
            scene.classList.remove('active');
        });
        
        const scene = document.getElementById(`procrastinatusScene${sceneNumber}`);
        if (scene) {
            scene.classList.add('active');
            currentProcrastinatusScene = sceneNumber;
            
            resetDialogueForScene(sceneNumber);
            
            // –ï—Å–ª–∏ —ç—Ç–æ —Å—Ü–µ–Ω–∞ 5, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π
            if (sceneNumber === 5 && !procrastinationChoiceMade) {
                initProcrastinationChoiceGame();
            }
        }
    }
    
    function resetDialogueForScene(sceneNumber) {
        const scene = document.getElementById(`procrastinatusScene${sceneNumber}`);
        if (!scene) return;
        
        const steps = scene.querySelectorAll('.dialogue-step');
        steps.forEach(step => {
            step.classList.remove('active');
        });
        
        if (steps.length > 0) {
            steps[0].classList.add('active');
        }
    }
    
    // ===================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–ù–û–ü–ö–û–ô "–î–ê–õ–ï–ï" =====================
    
    function handleNextButton() {
        if (isInProcrastinatusWorld) {
            handleProcrastinatusNext();
        } else {
            handleMainGameNext();
        }
    }
    
    function handleMainGameNext() {
        if (isTyping) {
            stopTyping();
            showFullText();
            return;
        }
        
        if (currentScene < 10) {
            currentScene++;
            showScene(currentScene);
        }
    }
    
    function handleProcrastinatusNext() {
        const activeScene = document.querySelector('.procrastinatus-scene.active');
        if (!activeScene) return;
        
        const sceneNumber = parseInt(activeScene.id.replace('procrastinatusScene', ''));
        const activeStep = activeScene.querySelector('.dialogue-step.active');
        
        if (!activeStep) return;
        
        const steps = activeScene.querySelectorAll('.dialogue-step');
        const currentIndex = Array.from(steps).indexOf(activeStep);
        
        if (currentIndex < steps.length - 1) {
            // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É –¥–∏–∞–ª–æ–≥–∞
            activeStep.classList.remove('active');
            steps[currentIndex + 1].classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏, –µ—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º
            if (sceneNumber === 5 && currentIndex + 1 === steps.length - 2) {
                document.getElementById('nextButton').textContent = 'üö∂‚Äç‚ôÇÔ∏è –í–´–ô–¢–ò –ò–ó –ú–ò–†–ê –¢–ï–ù–ò';
            }
        } else {
            // –ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ –¥–∏–∞–ª–æ–≥–∞, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ü–µ–Ω–µ
            if (sceneNumber === 1) {
                showProcrastinatusScene(2);
            } else if (sceneNumber === 2) {
                showProcrastinatusScene(3);
            } else if (sceneNumber === 3) {
                showProcrastinatusScene(4);
            } else if (sceneNumber === 4) {
                // –°—Ü–µ–Ω–∞ 4 - –∑–∞–ø—É—Å–∫ –º–∏–Ω–∏-–∏–≥—Ä—ã –ø–µ—Ç–ª–∏ –≤—Ä–µ–º–µ–Ω–∏
                showLoopMechanic();
                document.getElementById('nextButton').style.display = 'none';
            } else if (sceneNumber === 5) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –±—ã–ª –≤—ã–±—Ä–∞–Ω
                if (procrastinationChoice) {
                    if (procrastinationChoice.isCorrect) {
                        // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä (4-–π –≤–∞—Ä–∏–∞–Ω—Ç) - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ª–∞–≥–µ—Ä—é
                        showProcrastinatusScene(6);
                    } else {
                        // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä (1-3 –≤–∞—Ä–∏–∞–Ω—Ç—ã) - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
                        showChapterCompleteScreen(false);
                    }
                }
            } else if (sceneNumber === 6) {
                // –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ü–µ–Ω–∞ (–ª–∞–≥–µ—Ä—å) - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å —É—Å–ø–µ—Ö–æ–º
                showChapterCompleteScreen(true);
            }
        }
    }
    
    // ===================== –ú–ò–ù–ò-–ò–ì–†–ê –ü–ï–¢–õ–ò –í–†–ï–ú–ï–ù–ò =====================
    
    function showLoopMechanic() {
        const loopMechanic = document.getElementById('loopMechanic');
        loopMechanic.style.display = 'block';
        loopMechanic.classList.add('active');
        
        const dialogueSteps = document.querySelectorAll('#procrastinatusScene4 .dialogue-step');
        dialogueSteps.forEach(step => step.style.display = 'none');
        
        initLoopGame();
    }
    
    function initLoopGame() {
        const loopActionsContainer = document.getElementById('loopActionsContainer');
        loopActionsContainer.innerHTML = '';
        
        loopGameData.actions.forEach(action => {
            const button = document.createElement('button');
            button.className = 'loop-action-btn';
            button.setAttribute('data-action', action.id);
            button.title = action.resultMessages[0];
            
            button.innerHTML = `
                <span class="loop-action-emoji">${action.title.split(' ')[0]}</span>
                <div class="loop-action-text">
                    <div class="loop-action-title">${action.title}</div>
                    <div class="loop-action-cost">–≠–Ω–µ—Ä–≥–∏—è: ${action.cost > 0 ? '-' + action.cost : '+' + Math.abs(action.cost)}</div>
                </div>
            `;
            
            button.addEventListener('click', () => {
                performLoopAction(action);
            });
            
            loopActionsContainer.appendChild(button);
        });
        
        updateLoopUI();
        
        const logContainer = document.getElementById('loopGameLog');
        if (logContainer) {
            logContainer.innerHTML = `
                <div class="loop-log-entry">üåü –ú—ã –ø–æ–ø–∞–ª–∏ –≤ –ø–µ—Ç–ª—é –≤—Ä–µ–º–µ–Ω–∏! –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥...</div>
                <div class="loop-log-entry loop-log-yumi">üê≠ –Æ–º–∏: "–ù–∏–∫, –≤—Å—ë –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è! –î–∞–≤–∞–π –ø–æ–¥—É–º–∞–µ–º..."</div>
            `;
        }
        
        const loopFinishBtn = document.getElementById('loopFinishBtn');
        if (loopFinishBtn) {
            loopFinishBtn.style.display = 'none';
        }
        
        loopGameState.progress = 0;
        const loopProgressFill = document.getElementById('loopProgressFill');
        const loopProgressPercent = document.getElementById('loopProgressPercent');
        if (loopProgressFill) loopProgressFill.style.width = '0%';
        if (loopProgressPercent) loopProgressPercent.textContent = '0%';
    }
    
    function updateLoopUI() {
        const loopAttemptCount = document.getElementById('loopAttemptCount');
        const loopEnergyCount = document.getElementById('loopEnergyCount');
        const loopHintCount = document.getElementById('loopHintCount');
        const loopProgressPercent = document.getElementById('loopProgressPercent');
        const loopProgressFill = document.getElementById('loopProgressFill');
        
        if (loopAttemptCount) loopAttemptCount.textContent = loopGameState.attempt;
        if (loopEnergyCount) loopEnergyCount.textContent = loopGameState.energy;
        if (loopHintCount) loopHintCount.textContent = loopGameState.hints;
        if (loopProgressPercent) loopProgressPercent.textContent = `${loopGameState.progress}%`;
        if (loopProgressFill) loopProgressFill.style.width = `${loopGameState.progress}%`;
        
        if (loopGameData.scenes && loopGameState.sceneIndex < loopGameData.scenes.length) {
            const scene = loopGameData.scenes[loopGameState.sceneIndex % loopGameData.scenes.length];
            if (document.getElementById('loopSceneEmoji')) {
                document.getElementById('loopSceneEmoji').textContent = scene.emoji;
            }
            if (document.getElementById('loopSceneText')) {
                document.getElementById('loopSceneText').textContent = scene.text;
            }
        }
        
        updateLoopButtons();
    }
    
    function updateLoopButtons() {
        const loopGetHintBtn = document.getElementById('loopGetHintBtn');
        const loopAnalyzeBtn = document.getElementById('loopAnalyzeBtn');
        
        if (loopGetHintBtn) {
            loopGetHintBtn.disabled = loopGameState.energy < 1 || loopGameState.hints <= 0;
        }
        if (loopAnalyzeBtn) {
            loopAnalyzeBtn.disabled = loopGameState.energy < 1;
        }
        
        const actionButtons = document.querySelectorAll('#loopActionsContainer .loop-action-btn');
        actionButtons.forEach(button => {
            const actionId = button.getAttribute('data-action');
            if (actionId) {
                const action = loopGameData.actions.find(a => a.id === actionId);
                if (action) {
                    const canAfford = loopGameState.energy >= (action.cost > 0 ? action.cost : 0);
                    button.disabled = !canAfford;
                    button.style.opacity = canAfford ? '1' : '0.5';
                }
            }
        });
    }
    
    function performLoopAction(action) {
        if (loopGameState.energy < (action.cost > 0 ? action.cost : 0)) {
            addLoopLog("‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!", 'system');
            return;
        }
        
        loopGameState.energy = Math.max(0, Math.min(loopGameData.maxEnergy, 
            loopGameState.energy - action.cost));
        
        loopGameState.attempt++;
        loopGameState.usedActions.add(action.id);
        loopGameState.lastAction = action.id;
        
        const isSuccessful = Math.random() < action.successRate;
        const messageIndex = Math.floor(Math.random() * action.resultMessages.length);
        const message = action.resultMessages[messageIndex];
        
        addLoopLog(`${message} ${isSuccessful ? '‚úÖ' : '‚ùå'}`, 'action');
        
        let progressIncrease = isSuccessful ? 
            (15 + Math.floor(Math.random() * 10)) : 
            (5 + Math.floor(Math.random() * 5));
        
        loopGameState.progress = Math.min(100, loopGameState.progress + progressIncrease);
        
        if (loopGameState.usedActions.size % 3 === 0) {
            loopGameState.sceneIndex++;
        }
        
        updateLoopUI();
        
        checkLoopCompletion();
    }
    
    function addLoopLog(text, type = 'system') {
        const entry = document.createElement('div');
        entry.className = `loop-log-entry ${type === 'yumi' ? 'loop-log-yumi' : type === 'action' ? 'loop-log-action' : ''}`;
        entry.textContent = text;
        
        const logContainer = document.getElementById('loopGameLog');
        if (logContainer) {
            logContainer.appendChild(entry);
            
            const entries = logContainer.querySelectorAll('.loop-log-entry');
            if (entries.length > 8) entries[0].remove();
            
            logContainer.scrollTop = logContainer.scrollHeight;
        }
    }
    
    function checkLoopCompletion() {
        if (loopGameState.progress >= 100) {
            addLoopLog("üåü –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–≥ 100%! –í—ã—Ö–æ–¥ –Ω–∞–π–¥–µ–Ω!", 'system');
            
            const loopFinishBtn = document.getElementById('loopFinishBtn');
            if (loopFinishBtn) {
                loopFinishBtn.style.display = 'inline-block';
                loopFinishBtn.classList.add('active');
                
                loopFinishBtn.style.animation = 'pulse 1.5s infinite';
            }
        } else if (loopGameState.energy <= 0 && loopGameState.hints <= 0) {
            setTimeout(() => {
                addLoopLog("üíÄ –≠–Ω–µ—Ä–≥–∏—è –∏—Å—á–µ—Ä–ø–∞–Ω–∞... –ü–µ—Ç–ª—è –∑–∞—Ç—è–≥–∏–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ...", 'system');
                setTimeout(() => {
                    if (confirm("–≠–Ω–µ—Ä–≥–∏—è –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å! –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ?")) {
                        resetLoopGame();
                    }
                }, 1500);
            }, 1000);
        }
    }
    
    function resetLoopGame() {
        loopGameState = {
            attempt: 1,
            energy: 10,
            hints: 3,
            progress: 0,
            sceneIndex: 0,
            usedActions: new Set(),
            lastAction: null
        };
        
        const loopGameLog = document.getElementById('loopGameLog');
        if (loopGameLog) {
            loopGameLog.innerHTML = `
                <div class="loop-log-entry">üåü –ú—ã –ø–æ–ø–∞–ª–∏ –≤ –ø–µ—Ç–ª—é –≤—Ä–µ–º–µ–Ω–∏! –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥...</div>
                <div class="loop-log-entry loop-log-yumi">üê≠ –Æ–º–∏: "–ù–∏–∫, –≤—Å—ë –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è! –î–∞–≤–∞–π –ø–æ–¥—É–º–∞–µ–º..."</div>
            `;
        }
        
        const loopFinishBtn = document.getElementById('loopFinishBtn');
        if (loopFinishBtn) {
            loopFinishBtn.style.display = 'none';
        }
        updateLoopUI();
    }
    
    function finishLoopGame() {
        const loopMechanic = document.getElementById('loopMechanic');
        if (loopMechanic) {
            loopMechanic.style.display = 'none';
            loopMechanic.classList.remove('active');
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ" —Å–Ω–æ–≤–∞
        document.getElementById('nextButton').style.display = 'block';
        document.getElementById('nextButton').textContent = '–î–∞–ª–µ–µ';
        
        showProcrastinatusScene(5);
    }
    
    // ===================== –ú–ò–ù–ò-–ò–ì–†–ê –í–´–ë–û–†–ê –î–ï–ô–°–¢–í–ò–ô –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¶–ò–ò =====================
    
    function initProcrastinationChoiceGame() {
        const actionsContainer = document.getElementById('procrastinationActions');
        if (!actionsContainer) return;
        
        actionsContainer.innerHTML = '';
        
        procrastinationActions.forEach(action => {
            const button = document.createElement('button');
            button.className = 'stagnation-action-btn';
            button.setAttribute('data-action', action.id);
            
            button.innerHTML = `
                <div class="stagnation-action-emoji">${action.emoji}</div>
                <div class="stagnation-action-text">
                    <strong>${action.title}</strong><br>
                    ${action.description}
                </div>
            `;
            
            button.addEventListener('click', () => {
                selectProcrastinationAction(action);
            });
            
            actionsContainer.appendChild(button);
        });
    }
    
    function selectProcrastinationAction(action) {
        procrastinationChoiceMade = true;
        procrastinationChoice = action;
        
        // –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏
        document.querySelectorAll('#procrastinationActions .stagnation-action-btn').forEach(btn => {
            btn.disabled = true;
            btn.style.opacity = '0.5';
        });
        
        // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É
        event.target.classList.add('selected');
        
        // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (4-–π)
        if (action.isCorrect) {
            // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –≤–∏–¥–µ–æ —Ä–∞—Å–ø–∞–¥–∞
            const raspadVideo = document.querySelector('#raspadVideoPlayer video');
            if (raspadVideo) {
                raspadVideo.currentTime = 0;
                raspadVideo.play().catch(e => console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–∏–¥–µ–æ:", e));
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∞–∫—Ü–∏—é –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω—É—Å–∞ (–ø–∞–Ω–∏–∫–∞)
            setTimeout(() => {
                const currentStep = document.querySelector('#choiceGameStep');
                if (currentStep) {
                    currentStep.classList.remove('active');
                }
                
                const panicStep = document.getElementById('panicReactionStep');
                if (panicStep) {
                    panicStep.classList.add('active');
                }
            }, 500);
        } else {
            // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (1-3)
            setTimeout(() => {
                const currentStep = document.querySelector('#choiceGameStep');
                if (currentStep) {
                    currentStep.classList.remove('active');
                }
                
                const wrongStep = document.getElementById('wrongChoiceStep');
                if (wrongStep) {
                    wrongStep.classList.add('active');
                }
            }, 500);
        }
    }
    
    // ===================== –≠–ö–†–ê–ù –ó–ê–í–ï–†–®–ï–ù–ò–Ø –ì–õ–ê–í–´ =====================
    
    function showChapterCompleteScreen(isSuccess) {
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω—ã–π —Ñ–æ–Ω
        setBackground('default');
        
        // –°–∫—Ä—ã–≤–∞–µ–º –º–∏—Ä –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞
        document.getElementById('procrastinatusWorld').classList.remove('active');
        
        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω–æ–≤—É—é –º—É–∑—ã–∫—É
        backgroundMusic.pause();
        backgroundMusic.currentTime = 0;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≥–ª–∞–≤—ã —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
        const chapterCompleteScreen = document.getElementById('chapterCompleteScreen');
        const completionTitle = chapterCompleteScreen.querySelector('.completion-title');
        const completionSubtitle = chapterCompleteScreen.querySelector('.completion-subtitle');
        const completionMessage = chapterCompleteScreen.querySelector('.completion-message');
        
        if (isSuccess) {
            // –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–≤—ã–±—Ä–∞–Ω 4-–π –≤–∞—Ä–∏–∞–Ω—Ç)
            completionTitle.textContent = '‚ú® –ì–õ–ê–í–ê –ó–ê–í–ï–†–®–ï–ù–ê! ‚ú®';
            completionSubtitle.textContent = '"–ú–∏—Ä –¢–µ–Ω–∏" –ø—Ä–æ–π–¥–µ–Ω!';
            completionMessage.innerHTML = `
                –í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–±–µ–¥–∏–ª–∏ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞ –∏ —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä!<br>
                –ù–∏–∫ –∏ –Æ–º–∏ –Ω–∞—à–ª–∏ –∑–∞–±—Ä–æ—à–µ–Ω–Ω—ã–π –ª–∞–≥–µ—Ä—å –¥–ª—è –æ—Ç–¥—ã—Ö–∞ –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º–∏.<br><br>
                <em>"–õ—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫—É, —á–µ–º –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –≤–µ—á–Ω–æ–º '–º–µ–∂–¥—É'".</em>
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
            const achievements = chapterCompleteScreen.querySelectorAll('.achievement-item');
            if (achievements.length >= 4) {
                achievements[0].querySelector('.achievement-emoji').textContent = 'üèÜ';
                achievements[0].querySelector('.achievement-text').textContent = '–ü–æ–±–µ–¥–∞ –Ω–∞–¥ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–æ–º';
                achievements[1].querySelector('.achievement-emoji').textContent = 'üß©';
                achievements[1].querySelector('.achievement-text').textContent = '–ê–∫—Ç–∏–≤–∞—Ü–∏—è –¥—Ä–µ–≤–Ω–µ–≥–æ –∞–ª—Ç–∞—Ä—è';
                achievements[2].querySelector('.achievement-emoji').textContent = '‚è≥';
                achievements[2].querySelector('.achievement-text').textContent = '–í—ã—Ö–æ–¥ –∏–∑ –ø–µ—Ç–ª–∏ –≤—Ä–µ–º–µ–Ω–∏';
                achievements[3].querySelector('.achievement-emoji').textContent = 'üèïÔ∏è';
                achievements[3].querySelector('.achievement-text').textContent = '–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ª–∞–≥–µ—Ä—è';
            }
        } else {
            // –ù–µ—É–¥–∞—á–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–≤—ã–±—Ä–∞–Ω 1-3 –≤–∞—Ä–∏–∞–Ω—Ç)
            completionTitle.textContent = '‚ö†Ô∏è –í–´ –û–°–¢–ê–õ–ò–°–¨ –í –ú–ò–†–ï –ü–†–û–ö–†–ê–°–¢–ò–ù–ê–¢–£–°–ê! ‚ö†Ô∏è';
            completionSubtitle.textContent = '"–í—ã –≤—ã–±—Ä–∞–ª–∏ –æ–¥–∏–Ω –∏–∑ —Ç—Ä—ë—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤"';
            completionMessage.innerHTML = `
                –í—ã —Ä–µ—à–∏–ª–∏ –∑–∞–Ω—è—Ç—å—Å—è –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏ –¥–µ–ª–∞–º–∏ –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–¥—É–º–∞—Ç—å –æ –ø–æ–±–µ–≥–µ.<br>
                –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å –¥–æ–≤–æ–ª–µ–Ω - –≤—ã –æ—Å—Ç–∞–ª–∏—Å—å –≤ –µ–≥–æ –º–∏—Ä–µ –Ω–∞–≤—Å–µ–≥–¥–∞.<br><br>
                <em>"–ó–∞–≤—Ç—Ä–∞ –ø–æ–¥—É–º–∞–µ—à—å... –∏–ª–∏ –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞..."</em>
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –¥–ª—è –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
            const achievements = chapterCompleteScreen.querySelectorAll('.achievement-item');
            if (achievements.length >= 4) {
                achievements[0].querySelector('.achievement-emoji').textContent = 'üíê';
                achievements[0].querySelector('.achievement-text').textContent = '–°–æ–±—Ä–∞–ª–∏ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ —Ü–≤–µ—Ç—ã';
                achievements[1].querySelector('.achievement-emoji').textContent = 'üñåÔ∏è';
                achievements[1].querySelector('.achievement-text').textContent = '–†–∏—Å–æ–≤–∞–ª–∏ –Ω–∞ –ø–µ—Å–∫–µ';
                achievements[2].querySelector('.achievement-emoji').textContent = 'üå≥';
                achievements[2].querySelector('.achievement-text').textContent = '–ì–æ–≤–æ—Ä–∏–ª–∏ —Å –¥–µ—Ä–µ–≤—å—è–º–∏';
                achievements[3].querySelector('.achievement-emoji').textContent = 'üò¥';
                achievements[3].querySelector('.achievement-text').textContent = '–ü–æ–ø–∞–ª–∏—Å—å –≤ –ª–æ–≤—É—à–∫—É';
            }
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        chapterCompleteScreen.classList.add('active');
        
        console.log(`‚ú® –ì–ª–∞–≤–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –†–µ–∑—É–ª—å—Ç–∞—Ç: ${isSuccess ? '–£–°–ü–ï–•' : '–ü–û–†–ê–ñ–ï–ù–ò–ï'}`);
    }
    
    // ===================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï =====================
    
    document.addEventListener('DOMContentLoaded', () => {
        initAudio();
        
        document.getElementById('searchButton').addEventListener('click', () => {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('videoScreen').style.display = 'block';
            currentVideoSrc = '';
            showScene(0);
        });
        
        // –ì–õ–ê–í–ù–ê–Ø –ö–ù–û–ü–ö–ê "–î–ê–õ–ï–ï" - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ–π –∏–≥—Ä–µ
        document.getElementById('nextButton').addEventListener('click', handleNextButton);
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        document.getElementById('optionActivate').addEventListener('click', startMiniGame);
        document.getElementById('optionAskMore').addEventListener('click', () => showScene(10));
        document.getElementById('backFromQuestions').addEventListener('click', () => showScene(9));
        document.getElementById('continueToActivation').addEventListener('click', startMiniGame);
        document.getElementById('askMoreQuestions').addEventListener('click', resetQuestionsView);
        
        document.getElementById('hintButton').addEventListener('click', giveHint);
        document.getElementById('resetButton').addEventListener('click', resetSequence);
        document.getElementById('activateButton').addEventListener('click', checkSequence);
        
        document.getElementById('enterPortal').addEventListener('click', startShadowTransition);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä—ã –ø–µ—Ç–ª–∏ –≤—Ä–µ–º–µ–Ω–∏
        document.getElementById('loopGetHintBtn')?.addEventListener('click', function() {
            if (loopGameState.energy < 1 || loopGameState.hints <= 0) return;
            
            loopGameState.energy--;
            loopGameState.hints--;
            
            let hint;
            if (loopGameState.lastAction && Math.random() > 0.5) {
                hint = loopGameData.yumiHints[loopGameState.lastAction] || 
                       loopGameData.yumiHints.general[0];
            } else {
                const hintIndex = Math.floor(Math.random() * loopGameData.yumiHints.general.length);
                hint = loopGameData.yumiHints.general[hintIndex];
            }
            
            document.getElementById('loopCurrentHint').textContent = hint;
            addLoopLog(hint, 'yumi');
            
            loopGameState.progress = Math.min(100, loopGameState.progress + 3);
            updateLoopUI();
            
            setTimeout(() => {
                const newHintIndex = Math.floor(Math.random() * loopGameData.yumiHints.general.length);
                document.getElementById('loopCurrentHint').textContent = loopGameData.yumiHints.general[newHintIndex];
            }, 5000);
        });
        
        document.getElementById('loopAnalyzeBtn')?.addEventListener('click', function() {
            if (loopGameState.energy < 1) return;
            
            loopGameState.energy--;
            
            const analyses = [
                `üê≠ '–Ø –Ω–∞—Å—á–∏—Ç–∞–ª–∞ —É–∂–µ ${loopGameState.attempt} —Ü–∏–∫–ª–æ–≤. –ü–µ—Ç–ª—è –æ—Å–ª–∞–±–µ–≤–∞–µ—Ç!'`,
                `üê≠ '–≠–Ω–µ—Ä–≥–∏—è –Ω–∞ ${loopGameState.energy}/${loopGameData.maxEnergy}. –≠–∫–æ–Ω–æ–º—å —Å–∏–ª—ã!'`,
                `üê≠ '–ü—Ä–æ–≥—Ä–µ—Å—Å ${loopGameState.progress}%. –ú—ã –±–ª–∏–∑–∫–∏ –∫ –≤—ã—Ö–æ–¥—É!'`,
                `üê≠ '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–µ–π—Å—Ç–≤–∏–π: ${loopGameState.usedActions.size}. –ü–æ–ø—Ä–æ–±—É–π —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ!'`,
                `üê≠ '–¢—É–º–∞–Ω —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Ç–≤–æ–∏ —ç–º–æ—Ü–∏–∏. –°–æ—Ö—Ä–∞–Ω—è–π —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ!'`
            ];
            
            const analysis = analyses[Math.floor(Math.random() * analyses.length)];
            document.getElementById('loopCurrentHint').textContent = analysis;
            addLoopLog(`üîç –ê–Ω–∞–ª–∏–∑: ${analysis}`, 'yumi');
            
            loopGameState.progress = Math.min(100, loopGameState.progress + 8);
            updateLoopUI();
        });
        
        document.getElementById('loopFinishBtn')?.addEventListener('click', finishLoopGame);
        
        // –ö–Ω–æ–ø–∫–∏ "–î–∞–ª–µ–µ" –≤–Ω—É—Ç—Ä–∏ –¥–∏–∞–ª–æ–≥–æ–≤ –º–∏—Ä–∞ –ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç—É—Å–∞
        const allNextButtons = document.querySelectorAll('.dialogue-next');
        allNextButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                e.stopPropagation(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ
                
                const sceneElement = this.closest('.procrastinatus-scene');
                if (sceneElement) {
                    const sceneNumber = parseInt(sceneElement.id.replace('procrastinatusScene', ''));
                    const activeStep = sceneElement.querySelector('.dialogue-step.active');
                    
                    if (activeStep) {
                        const steps = sceneElement.querySelectorAll('.dialogue-step');
                        const currentIndex = Array.from(steps).indexOf(activeStep);
                        
                        if (currentIndex < steps.length - 1) {
                            activeStep.classList.remove('active');
                            steps[currentIndex + 1].classList.add('active');
                        } else {
                            // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ü–µ–Ω–µ —á–µ—Ä–µ–∑ –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
                            document.getElementById('nextButton').click();
                        }
                    }
                }
            });
        });
        
        // –ö–Ω–æ–ø–∫–∞ "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞" –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –≤—ã–±–æ—Ä–µ
        document.getElementById('tryAgainButton')?.addEventListener('click', function() {
            procrastinationChoiceMade = false;
            procrastinationChoice = null;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
            const choiceStep = document.getElementById('choiceGameStep');
            const wrongStep = document.getElementById('wrongChoiceStep');
            
            if (wrongStep) wrongStep.classList.remove('active');
            if (choiceStep) choiceStep.classList.add('active');
            
            // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞
            document.querySelectorAll('#procrastinationActions .stagnation-action-btn').forEach(btn => {
                btn.disabled = false;
                btn.style.opacity = '1';
                btn.classList.remove('selected');
            });
        });
        
        // –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ" –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        document.getElementById('restartChapterButton')?.addEventListener('click', function() {
            if (confirm("–ù–∞—á–∞—Ç—å –≥–ª–∞–≤—É –∑–∞–Ω–æ–≤–æ?")) {
                location.reload();
            }
        });
        
        // –ö–Ω–æ–ø–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤ –ª–∞–≥–µ—Ä–µ
        document.getElementById('finalCampButton')?.addEventListener('click', function() {
            // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –¥–æ—à—ë–ª –¥–æ –ª–∞–≥–µ—Ä—è, –∑–Ω–∞—á–∏—Ç –æ–Ω –≤—ã–±—Ä–∞–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
            showChapterCompleteScreen(true);
        });
        
        // –ö–ª–∏–∫ –ø–æ —Ç–µ–∫—Å—Ç—É –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞ –ø–µ—á–∞—Ç–∏
        document.addEventListener('click', (e) => {
            if (isTyping && !e.target.classList.contains('option-button') && 
                !e.target.classList.contains('question-item')) {
                stopTyping();
                showFullText();
            }
        });
        
        console.log('–ò–≥—Ä–∞ "–î–µ–Ω—å 4. –ü–æ–∏—Å–∫–∏ –∞–ª—Ç–∞—Ä—è" –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
    });
    </script>
</body>
</html>